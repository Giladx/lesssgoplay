{"version":3,"file":"butterchurn.min.js","sources":["../node_modules/.pnpm/ecma-proposal-math-extensions@0.0.2/node_modules/ecma-proposal-math-extensions/reference-implementation/index.js","../src/presetBase.js","../node_modules/.pnpm/eel-wasm@0.0.16/node_modules/eel-wasm/dist/index.js","../node_modules/.pnpm/@assemblyscript+loader@0.17.14/node_modules/@assemblyscript/loader/index.js","../src/audio/fft.js","../src/audio/audioProcessor.js","../src/audio/audioLevels.js","../src/blankPreset.js","../src/utils.js","../src/utils/seededRandom.js","../src/utils/rngContext.js","../src/equations/presetEquationRunner.js","../src/equations/presetEquationRunnerWASM.js","../src/rendering/shaders/shaderUtils.js","../src/rendering/waves/waveUtils.js","../src/rendering/waves/basicWaveform.js","../src/rendering/waves/customWaveform.js","../src/rendering/shapes/customShape.js","../src/rendering/sprites/border.js","../src/rendering/sprites/darkenCenter.js","../src/rendering/motionVectors/motionVectors.js","../src/rendering/shaders/warp.js","../src/rendering/shaders/comp.js","../src/rendering/shaders/output.js","../src/rendering/shaders/resample.js","../src/rendering/shaders/blur/blurVertical.js","../src/rendering/shaders/blur/blurHorizontal.js","../src/rendering/shaders/blur/blur.js","../src/noise/noise.js","../src/image/imageTextures.js","../src/rendering/text/titleText.js","../src/rendering/blendPattern.js","../src/rendering/renderer.js","../src/visualizer.js","../src/assemblyscript/presetFunctions.ts","../src/index.js"],"sourcesContent":["\"use strict\";\n\n{\n  const defineMath = (name, assignment) => {\n    var configurable = typeof assignment === \"function\" ? true : false;\n    var writable = typeof assignment === \"function\" ? true : false;\n    var enumerable = typeof assignment === \"function\" ? true : false;\n\n    Object.defineProperty(Math, name, {\n      configurable: configurable,\n      enumerable: enumerable,\n      writable: writable,\n      value: assignment\n    });\n  };\n\n  defineMath(\"DEG_PER_RAD\", Math.PI / 180);\n  defineMath(\"RAD_PER_DEG\", 180 / Math.PI);\n\n  const f32A = new Float32Array(1);\n\n  defineMath(\"scale\", function scale(x, inLow, inHigh, outLow, outHigh) {\n    if (arguments.length === 0) {\n      return NaN;\n    }\n\n    if (Number.isNaN(x) ||\n        Number.isNaN(inLow) ||\n        Number.isNaN(inHigh) ||\n        Number.isNaN(outLow) ||\n        Number.isNaN(outHigh)) {\n      return NaN;\n    }\n\n    if (x === Infinity ||\n        x === -Infinity) {\n      return x;\n    }\n\n    return (x - inLow) * (outHigh - outLow) /\n      (inHigh - inLow) + outLow;\n  });\n\n  defineMath(\"fscale\", function fscale(x, inLow, inHigh, outLow, outHigh) {\n    f32A[0] = Math.scale(x, inLow, inHigh, outLow, outHigh);\n    return f32A[0];\n  });\n\n  defineMath(\"clamp\", function clamp(x, lower, upper) {\n    return Math.min(upper, Math.max(lower, x));\n  });\n\n  defineMath(\"radians\", function radians(degrees) {\n    return degrees * Math.DEG_PER_RAD;\n  });\n\n  defineMath(\"degrees\", function degrees(radians) {\n    return radians * Math.RAD_PER_DEG;\n  });\n}\n","/* eslint-disable */\r\nvar EPSILON = 0.00001;\r\n\r\nwindow.sqr = function sqr(x) {\r\n  return x * x;\r\n};\r\n\r\nwindow.sqrt = function sqrt(x) {\r\n  return Math.sqrt(Math.abs(x));\r\n};\r\n\r\nwindow.log10 = function log10(val) {\r\n  return Math.log(val) * Math.LOG10E;\r\n};\r\n\r\nwindow.sign = function sign(x) {\r\n  return x > 0 ? 1 : x < 0 ? -1 : 0;\r\n};\r\n\r\nwindow.rand = function rand(x) {\r\n  var xf = Math.floor(x);\r\n  if (xf < 1) {\r\n    return Math.random();\r\n  }\r\n  return Math.random() * xf;\r\n};\r\n\r\nwindow.randint = function randint(x) {\r\n  return Math.floor(rand(x));\r\n};\r\n\r\nwindow.bnot = function bnot(x) {\r\n  return Math.abs(x) < EPSILON ? 1 : 0;\r\n};\r\n\r\nfunction isFiniteNumber(num) {\r\n  return isFinite(num) && !isNaN(num);\r\n}\r\n\r\nwindow.pow = function pow(x, y) {\r\n  var z = Math.pow(x, y);\r\n  if (!isFiniteNumber(z)) {\r\n    // mostly from complex results\r\n    return 0;\r\n  }\r\n  return z;\r\n};\r\n\r\nwindow.div = function div(x, y) {\r\n  if (y === 0) {\r\n    return 0;\r\n  }\r\n  return x / y;\r\n};\r\n\r\nwindow.mod = function mod(x, y) {\r\n  if (y === 0) {\r\n    return 0;\r\n  }\r\n  var z = Math.floor(x) % Math.floor(y);\r\n  return z;\r\n};\r\n\r\nwindow.bitor = function bitor(x, y) {\r\n  var z = Math.floor(x) | Math.floor(y);\r\n  return z;\r\n};\r\n\r\nwindow.bitand = function bitand(x, y) {\r\n  var z = Math.floor(x) & Math.floor(y);\r\n  return z;\r\n};\r\n\r\nwindow.sigmoid = function sigmoid(x, y) {\r\n  var t = 1 + Math.exp(-x * y);\r\n  return Math.abs(t) > EPSILON ? 1.0 / t : 0;\r\n};\r\n\r\nwindow.bor = function bor(x, y) {\r\n  return Math.abs(x) > EPSILON || Math.abs(y) > EPSILON ? 1 : 0;\r\n};\r\n\r\nwindow.band = function band(x, y) {\r\n  return Math.abs(x) > EPSILON && Math.abs(y) > EPSILON ? 1 : 0;\r\n};\r\n\r\nwindow.equal = function equal(x, y) {\r\n  return Math.abs(x - y) < EPSILON ? 1 : 0;\r\n};\r\n\r\nwindow.above = function above(x, y) {\r\n  return x > y ? 1 : 0;\r\n};\r\n\r\nwindow.below = function below(x, y) {\r\n  return x < y ? 1 : 0;\r\n};\r\n\r\nwindow.ifcond = function ifcond(x, y, z) {\r\n  return Math.abs(x) > EPSILON ? y : z;\r\n};\r\n\r\nwindow.memcpy = function memcpy(megabuf, dst, src, len) {\r\n  let destOffset = dst;\r\n  let srcOffset = src;\r\n  let copyLen = len;\r\n\r\n  if (srcOffset < 0) {\r\n    copyLen += srcOffset;\r\n    destOffset -= srcOffset;\r\n    srcOffset = 0;\r\n  }\r\n\r\n  if (destOffset < 0) {\r\n    copyLen += destOffset;\r\n    srcOffset -= destOffset;\r\n    destOffset = 0;\r\n  }\r\n\r\n  if (copyLen > 0) {\r\n    megabuf.copyWithin(destOffset, srcOffset, copyLen);\r\n  }\r\n\r\n  return dst;\r\n};\r\n/* eslint-enable */\r\n","function t(t,e){let n={destCol:1,srcCol:1,srcLine:1};t.forEach(t=>{t.destCol>e||(n=t)});const r=e-n.destCol;return{column:n.srcCol+r,line:n.srcLine}}var e=function(){var t=function(t,e,n,r){for(n=n||{},r=t.length;r--;n[t[r]]=e);return n},e=[1,18],n=[1,7],r=[1,19],s=[1,20],i=[1,14],o=[1,15],a=[1,16],c=[1,33],l=[1,31],h=[1,23],u=[1,22],y=[1,24],p=[1,25],f=[1,26],g=[1,27],m=[1,28],_=[1,29],E=[1,30],d=[5,8,15,18,20,28,29,32,33,34,35,36,37,38],b=[5,15,18],w=[5,12,15,17,18,24,25,28,29,30],S=[1,57],I=[5,8,12,15,17,18,24,25,28,29,30],k=[15,18],O=[5,8,15,18,28,29,38],N=[5,8,15,18,28,29,32,33,38],v=[5,8,15,18,28,29,32,33,34,37,38],R=[5,8,15,18,28,29,32,33,34,35,36,37,38],$=[5,8,15,18],A=[5,8,15,18,20,22,28,29,32,33,34,35,36,37,38],x={trace:function(){},yy:{},symbols_:{error:2,SCRIPT:3,expression:4,EOF:5,expressionsOptionalTrailingSemi:6,separator:7,\";\":8,expressions:9,EXPRESSION_BLOCK:10,IDENTIFIER:11,IDENTIFIER_TOKEN:12,argument:13,arguments:14,\",\":15,FUNCTION_CALL:16,\"(\":17,\")\":18,LOGICAL_EXPRESSION:19,LOGICAL_OPERATOR_TOKEN:20,ASSIGNMENT:21,ASSIGNMENT_OPERATOR_TOKEN:22,number:23,DIGITS_TOKEN:24,\".\":25,NUMBER_LITERAL:26,UNARY_EXPRESSION:27,\"-\":28,\"+\":29,\"!\":30,BINARY_EXPRESSION:31,\"*\":32,\"/\":33,\"%\":34,\"&\":35,\"|\":36,\"^\":37,COMPARISON_TOKEN:38,$accept:0,$end:1},terminals_:{2:\"error\",5:\"EOF\",8:\";\",12:\"IDENTIFIER_TOKEN\",15:\",\",17:\"(\",18:\")\",20:\"LOGICAL_OPERATOR_TOKEN\",22:\"ASSIGNMENT_OPERATOR_TOKEN\",24:\"DIGITS_TOKEN\",25:\".\",28:\"-\",29:\"+\",30:\"!\",32:\"*\",33:\"/\",34:\"%\",35:\"&\",36:\"|\",37:\"^\",38:\"COMPARISON_TOKEN\"},productions_:[0,[3,2],[3,2],[3,1],[7,1],[7,2],[9,2],[9,3],[6,1],[6,2],[10,1],[11,1],[13,1],[13,1],[14,1],[14,3],[16,3],[16,4],[19,3],[21,3],[21,3],[23,1],[23,2],[23,3],[23,2],[23,1],[26,1],[27,2],[27,2],[27,2],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[4,1],[4,1],[4,3],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3]],performAction:function(t,e,n,r,s,i,o){var a=i.length-1;switch(s){case 1:return{type:\"SCRIPT\",body:[i[a-1]],loc:this._$};case 2:return{type:\"SCRIPT\",body:i[a-1],loc:this._$};case 3:return{type:\"SCRIPT\",body:[],loc:this._$};case 6:this.$=[i[a-1]];break;case 7:this.$=i[a-2].concat([i[a-1]]);break;case 8:this.$=i[a];break;case 9:this.$=i[a-1].concat([i[a]]);break;case 10:this.$={type:\"EXPRESSION_BLOCK\",body:i[a],loc:this._$};break;case 11:this.$={type:\"IDENTIFIER\",value:i[a].toLowerCase(),loc:this._$};break;case 14:this.$=[i[a]];break;case 15:this.$=i[a-2].concat([i[a]]);break;case 16:this.$={type:\"CALL_EXPRESSION\",callee:i[a-2],arguments:[],loc:this._$};break;case 17:this.$={type:\"CALL_EXPRESSION\",callee:i[a-3],arguments:i[a-1],loc:this._$};break;case 18:this.$={type:\"LOGICAL_EXPRESSION\",left:i[a-2],right:i[a],operator:i[a-1],loc:this._$};break;case 19:case 20:this.$={type:\"ASSIGNMENT_EXPRESSION\",left:i[a-2],operator:i[a-1],right:i[a],loc:this._$};break;case 21:this.$=Number(i[a]);break;case 22:this.$=Number(i[a-1]);break;case 23:this.$=Number(i[a-2]+i[a-1]+i[a]);break;case 24:this.$=Number(\"0\"+i[a-1]+i[a]);break;case 25:this.$=0;break;case 26:this.$={type:\"NUMBER_LITERAL\",value:i[a],loc:this._$};break;case 27:case 28:case 29:this.$={type:\"UNARY_EXPRESSION\",value:i[a],operator:i[a-1],loc:this._$};break;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:this.$={type:\"BINARY_EXPRESSION\",left:i[a-2],right:i[a],operator:i[a-1],loc:this._$};break;case 41:case 47:this.$=i[a-1]}},table:[{3:1,4:2,5:[1,4],6:3,9:13,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{1:[3]},{5:[1,21],7:32,8:c,20:l,28:h,29:u,32:y,33:p,34:f,35:g,36:m,37:_,38:E},{5:[1,34]},{1:[2,3]},t(d,[2,39]),t(d,[2,40]),{4:35,6:37,9:13,10:36,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},t(d,[2,42]),t(d,[2,43]),t(d,[2,44],{22:[1,38]}),t(d,[2,45],{17:[1,40],22:[1,39]}),t(d,[2,46]),t(b,[2,8],{31:5,27:6,26:8,21:9,16:10,11:11,19:12,23:17,4:41,12:e,17:n,24:r,25:s,28:i,29:o,30:a}),{4:42,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:43,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:44,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},t(d,[2,26]),t([5,8,15,17,18,20,22,28,29,32,33,34,35,36,37,38],[2,11]),t(d,[2,21],{25:[1,45]}),t(d,[2,25],{24:[1,46]}),{1:[2,1]},{4:47,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:48,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:49,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:50,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:51,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:52,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:53,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:54,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:55,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:56,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},t(w,[2,6],{8:S}),t(I,[2,4]),{1:[2,2]},{7:32,8:c,18:[1,58],20:l,28:h,29:u,32:y,33:p,34:f,35:g,36:m,37:_,38:E},{18:[1,59]},t(k,[2,10]),{4:60,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:61,11:11,12:e,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},{4:65,6:37,9:13,10:66,11:11,12:e,13:64,14:63,16:10,17:n,18:[1,62],19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},t(b,[2,9],{7:67,8:c,20:l,28:h,29:u,32:y,33:p,34:f,35:g,36:m,37:_,38:E}),t(O,[2,27],{20:l,32:y,33:p,34:f,35:g,36:m,37:_}),t(O,[2,28],{20:l,32:y,33:p,34:f,35:g,36:m,37:_}),t(O,[2,29],{20:l,32:y,33:p,34:f,35:g,36:m,37:_}),t(d,[2,22],{24:[1,68]}),t(d,[2,24]),t(O,[2,30],{20:l,32:y,33:p,34:f,35:g,36:m,37:_}),t(O,[2,31],{20:l,32:y,33:p,34:f,35:g,36:m,37:_}),t(N,[2,32],{20:l,34:f,35:g,36:m,37:_}),t(N,[2,33],{20:l,34:f,35:g,36:m,37:_}),t(v,[2,34],{20:l,35:g,36:m}),t(R,[2,35],{20:l}),t(R,[2,36],{20:l}),t(v,[2,37],{20:l,35:g,36:m}),t($,[2,38],{20:l,28:h,29:u,32:y,33:p,34:f,35:g,36:m,37:_,38:E}),t(d,[2,18]),t(I,[2,5]),t(d,[2,41]),t(d,[2,47]),t($,[2,20],{20:l,28:h,29:u,32:y,33:p,34:f,35:g,36:m,37:_,38:E}),t($,[2,19],{20:l,28:h,29:u,32:y,33:p,34:f,35:g,36:m,37:_,38:E}),t(A,[2,16]),{15:[1,70],18:[1,69]},t(k,[2,14]),t(k,[2,12],{7:32,8:c,20:l,28:h,29:u,32:y,33:p,34:f,35:g,36:m,37:_,38:E}),t(k,[2,13]),t(w,[2,7],{8:S}),t(d,[2,23]),t(A,[2,17]),{4:65,6:37,9:13,10:66,11:11,12:e,13:71,16:10,17:n,19:12,21:9,23:17,24:r,25:s,26:8,27:6,28:i,29:o,30:a,31:5},t(k,[2,15])],defaultActions:{4:[2,3],21:[2,1],34:[2,2]},parseError:function(t,e){if(!e.recoverable){var n=new Error(t);throw n.hash=e,n}this.trace(t)},parse:function(t){var e=this,n=[0],r=[null],s=[],i=this.table,o=\"\",a=0,c=0,l=s.slice.call(arguments,1),h=Object.create(this.lexer),u={yy:{}};for(var y in this.yy)Object.prototype.hasOwnProperty.call(this.yy,y)&&(u.yy[y]=this.yy[y]);h.setInput(t,u.yy),u.yy.lexer=h,u.yy.parser=this,void 0===h.yylloc&&(h.yylloc={});var p=h.yylloc;s.push(p);var f=h.options&&h.options.ranges;\"function\"==typeof u.yy.parseError?this.parseError=u.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var g,m,_,E,d,b,w,S,I=function(){var t;return\"number\"!=typeof(t=h.lex()||1)&&(t=e.symbols_[t]||t),t},k={};;){if(m=n[n.length-1],this.defaultActions[m]?_=this.defaultActions[m]:(null==g&&(g=I()),_=i[m]&&i[m][g]),void 0===_||!_.length||!_[0]){var O=\"\";for(d in S=[],i[m])this.terminals_[d]&&d>2&&S.push(\"'\"+this.terminals_[d]+\"'\");O=h.showPosition?\"Parse error on line \"+(a+1)+\":\\n\"+h.showPosition()+\"\\nExpecting \"+S.join(\", \")+\", got '\"+(this.terminals_[g]||g)+\"'\":\"Parse error on line \"+(a+1)+\": Unexpected \"+(1==g?\"end of input\":\"'\"+(this.terminals_[g]||g)+\"'\"),this.parseError(O,{text:h.match,token:this.terminals_[g]||g,line:h.yylineno,loc:p,expected:S})}if(_[0]instanceof Array&&_.length>1)throw new Error(\"Parse Error: multiple actions possible at state: \"+m+\", token: \"+g);switch(_[0]){case 1:n.push(g),r.push(h.yytext),s.push(h.yylloc),n.push(_[1]),g=null,c=h.yyleng,o=h.yytext,a=h.yylineno,p=h.yylloc;break;case 2:if(b=this.productions_[_[1]][1],k.$=r[r.length-b],k._$={first_line:s[s.length-(b||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(b||1)].first_column,last_column:s[s.length-1].last_column},f&&(k._$.range=[s[s.length-(b||1)].range[0],s[s.length-1].range[1]]),void 0!==(E=this.performAction.apply(k,[o,c,a,u.yy,_[1],r,s].concat(l))))return E;b&&(n=n.slice(0,-1*b*2),r=r.slice(0,-1*b),s=s.slice(0,-1*b)),n.push(this.productions_[_[1]][0]),r.push(k.$),s.push(k._$),w=i[n[n.length-2]][n[n.length-1]],n.push(w);break;case 3:return!0}}return!0}},L={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match=\"\",this.conditionStack=[\"INITIAL\"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\\r\\n?|\\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\\r\\n?|\\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var r=this.match.split(/(?:\\r\\n?|\\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var s=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[s[0],s[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError(\"Lexical error on line \"+(this.yylineno+1)+\". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\\n\"+this.showPosition(),{text:\"\",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?\"...\":\"\")+t.substr(-20).replace(/\\n/g,\"\")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?\"...\":\"\")).replace(/\\n/g,\"\")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join(\"-\");return t+this.upcomingInput()+\"\\n\"+e+\"^\"},test_match:function(t,e){var n,r,s;if(this.options.backtrack_lexer&&(s={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(s.yylloc.range=this.yylloc.range.slice(0))),(r=t[0].match(/(?:\\r\\n?|\\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\\r?\\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in s)this[i]=s[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,n,r;this._input||(this.done=!0),this._more||(this.yytext=\"\",this.match=\"\");for(var s=this._currentRules(),i=0;i<s.length;i++)if((n=this._input.match(this.rules[s[i]]))&&(!e||n[0].length>e[0].length)){if(e=n,r=i,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,s[i])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,s[r]))&&t:\"\"===this._input?this.EOF:this.parseError(\"Lexical error on line \"+(this.yylineno+1)+\". Unrecognized text.\\n\"+this.showPosition(),{text:\"\",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:\"INITIAL\"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n,r){switch(n){case 0:break;case 1:return 24;case 2:return 38;case 3:return 22;case 4:return 20;case 5:return 12;case 6:return 5;case 7:return e.yytext[0]}},rules:[/^(?:\\s+)/,/^(?:[0-9]+)/,/^(?:(==|!=|<=|>=|<|>))/,/^(?:[+\\-*/%]?=)/,/^(?:(\\&\\&)|\\|\\|)/,/^(?:[a-zA-Z_][a-zA-Z0-9._]*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7],inclusive:!0}}};function T(){this.yy={}}return x.lexer=L,T.prototype=x,x.Parser=T,new T}();const n={ASSIGNMENT_EXPRESSION:[{type:\"NODE\",key:\"right\"}],SCRIPT:[{type:\"ARRAY\",key:\"body\"}],EXPRESSION_BLOCK:[{type:\"ARRAY\",key:\"body\"}],UNARY_EXPRESSION:[{type:\"NODE\",key:\"value\"}],NUMBER_LITERAL:[],IDENTIFIER:[],CALL_EXPRESSION:[{type:\"ARRAY\",key:\"arguments\"},{type:\"NODE\",key:\"callee\"}],BINARY_EXPRESSION:[{type:\"NODE\",key:\"left\"},{type:\"NODE\",key:\"right\"}],LOGICAL_EXPRESSION:[{type:\"NODE\",key:\"left\"},{type:\"NODE\",key:\"right\"}]};function r(t,e){const s=n[t.type];let i=t;if(null==s)throw new Error(`Unknown children definition for ${t.type}`);return s.forEach(n=>{if(\"NODE\"===n.type){const s=t[n.key],o=r(s,e);o!==s&&(i={...i,[n.key]:o})}else if(\"ARRAY\"===n.type){const s=t[n.key],o=s.map(t=>r(t,e)),a=s.some((t,e)=>t!==o[e]);a&&(i={...i,[n.key]:o})}}),e(i)}function s(t){return[].concat.apply([],t)}function i(t,e){return new Array(t).fill(e).join(\"\")}class o{constructor(){this._map=new Map}get(t,e){const n=null==t?e:`${t}::${e}`;return this._map.has(n)||this._map.set(n,this._map.size),this._map.get(n)}size(){return this._map.size}}class a extends Error{constructor(t,e,n){super(t),this.sourceContext=function(t,e,n=1){const r=Math.max(t.first_line-1-n,0),s=t.last_line+n,o=e.split(\"\\n\").slice(r,s).map((e,n)=>{const s=n+r+1;return`${s>=t.first_line&&s<=t.last_line?\">\":\" \"} ${s} | ${e}`});if(t.first_line===t.last_line){const e=i(t.first_column,\" \"),n=i(t.last_column-t.first_column,\"^\"),s=t.first_line-r;o.splice(s,0,`    | ${e}${n}`)}return o.join(\"\\n\")}(e,n),this.loc=e}}class c extends a{}function l(t,e,n){return new c(t,e,n)}function h(t,e,n){return new a(t,e,n)}function u(e,n){const r=t(n,e.first_column),s=t(n,e.last_column);return{first_column:r.column,last_column:s.column,first_line:r.line,last_line:s.line}}function y(t){const[n,s]=function(t){const e=[];let n=1,r=\"\",s=0,i=!1,o=!1,a=!1;for(let c=0;c<t.length;c++){const l=t[c];if(a){const t=r.length+1,i=c-s+1;e.push({destCol:t,srcCol:i,srcLine:n}),a=!1}\"\\n\"===l?(i=!1,n++,s=c+1,a=!0):\"\\r\"===l&&\"\\n\"===t[c+1]?(c++,i=!1,n++,s=c+1,a=!0):o&&\"*\"===l&&\"/\"===t[c+1]?(o=!1,c++,a=!0):\"\\\\\"===l&&\"\\\\\"===t[c+1]||\"/\"===l&&\"/\"===t[c+1]?(i=!0,c++):\"/\"===l&&\"*\"===t[c+1]?(o=!0,c++):i||o||(r+=l)}return[r,e]}(t);try{const i=function(){return e.parse.apply(e,arguments)}(n);return r(i,e=>{if(1!==e.loc.first_line||1!=e.loc.last_line)throw h(\"Unexpected multiline\",e.loc,t);return Object.assign(Object.assign({},e),{loc:u(e.loc,s)})})}catch(e){if(null==e.hash)throw e;throw l(`Parse Error: ${e.message.split(\"\\n\")[3]}`,u(e.hash.loc,s),t)}}const p=[0,97,115,109],f=[1,0,0,0],g=1e-5,m=1,_=2,E=3,d=5,b=6,w=7,S=10,I=0,k=t=>[2,t],O=t=>[3,t],N=t=>[4,t],v=5,R=11,$=t=>[13,...At(t)],A=t=>[16,...At(t)],x=26,L=27,T=t=>[32,...At(t)],P=t=>[33,...At(t)],C=t=>[34,...At(t)],M=t=>[35,...At(t)],F=t=>[36,...At(t)],X=(t,e)=>[43,...At(t),...At(e)],j=(t,e)=>[57,...At(t),...At(e)],U=t=>[65,...xt(t)],D=t=>[68,...Rt(t)],B=71,V=72,G=73,K=74,Y=76,z=98,q=99,W=100,Z=101,J=102,H=106,Q=107,tt=108,et=111,nt=113,rt=114,st=131,it=132,ot=153,at=154,ct=155,lt=156,ht=159,ut=160,yt=161,pt=162,ft=163,gt=164,mt=165,_t=170,Et=176,dt=185,bt=183,wt=127,St=124,It=1,kt=64,Ot=124,Nt=[ot,...D(g),q],vt=[ot,...D(g),W];function Rt(t){const e=new Uint8Array(8);return function(t,e){const n=new ArrayBuffer(8);new DataView(n).setFloat64(0,e);const r=new Uint8Array(n).reverse();t.set(r,0)}(e,t),e}const $t=t=>[t.length].concat(t.split(\"\").map(t=>t.charCodeAt(0)));function At(t){const e=[];do{let n=127&t;0!==(t>>>=7)&&(n|=128),e.push(n)}while(0!==t);return e}function xt(t){let e=[],n=0,r=Math.ceil(Math.log2(Math.abs(t))),s=t<0,i=!0;for(;i;)n=127&t,t>>=7,s&&(t|=-(1<<r-7)),(0!=t||64&n)&&(-1!=t||64&~n)?n|=128:i=!1,e.push(n);return e}const Lt=t=>At(t.length).concat(t),Tt=t=>At(t.length).concat(s(t));function Pt(t,e){if(0===e.length)return[];const n=Lt(Tt(e));return n.unshift(t),n}const Ct={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,atan2:Math.atan2,rand:t=>Math.random()*t,pow:Math.pow,log:Math.log,log10:Math.log10,exp:Math.exp,sigmoid:function(t,e){const n=1+Math.exp(-t*e);return Math.abs(n)>1e-5?1/n:0}},Mt=1048576,Ft=Math.ceil(2048),Xt={sqr:{args:[St],returns:[St],binary:[...T(0),...T(0),pt]},bor:{args:[St,St],returns:[St],binary:[...T(0),...vt,...T(1),...vt,rt,...U(0),B,bt]},band:{args:[St,St],returns:[St],binary:[...T(0),...vt,...T(1),...vt,nt,...U(0),B,bt]},sign:{args:[St],returns:[St],binary:[...D(0),...T(0),q,...T(0),...D(0),q,Q,bt]},mod:{args:[St,St],returns:[St],localVariables:[wt],binary:[...T(1),_t,...C(2),...U(0),B,...N(Ot),...T(0),_t,...T(2),et,bt,v,...D(0),R]},bitwiseOr:{args:[St,St],returns:[St],binary:[...T(0),Et,...T(1),Et,it,dt]},bitwiseAnd:{args:[St,St],returns:[St],binary:[...T(0),Et,...T(1),Et,st,dt]},div:{args:[St,St],returns:[St],localVariables:[wt],binary:[...T(1),...D(0),z,...N(Ot),...T(0),...T(1),ft,v,...D(0),R]},_getBufferIndex:{args:[St],returns:[wt],localVariables:[St,wt],binary:[...D(g),...T(0),ut,...C(1),_t,...P(2),...U(-1),...T(2),...U(8),tt,...T(2),...U(0),V,...T(2),...U(8388607),K,rt,L]}};function jt(t,e){var n,r,i;switch(t.type){case\"SCRIPT\":return s(t.body.map((t,n)=>[...jt(t,e),x]));case\"EXPRESSION_BLOCK\":return Ut(t.body,e);case\"BINARY_EXPRESSION\":{const n=jt(t.left,e),r=jt(t.right,e),s={\"+\":[ut],\"-\":[yt],\"*\":[pt],\"/\":e.resolveFunc(\"div\"),\"%\":e.resolveFunc(\"mod\"),\"|\":e.resolveFunc(\"bitwiseOr\"),\"&\":e.resolveFunc(\"bitwiseAnd\"),\"^\":e.resolveFunc(\"pow\"),\"==\":[yt,...Nt,bt],\"!=\":[yt,...vt,bt],\"<\":[q,bt],\">\":[W,bt],\"<=\":[Z,bt],\">=\":[J,bt]}[t.operator];if(null==s)throw h(`Unknown binary expression operator ${t.operator}`,t.loc,e.rawSource);return[...n,...r,...s]}case\"CALL_EXPRESSION\":{const r=t.callee.value,i=t.arguments,o=n=>{if(i.length<n)throw l(`Too few arguments passed to \\`${r}()\\`. Expected ${n} but only got ${i.length}.`,t.loc,e.rawSource);if(i.length>n)throw l(`Too many arguments passed to \\`${r}()\\`. Expected ${n} but got ${i.length}.`,i[n].loc,e.rawSource)};switch(r){case\"exec2\":return o(2),Ut(t.arguments,e);case\"exec3\":return o(3),Ut(t.arguments,e);case\"if\":o(3);const[s,i,a]=t.arguments;return function(t,e,n,r){return[...jt(t,r),...vt,...N(Ot),...jt(e,r),v,...jt(n,r),R]}(s,i,a,e);case\"while\":return o(1),function(t,e){const n=jt(t,e),r=e.resolveLocal(wt);return[...U(0),...P(r),...O(kt),...T(r),...U(1),H,...C(r),...U(Mt),G,...n,...vt,nt,...$(0),R,...D(0)]}(t.arguments[0],e);case\"loop\":return o(2),function(t,e,n){const r=jt(e,n),s=n.resolveLocal(wt);return[...k(kt),...jt(t,n),_t,...C(s),...U(0),Y,...$(1),...O(kt),...r,x,...T(s),...U(1),Q,...C(s),...U(0),B,...$(0),R,R,...D(0)]}(t.arguments[0],t.arguments[1],e);case\"megabuf\":case\"gmegabuf\":o(1);const c=e.resolveLocal(wt);return[...jt(t.arguments[0],e),...null!==(n=e.resolveFunc(\"_getBufferIndex\"))&&void 0!==n?n:[],...C(c),...U(-1),B,...N(Ot),...T(c),...X(3,Dt(r)),v,...D(0),R];case\"assign\":o(2);const h=t.arguments[0];if(\"IDENTIFIER\"!=h.type)throw l(\"Expected the first argument of `assign()` to be an identifier.\",h.loc,e.rawSource);const u=e.resolveVar(h.value);return[...jt(t.arguments[1],e),...F(u),...M(u)]}const a=s(t.arguments.map(t=>jt(t,e)));switch(r){case\"abs\":return o(1),[...a,ot];case\"sqrt\":return o(1),[...a,ot,ht];case\"int\":case\"floor\":return o(1),[...a,lt];case\"min\":return o(2),[...a,gt];case\"max\":return o(2),[...a,mt];case\"above\":return o(2),[...a,W,bt];case\"below\":return o(2),[...a,q,bt];case\"equal\":return o(2),[...a,yt,...Nt,bt];case\"bnot\":return o(1),[...a,...Nt,bt];case\"ceil\":return o(1),[...a,ct]}const c=e.resolveFunc(r);if(null==c||r.startsWith(\"_\"))throw l(`\"${r}\" is not defined.`,t.callee.loc,e.rawSource);if(null!=Ct[r])o(Ct[r].length);else{if(null==Xt[r])throw h(`Missing arity information for the function \\`${r}()\\``,t.callee.loc,e.rawSource);o(Xt[r].args.length)}return[...a,...c]}case\"ASSIGNMENT_EXPRESSION\":{const{left:n}=t,s=jt(t.right,e),o=function(t,e){const n={\"+=\":[ut],\"-=\":[yt],\"*=\":[pt],\"/=\":[ft],\"%=\":e.resolveFunc(\"mod\"),\"=\":null},r=n[t.operator];if(void 0===r)throw h(`Unknown assignment operator \"${t.operator}\"`,t.loc,e.rawSource);return r}(t,e);if(\"IDENTIFIER\"===n.type){const t=e.resolveVar(n.value),r=M(t),i=F(t);return null===o?[...s,...i,...r]:[...r,...s,...o,...i,...r]}if(\"CALL_EXPRESSION\"!==n.type)throw h(`Unexpected left hand side type for assignment: ${n.type}`,t.loc,e.rawSource);const a=e.resolveLocal(wt);if(1!==n.arguments.length)throw l(`Expected 1 argument when assigning to a buffer but got ${n.arguments.length}.`,0===n.arguments.length?n.loc:n.arguments[1].loc,e.rawSource);const c=n.callee.value;if(\"gmegabuf\"!==c&&\"megabuf\"!==c)throw l(\"The only function calls which may be assigned to are `gmegabuf()` and `megabuf()`.\",n.callee.loc,e.rawSource);const u=Dt(c);if(null===o){const t=e.resolveLocal(wt),i=e.resolveLocal(St);return[...s,...P(i),...jt(n.arguments[0],e),...null!==(r=e.resolveFunc(\"_getBufferIndex\"))&&void 0!==r?r:[],...C(t),...U(0),V,...N(Ot),...D(0),v,...T(t),...C(a),...T(i),...j(3,u),...T(i),R]}const y=e.resolveLocal(wt),p=e.resolveLocal(wt),f=e.resolveLocal(St),g=e.resolveLocal(St);return[...s,...P(f),...jt(n.arguments[0],e),...null!==(i=e.resolveFunc(\"_getBufferIndex\"))&&void 0!==i?i:[],...C(y),...U(-1),B,...C(p),...N(Ot),...T(y),...X(3,u),v,...D(0),R,...T(f),...o,...C(g),...T(p),...N(kt),...T(y),...T(g),...j(3,u),R]}case\"LOGICAL_EXPRESSION\":{const n=jt(t.left,e),r=jt(t.right,e),s={\"&&\":{comparison:Nt,shortCircuitValue:0},\"||\":{comparison:vt,shortCircuitValue:1}}[t.operator];if(null==s)throw h(`Unknown logical expression operator ${t.operator}`,t.loc,e.rawSource);const{comparison:i,shortCircuitValue:o}=s;return[...n,...i,...N(Ot),...D(o),v,...r,...vt,bt,R]}case\"UNARY_EXPRESSION\":{const n=jt(t.value,e),r={\"-\":[at],\"+\":[],\"!\":[...Nt,bt]}[t.operator];if(null==r)throw h(`Unknown logical unary operator ${t.operator}`,t.loc,e.rawSource);return[...n,...r]}case\"IDENTIFIER\":const o=t.value;return M(e.resolveVar(o));case\"NUMBER_LITERAL\":return D(t.value);default:throw h(`Unknown AST node type ${t.type}`,t.loc,e.rawSource)}}function Ut(t,e){return s(function(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t[r]),r===t.length-1||n.push(e);return n}(t.map((t,n)=>jt(t,e)),[x]))}function Dt(t){switch(t){case\"gmegabuf\":return 67108864;case\"megabuf\":return 0}}function Bt({pools:t,functions:e,eelVersion:n=2,preParsed:r=!1}){if(Object.keys(t).includes(\"shims\"))throw new Error('You may not name a pool \"shims\". \"shims\" is reserved for injected JavaScript functions.');const s=[];Object.entries(t).forEach(([t,e])=>{e.forEach(e=>{s.push([t,e])})});const i=new o;s.forEach(([t,e])=>{i.get(t,e)});const a=Object.entries(Ct).map(([t,e])=>({args:new Array(e.length).fill(null).map(t=>St),returns:[St],name:t})),c=[],l=[];Object.entries(e).forEach(([e,{pool:s,code:o}])=>{if(null==t[s]){const n=Object.keys(t);if(0===n.length)throw new Error(`The function \"${e}\" was declared as using a variable pool named \"${s}\" but no pools were defined.`);throw new Error(`The function \"${e}\" was declared as using a variable pool named \"${s}\" which is not among the variable pools defined. The defined variable pools are: ${function(t){if(0===t.length)throw new Error(\"Cannot format an empty list\");if(1===t.length)return t[0];const e=t.map(t=>`\"${t}\"`),n=e.pop();return e.join(\", \")+` and ${n}`}(n)}.`)}const h=r?o:y(o);if(\"string\"==typeof h)throw new Error(\"Got passed unparsed code without setting the preParsed flag\");if(\"SCRIPT\"!==h.type)throw new Error(\"Invalid AST\");if(0===h.body.length)return;const u=[],p={resolveVar:t=>/^reg\\d\\d$/.test(t)?i.get(null,t):i.get(s,t),resolveLocal:t=>(u.push(t),u.length-1),resolveFunc:t=>{const e=a.findIndex(e=>e.name===t);if(-1!==e){const r=A(e);return\"rand\"===t&&1===n?[...r,lt]:r}if(null==Xt[t])return null;let r=c.indexOf(t);return-1===r&&(c.push(t),r=c.length-1),A(r+a.length)},rawSource:o},f=jt(h,p);l.push({binary:f,exportName:e,args:[],returns:[],localVariables:u})});const h=c.map(t=>{const e=Xt[t];if(null==e)throw new Error(`Undefined local function \"${t}\"`);return e}),u=t=>[...t.args,\"|\",...t.returns].join(\"-\"),g=[],k=new Map;function O(t){const e=u(t),n=k.get(e);if(null==n)throw new Error(`Failed to get a type index for key ${e}`);return n}[...a,...h,...l].forEach(t=>{const e=u(t);k.has(e)||(g.push([96,...Lt(t.args),...Lt(t.returns)]),k.set(e,g.length-1))});const N=[...s.map(([t,e])=>[...$t(t),...$t(e),3,St,It]),...a.map((t,e)=>{const n=O(t);return[...$t(\"shims\"),...$t(t.name),0,...At(n)]})],v=[...h,...l].map(t=>At(O(t))),$=[[1,...At(Ft),...At(Ft)]],x=i.size()-s.length,L=(T=()=>[St,It,...D(0),R],new Array(x).fill(null).map((t,e)=>T(e)));var T;const P=[...l].map((t,e)=>{const n=e+a.length+h.length;return[...$t(t.exportName),I,...At(n)]}),C=[...h,...l].map(t=>{var e;const n=(null!==(e=t.localVariables)&&void 0!==e?e:[]).map(t=>[...At(1),t]);return Lt([...Tt(n),...t.binary,R])});return new Uint8Array([...p,...f,...Pt(m,g),...Pt(_,N),...Pt(E,v),...Pt(d,$),...Pt(b,L),...Pt(w,P),...Pt(S,C)])}async function Vt({pools:t,functions:e,eelVersion:n=2}){let r={};Object.entries(t).forEach(([t,e])=>{r[t]=new Set(Object.keys(e))});const s=Bt({pools:r,functions:e,eelVersion:n}),i=await WebAssembly.compile(s);var o=Object.assign(Object.assign({},t),{shims:Ct});return await WebAssembly.instantiate(i,o)}export{Bt as compileModule,Vt as loadModule,y as parse,Ct as shims};\n//# sourceMappingURL=index.js.map\n","// Runtime header offsets\nconst ID_OFFSET = -8;\nconst SIZE_OFFSET = -4;\n\n// Runtime ids\nconst ARRAYBUFFER_ID = 0;\nconst STRING_ID = 1;\n// const ARRAYBUFFERVIEW_ID = 2;\n\n// Runtime type information\nconst ARRAYBUFFERVIEW = 1 << 0;\nconst ARRAY = 1 << 1;\nconst STATICARRAY = 1 << 2;\n// const SET = 1 << 3;\n// const MAP = 1 << 4;\nconst VAL_ALIGN_OFFSET = 6;\n// const VAL_ALIGN = 1 << VAL_ALIGN_OFFSET;\nconst VAL_SIGNED = 1 << 11;\nconst VAL_FLOAT = 1 << 12;\n// const VAL_NULLABLE = 1 << 13;\nconst VAL_MANAGED = 1 << 14;\n// const KEY_ALIGN_OFFSET = 15;\n// const KEY_ALIGN = 1 << KEY_ALIGN_OFFSET;\n// const KEY_SIGNED = 1 << 20;\n// const KEY_FLOAT = 1 << 21;\n// const KEY_NULLABLE = 1 << 22;\n// const KEY_MANAGED = 1 << 23;\n\n// Array(BufferView) layout\nconst ARRAYBUFFERVIEW_BUFFER_OFFSET = 0;\nconst ARRAYBUFFERVIEW_DATASTART_OFFSET = 4;\nconst ARRAYBUFFERVIEW_DATALENGTH_OFFSET = 8;\nconst ARRAYBUFFERVIEW_SIZE = 12;\nconst ARRAY_LENGTH_OFFSET = 12;\nconst ARRAY_SIZE = 16;\n\nconst BIGINT = typeof BigUint64Array !== \"undefined\";\nconst THIS = Symbol();\n\nconst STRING_DECODE_THRESHOLD = 32;\nconst decoder = new TextDecoder(\"utf-16le\");\n\n/** Gets a string from an U32 and an U16 view on a memory. */\nfunction getStringImpl(buffer, ptr) {\n  const len = new Uint32Array(buffer)[ptr + SIZE_OFFSET >>> 2] >>> 1;\n  const arr = new Uint16Array(buffer, ptr, len);\n  if (len <= STRING_DECODE_THRESHOLD) {\n    return String.fromCharCode.apply(String, arr);\n  }\n  return decoder.decode(arr);\n}\n\n/** Prepares the base module prior to instantiation. */\nfunction preInstantiate(imports) {\n  const extendedExports = {};\n\n  function getString(memory, ptr) {\n    if (!memory) return \"<yet unknown>\";\n    return getStringImpl(memory.buffer, ptr);\n  }\n\n  // add common imports used by stdlib for convenience\n  const env = (imports.env = imports.env || {});\n  env.abort = env.abort || function abort(msg, file, line, colm) {\n    const memory = extendedExports.memory || env.memory; // prefer exported, otherwise try imported\n    throw Error(`abort: ${getString(memory, msg)} at ${getString(memory, file)}:${line}:${colm}`);\n  };\n  env.trace = env.trace || function trace(msg, n, ...args) {\n    const memory = extendedExports.memory || env.memory;\n    console.log(`trace: ${getString(memory, msg)}${n ? \" \" : \"\"}${args.slice(0, n).join(\", \")}`);\n  };\n  env.seed = env.seed || Date.now;\n  imports.Math = imports.Math || Math;\n  imports.Date = imports.Date || Date;\n\n  return extendedExports;\n}\n\n/** Prepares the final module once instantiation is complete. */\nfunction postInstantiate(extendedExports, instance) {\n  const exports = instance.exports;\n  const memory = exports.memory;\n  const table = exports.table;\n  const __new = exports[\"__new\"];\n  const __retain = exports[\"__retain\"];\n  const __rtti_base = exports[\"__rtti_base\"] || ~0; // oob if not present\n\n  /** Gets the runtime type info for the given id. */\n  function getInfo(id) {\n    const U32 = new Uint32Array(memory.buffer);\n    const count = U32[__rtti_base >>> 2];\n    if ((id >>>= 0) >= count) throw Error(`invalid id: ${id}`);\n    return U32[(__rtti_base + 4 >>> 2) + id * 2];\n  }\n\n  /** Gets and validate runtime type info for the given id for array like objects */\n  function getArrayInfo(id) {\n    const info = getInfo(id);\n    if (!(info & (ARRAYBUFFERVIEW | ARRAY | STATICARRAY))) throw Error(`not an array: ${id}, flags=${info}`);\n    return info;\n  }\n\n  /** Gets the runtime base id for the given id. */\n  function getBase(id) {\n    const U32 = new Uint32Array(memory.buffer);\n    const count = U32[__rtti_base >>> 2];\n    if ((id >>>= 0) >= count) throw Error(`invalid id: ${id}`);\n    return U32[(__rtti_base + 4 >>> 2) + id * 2 + 1];\n  }\n\n  /** Gets the runtime alignment of a collection's values. */\n  function getValueAlign(info) {\n    return 31 - Math.clz32((info >>> VAL_ALIGN_OFFSET) & 31); // -1 if none\n  }\n\n  /** Gets the runtime alignment of a collection's keys. */\n  // function getKeyAlign(info) {\n  //   return 31 - Math.clz32((info >>> KEY_ALIGN_OFFSET) & 31); // -1 if none\n  // }\n\n  /** Allocates a new string in the module's memory and returns its retained pointer. */\n  function __newString(str) {\n    if (str == null) return 0;\n    const length = str.length;\n    const ptr = __new(length << 1, STRING_ID);\n    const U16 = new Uint16Array(memory.buffer);\n    for (var i = 0, p = ptr >>> 1; i < length; ++i) U16[p + i] = str.charCodeAt(i);\n    return ptr;\n  }\n\n  extendedExports.__newString = __newString;\n\n  /** Reads a string from the module's memory by its pointer. */\n  function __getString(ptr) {\n    if (!ptr) return null;\n    const buffer = memory.buffer;\n    const id = new Uint32Array(buffer)[ptr + ID_OFFSET >>> 2];\n    if (id !== STRING_ID) throw Error(`not a string: ${ptr}`);\n    return getStringImpl(buffer, ptr);\n  }\n\n  extendedExports.__getString = __getString;\n\n  /** Gets the view matching the specified alignment, signedness and floatness. */\n  function getView(alignLog2, signed, float) {\n    const buffer = memory.buffer;\n    if (float) {\n      switch (alignLog2) {\n        case 2: return new Float32Array(buffer);\n        case 3: return new Float64Array(buffer);\n      }\n    } else {\n      switch (alignLog2) {\n        case 0: return new (signed ? Int8Array : Uint8Array)(buffer);\n        case 1: return new (signed ? Int16Array : Uint16Array)(buffer);\n        case 2: return new (signed ? Int32Array : Uint32Array)(buffer);\n        case 3: return new (signed ? BigInt64Array : BigUint64Array)(buffer);\n      }\n    }\n    throw Error(`unsupported align: ${alignLog2}`);\n  }\n\n  /** Allocates a new array in the module's memory and returns its retained pointer. */\n  function __newArray(id, values) {\n    const info = getArrayInfo(id);\n    const align = getValueAlign(info);\n    const length = values.length;\n    const buf = __new(length << align, info & STATICARRAY ? id : ARRAYBUFFER_ID);\n    let result;\n    if (info & STATICARRAY) {\n      result = buf;\n    } else {\n      const arr = __new(info & ARRAY ? ARRAY_SIZE : ARRAYBUFFERVIEW_SIZE, id);\n      const U32 = new Uint32Array(memory.buffer);\n      U32[arr + ARRAYBUFFERVIEW_BUFFER_OFFSET >>> 2] = __retain(buf);\n      U32[arr + ARRAYBUFFERVIEW_DATASTART_OFFSET >>> 2] = buf;\n      U32[arr + ARRAYBUFFERVIEW_DATALENGTH_OFFSET >>> 2] = length << align;\n      if (info & ARRAY) U32[arr + ARRAY_LENGTH_OFFSET >>> 2] = length;\n      result = arr;\n    }\n    const view = getView(align, info & VAL_SIGNED, info & VAL_FLOAT);\n    if (info & VAL_MANAGED) {\n      for (let i = 0; i < length; ++i) view[(buf >>> align) + i] = __retain(values[i]);\n    } else {\n      view.set(values, buf >>> align);\n    }\n    return result;\n  }\n\n  extendedExports.__newArray = __newArray;\n\n  /** Gets a live view on an array's values in the module's memory. Infers the array type from RTTI. */\n  function __getArrayView(arr) {\n    const U32 = new Uint32Array(memory.buffer);\n    const id = U32[arr + ID_OFFSET >>> 2];\n    const info = getArrayInfo(id);\n    const align = getValueAlign(info);\n    let buf = info & STATICARRAY\n      ? arr\n      : U32[arr + ARRAYBUFFERVIEW_DATASTART_OFFSET >>> 2];\n    const length = info & ARRAY\n      ? U32[arr + ARRAY_LENGTH_OFFSET >>> 2]\n      : U32[buf + SIZE_OFFSET >>> 2] >>> align;\n    return getView(align, info & VAL_SIGNED, info & VAL_FLOAT).subarray(buf >>>= align, buf + length);\n  }\n\n  extendedExports.__getArrayView = __getArrayView;\n\n  /** Copies an array's values from the module's memory. Infers the array type from RTTI. */\n  function __getArray(arr) {\n    const input = __getArrayView(arr);\n    const len = input.length;\n    const out = new Array(len);\n    for (let i = 0; i < len; i++) out[i] = input[i];\n    return out;\n  }\n\n  extendedExports.__getArray = __getArray;\n\n  /** Copies an ArrayBuffer's value from the module's memory. */\n  function __getArrayBuffer(ptr) {\n    const buffer = memory.buffer;\n    const length = new Uint32Array(buffer)[ptr + SIZE_OFFSET >>> 2];\n    return buffer.slice(ptr, ptr + length);\n  }\n\n  extendedExports.__getArrayBuffer = __getArrayBuffer;\n\n  /** Copies a typed array's values from the module's memory. */\n  function getTypedArray(Type, alignLog2, ptr) {\n    return new Type(getTypedArrayView(Type, alignLog2, ptr));\n  }\n\n  /** Gets a live view on a typed array's values in the module's memory. */\n  function getTypedArrayView(Type, alignLog2, ptr) {\n    const buffer = memory.buffer;\n    const U32 = new Uint32Array(buffer);\n    const bufPtr = U32[ptr + ARRAYBUFFERVIEW_DATASTART_OFFSET >>> 2];\n    return new Type(buffer, bufPtr, U32[bufPtr + SIZE_OFFSET >>> 2] >>> alignLog2);\n  }\n\n  /** Attach a set of get TypedArray and View functions to the exports. */\n  function attachTypedArrayFunctions(ctor, name, align) {\n    extendedExports[`__get${name}`] = getTypedArray.bind(null, ctor, align);\n    extendedExports[`__get${name}View`] = getTypedArrayView.bind(null, ctor, align);\n  }\n\n  [\n    Int8Array,\n    Uint8Array,\n    Uint8ClampedArray,\n    Int16Array,\n    Uint16Array,\n    Int32Array,\n    Uint32Array,\n    Float32Array,\n    Float64Array\n  ].forEach(ctor => {\n    attachTypedArrayFunctions(ctor, ctor.name, 31 - Math.clz32(ctor.BYTES_PER_ELEMENT));\n  });\n\n  if (BIGINT) {\n    [BigUint64Array, BigInt64Array].forEach(ctor => {\n      attachTypedArrayFunctions(ctor, ctor.name.slice(3), 3);\n    });\n  }\n\n  /** Tests whether an object is an instance of the class represented by the specified base id. */\n  function __instanceof(ptr, baseId) {\n    const U32 = new Uint32Array(memory.buffer);\n    let id = U32[ptr + ID_OFFSET >>> 2];\n    if (id <= U32[__rtti_base >>> 2]) {\n      do {\n        if (id == baseId) return true;\n        id = getBase(id);\n      } while (id);\n    }\n    return false;\n  }\n\n  extendedExports.__instanceof = __instanceof;\n\n  // Pull basic exports to extendedExports so code in preInstantiate can use them\n  extendedExports.memory = extendedExports.memory || memory;\n  extendedExports.table  = extendedExports.table  || table;\n\n  // Demangle exports and provide the usual utility on the prototype\n  return demangle(exports, extendedExports);\n}\n\nfunction isResponse(src) {\n  return typeof Response !== \"undefined\" && src instanceof Response;\n}\n\nfunction isModule(src) {\n  return src instanceof WebAssembly.Module;\n}\n\n/** Asynchronously instantiates an AssemblyScript module from anything that can be instantiated. */\nexport async function instantiate(source, imports = {}) {\n  if (isResponse(source = await source)) return instantiateStreaming(source, imports);\n  const module = isModule(source) ? source : await WebAssembly.compile(source);\n  const extended = preInstantiate(imports);\n  const instance = await WebAssembly.instantiate(module, imports);\n  const exports = postInstantiate(extended, instance);\n  return { module, instance, exports };\n}\n\n/** Synchronously instantiates an AssemblyScript module from a WebAssembly.Module or binary buffer. */\nexport function instantiateSync(source, imports = {}) {\n  const module = isModule(source) ? source : new WebAssembly.Module(source);\n  const extended = preInstantiate(imports);\n  const instance = new WebAssembly.Instance(module, imports);\n  const exports = postInstantiate(extended, instance);\n  return { module, instance, exports };\n}\n\n/** Asynchronously instantiates an AssemblyScript module from a response, i.e. as obtained by `fetch`. */\nexport async function instantiateStreaming(source, imports = {}) {\n  if (!WebAssembly.instantiateStreaming) {\n    return instantiate(\n      isResponse(source = await source)\n        ? source.arrayBuffer()\n        : source,\n      imports\n    );\n  }\n  const extended = preInstantiate(imports);\n  const result = await WebAssembly.instantiateStreaming(source, imports);\n  const exports = postInstantiate(extended, result.instance);\n  return { ...result, exports };\n}\n\n/** Demangles an AssemblyScript module's exports to a friendly object structure. */\nexport function demangle(exports, extendedExports = {}) {\n  const setArgumentsLength = exports[\"__argumentsLength\"]\n    ? length => { exports[\"__argumentsLength\"].value = length; }\n    : exports[\"__setArgumentsLength\"] || exports[\"__setargc\"] || (() => { /* nop */ });\n  for (let internalName in exports) {\n    if (!Object.prototype.hasOwnProperty.call(exports, internalName)) continue;\n    const elem = exports[internalName];\n    let parts = internalName.split(\".\");\n    let curr = extendedExports;\n    while (parts.length > 1) {\n      let part = parts.shift();\n      if (!Object.prototype.hasOwnProperty.call(curr, part)) curr[part] = {};\n      curr = curr[part];\n    }\n    let name = parts[0];\n    let hash = name.indexOf(\"#\");\n    if (hash >= 0) {\n      const className = name.substring(0, hash);\n      const classElem = curr[className];\n      if (typeof classElem === \"undefined\" || !classElem.prototype) {\n        const ctor = function(...args) {\n          return ctor.wrap(ctor.prototype.constructor(0, ...args));\n        };\n        ctor.prototype = {\n          valueOf() { return this[THIS]; }\n        };\n        ctor.wrap = function(thisValue) {\n          return Object.create(ctor.prototype, { [THIS]: { value: thisValue, writable: false } });\n        };\n        if (classElem) Object.getOwnPropertyNames(classElem).forEach(name =>\n          Object.defineProperty(ctor, name, Object.getOwnPropertyDescriptor(classElem, name))\n        );\n        curr[className] = ctor;\n      }\n      name = name.substring(hash + 1);\n      curr = curr[className].prototype;\n      if (/^(get|set):/.test(name)) {\n        if (!Object.prototype.hasOwnProperty.call(curr, name = name.substring(4))) {\n          let getter = exports[internalName.replace(\"set:\", \"get:\")];\n          let setter = exports[internalName.replace(\"get:\", \"set:\")];\n          Object.defineProperty(curr, name, {\n            get() { return getter(this[THIS]); },\n            set(value) { setter(this[THIS], value); },\n            enumerable: true\n          });\n        }\n      } else {\n        if (name === 'constructor') {\n          (curr[name] = (...args) => {\n            setArgumentsLength(args.length);\n            return elem(...args);\n          }).original = elem;\n        } else { // instance method\n          (curr[name] = function(...args) { // !\n            setArgumentsLength(args.length);\n            return elem(this[THIS], ...args);\n          }).original = elem;\n        }\n      }\n    } else {\n      if (/^(get|set):/.test(name)) {\n        if (!Object.prototype.hasOwnProperty.call(curr, name = name.substring(4))) {\n          Object.defineProperty(curr, name, {\n            get: exports[internalName.replace(\"set:\", \"get:\")],\n            set: exports[internalName.replace(\"get:\", \"set:\")],\n            enumerable: true\n          });\n        }\n      } else if (typeof elem === \"function\" && elem !== setArgumentsLength) {\n        (curr[name] = (...args) => {\n          setArgumentsLength(args.length);\n          return elem(...args);\n        }).original = elem;\n      } else {\n        curr[name] = elem;\n      }\n    }\n  }\n  return extendedExports;\n}\n\nexport default {\n  instantiate,\n  instantiateSync,\n  instantiateStreaming,\n  demangle\n};\n","export default class FFT {\r\n  constructor(samplesIn, samplesOut, equalize = false) {\r\n    this.samplesIn = samplesIn;\r\n    this.samplesOut = samplesOut;\r\n    this.equalize = equalize;\r\n    this.NFREQ = samplesOut * 2;\r\n\r\n    if (this.equalize) {\r\n      this.initEqualizeTable();\r\n    }\r\n    this.initBitRevTable();\r\n    this.initCosSinTable();\r\n  }\r\n\r\n  initEqualizeTable() {\r\n    this.equalizeArr = new Float32Array(this.samplesOut);\r\n    const invHalfNFREQ = 1.0 / this.samplesOut;\r\n    for (let i = 0; i < this.samplesOut; i++) {\r\n      this.equalizeArr[i] =\r\n        -0.02 * Math.log((this.samplesOut - i) * invHalfNFREQ);\r\n    }\r\n  }\r\n\r\n  /* eslint-disable no-bitwise */\r\n  initBitRevTable() {\r\n    this.bitrevtable = new Uint16Array(this.NFREQ);\r\n\r\n    for (let i = 0; i < this.NFREQ; i++) {\r\n      this.bitrevtable[i] = i;\r\n    }\r\n\r\n    let j = 0;\r\n    for (let i = 0; i < this.NFREQ; i++) {\r\n      if (j > i) {\r\n        const temp = this.bitrevtable[i];\r\n        this.bitrevtable[i] = this.bitrevtable[j];\r\n        this.bitrevtable[j] = temp;\r\n      }\r\n\r\n      let m = this.NFREQ >> 1;\r\n\r\n      while (m >= 1 && j >= m) {\r\n        j -= m;\r\n        m >>= 1;\r\n      }\r\n\r\n      j += m;\r\n    }\r\n  }\r\n\r\n  initCosSinTable() {\r\n    let dftsize = 2;\r\n    let tabsize = 0;\r\n    while (dftsize <= this.NFREQ) {\r\n      tabsize += 1;\r\n      dftsize <<= 1;\r\n    }\r\n\r\n    this.cossintable = [new Float32Array(tabsize), new Float32Array(tabsize)];\r\n\r\n    dftsize = 2;\r\n    let i = 0;\r\n    while (dftsize <= this.NFREQ) {\r\n      const theta = (-2.0 * Math.PI) / dftsize;\r\n      this.cossintable[0][i] = Math.cos(theta);\r\n      this.cossintable[1][i] = Math.sin(theta);\r\n      i += 1;\r\n      dftsize <<= 1;\r\n    }\r\n  }\r\n\r\n  timeToFrequencyDomain(waveDataIn) {\r\n    const real = new Float32Array(this.NFREQ);\r\n    const imag = new Float32Array(this.NFREQ);\r\n\r\n    for (let i = 0; i < this.NFREQ; i++) {\r\n      const idx = this.bitrevtable[i];\r\n      if (idx < this.samplesIn) {\r\n        real[i] = waveDataIn[idx];\r\n      } else {\r\n        real[i] = 0;\r\n      }\r\n      imag[i] = 0;\r\n    }\r\n\r\n    let dftsize = 2;\r\n    let t = 0;\r\n    while (dftsize <= this.NFREQ) {\r\n      const wpr = this.cossintable[0][t];\r\n      const wpi = this.cossintable[1][t];\r\n      let wr = 1.0;\r\n      let wi = 0.0;\r\n      const hdftsize = dftsize >> 1;\r\n\r\n      for (let m = 0; m < hdftsize; m++) {\r\n        for (let i = m; i < this.NFREQ; i += dftsize) {\r\n          const j = i + hdftsize;\r\n          const tempr = wr * real[j] - wi * imag[j];\r\n          const tempi = wr * imag[j] + wi * real[j];\r\n          real[j] = real[i] - tempr;\r\n          imag[j] = imag[i] - tempi;\r\n          real[i] += tempr;\r\n          imag[i] += tempi;\r\n        }\r\n\r\n        const wtemp = wr;\r\n        wr = wtemp * wpr - wi * wpi;\r\n        wi = wi * wpr + wtemp * wpi;\r\n      }\r\n\r\n      dftsize <<= 1;\r\n      t += 1;\r\n    }\r\n\r\n    const spectralDataOut = new Float32Array(this.samplesOut);\r\n    if (this.equalize) {\r\n      for (let i = 0; i < this.samplesOut; i++) {\r\n        spectralDataOut[i] =\r\n          this.equalizeArr[i] *\r\n          Math.sqrt(real[i] * real[i] + imag[i] * imag[i]);\r\n      }\r\n    } else {\r\n      for (let i = 0; i < this.samplesOut; i++) {\r\n        spectralDataOut[i] = Math.sqrt(real[i] * real[i] + imag[i] * imag[i]);\r\n      }\r\n    }\r\n\r\n    return spectralDataOut;\r\n  }\r\n  /* eslint-enable no-bitwise */\r\n}\r\n","import FFT from \"./fft\";\r\n\r\nexport default class AudioProcessor {\r\n  constructor(context) {\r\n    this.numSamps = 512;\r\n    this.fftSize = this.numSamps * 2;\r\n\r\n    this.fft = new FFT(this.fftSize, 512, true);\r\n\r\n    if (context) {\r\n      this.audioContext = context;\r\n      this.audible = context.createDelay();\r\n\r\n      this.analyser = context.createAnalyser();\r\n      this.analyser.smoothingTimeConstant = 0.0;\r\n      this.analyser.fftSize = this.fftSize;\r\n\r\n      this.audible.connect(this.analyser);\r\n\r\n      // Split channels\r\n      this.analyserL = context.createAnalyser();\r\n      this.analyserL.smoothingTimeConstant = 0.0;\r\n      this.analyserL.fftSize = this.fftSize;\r\n\r\n      this.analyserR = context.createAnalyser();\r\n      this.analyserR.smoothingTimeConstant = 0.0;\r\n      this.analyserR.fftSize = this.fftSize;\r\n\r\n      this.splitter = context.createChannelSplitter(2);\r\n\r\n      this.audible.connect(this.splitter);\r\n      this.splitter.connect(this.analyserL, 0);\r\n      this.splitter.connect(this.analyserR, 1);\r\n    }\r\n\r\n    // Initialised once as typed arrays\r\n    // Used for webaudio API raw (time domain) samples. 0 -> 255\r\n    this.timeByteArray = new Uint8Array(this.fftSize);\r\n    this.timeByteArrayL = new Uint8Array(this.fftSize);\r\n    this.timeByteArrayR = new Uint8Array(this.fftSize);\r\n\r\n    // Signed raw samples shifted to -128 -> 127\r\n    this.timeArray = new Int8Array(this.fftSize);\r\n    this.timeByteArraySignedL = new Int8Array(this.fftSize);\r\n    this.timeByteArraySignedR = new Int8Array(this.fftSize);\r\n\r\n    // Temporary array for smoothing\r\n    this.tempTimeArrayL = new Int8Array(this.fftSize);\r\n    this.tempTimeArrayR = new Int8Array(this.fftSize);\r\n\r\n    // Undersampled from this.fftSize to this.numSamps\r\n    this.timeArrayL = new Int8Array(this.numSamps);\r\n    this.timeArrayR = new Int8Array(this.numSamps);\r\n  }\r\n\r\n  sampleAudio() {\r\n    this.analyser.getByteTimeDomainData(this.timeByteArray);\r\n    this.analyserL.getByteTimeDomainData(this.timeByteArrayL);\r\n    this.analyserR.getByteTimeDomainData(this.timeByteArrayR);\r\n    this.processAudio();\r\n  }\r\n  updateAudio(timeByteArray, timeByteArrayL, timeByteArrayR) {\r\n    this.timeByteArray.set(timeByteArray);\r\n    this.timeByteArrayL.set(timeByteArrayL);\r\n    this.timeByteArrayR.set(timeByteArrayR);\r\n    this.processAudio();\r\n  }\r\n  /* eslint-disable no-bitwise */\r\n  processAudio() {\r\n    for (let i = 0, j = 0, lastIdx = 0; i < this.fftSize; i++) {\r\n      // Shift Unsigned to Signed about 0\r\n      this.timeArray[i] = this.timeByteArray[i] - 128;\r\n      this.timeByteArraySignedL[i] = this.timeByteArrayL[i] - 128;\r\n      this.timeByteArraySignedR[i] = this.timeByteArrayR[i] - 128;\r\n\r\n      this.tempTimeArrayL[i] =\r\n        0.5 *\r\n        (this.timeByteArraySignedL[i] + this.timeByteArraySignedL[lastIdx]);\r\n      this.tempTimeArrayR[i] =\r\n        0.5 *\r\n        (this.timeByteArraySignedR[i] + this.timeByteArraySignedR[lastIdx]);\r\n\r\n      // Undersampled\r\n      if (i % 2 === 0) {\r\n        this.timeArrayL[j] = this.tempTimeArrayL[i];\r\n        this.timeArrayR[j] = this.tempTimeArrayR[i];\r\n        j += 1;\r\n      }\r\n\r\n      lastIdx = i;\r\n    }\r\n\r\n    // Use full width samples for the FFT\r\n    this.freqArray = this.fft.timeToFrequencyDomain(this.timeArray);\r\n    this.freqArrayL = this.fft.timeToFrequencyDomain(this.timeByteArraySignedL);\r\n    this.freqArrayR = this.fft.timeToFrequencyDomain(this.timeByteArraySignedR);\r\n  }\r\n\r\n  connectAudio(audionode) {\r\n    audionode.connect(this.audible);\r\n  }\r\n\r\n  disconnectAudio(audionode) {\r\n    audionode.disconnect(this.audible);\r\n  }\r\n  /* eslint-enable no-bitwise */\r\n}\r\n","export default class AudioLevels {\r\n  constructor(audio) {\r\n    this.audio = audio;\r\n\r\n    let sampleRate;\r\n    if (this.audio.audioContext) {\r\n      sampleRate = this.audio.audioContext.sampleRate;\r\n    } else {\r\n      sampleRate = 44100;\r\n    }\r\n\r\n    const bucketHz = sampleRate / this.audio.fftSize;\r\n\r\n    const bassLow = Math.clamp(\r\n      Math.round(20 / bucketHz) - 1,\r\n      0,\r\n      this.audio.numSamps - 1\r\n    );\r\n    const bassHigh = Math.clamp(\r\n      Math.round(320 / bucketHz) - 1,\r\n      0,\r\n      this.audio.numSamps - 1\r\n    );\r\n    const midHigh = Math.clamp(\r\n      Math.round(2800 / bucketHz) - 1,\r\n      0,\r\n      this.audio.numSamps - 1\r\n    );\r\n    const trebHigh = Math.clamp(\r\n      Math.round(11025 / bucketHz) - 1,\r\n      0,\r\n      this.audio.numSamps - 1\r\n    );\r\n\r\n    this.starts = [bassLow, bassHigh, midHigh];\r\n    this.stops = [bassHigh, midHigh, trebHigh];\r\n\r\n    this.val = new Float32Array(3);\r\n    this.imm = new Float32Array(3);\r\n    this.att = new Float32Array(3);\r\n    this.avg = new Float32Array(3);\r\n    this.longAvg = new Float32Array(3);\r\n\r\n    this.att.fill(1);\r\n    this.avg.fill(1);\r\n    this.longAvg.fill(1);\r\n  }\r\n\r\n  /* eslint-disable camelcase */\r\n  get bass() {\r\n    return this.val[0];\r\n  }\r\n\r\n  get bass_att() {\r\n    return this.att[0];\r\n  }\r\n\r\n  get mid() {\r\n    return this.val[1];\r\n  }\r\n\r\n  get mid_att() {\r\n    return this.att[1];\r\n  }\r\n\r\n  get treb() {\r\n    return this.val[2];\r\n  }\r\n\r\n  get treb_att() {\r\n    return this.att[2];\r\n  }\r\n  /* eslint-enable camelcase */\r\n\r\n  static isFiniteNumber(num) {\r\n    return Number.isFinite(num) && !Number.isNaN(num);\r\n  }\r\n\r\n  static adjustRateToFPS(rate, baseFPS, FPS) {\r\n    return rate ** (baseFPS / FPS);\r\n  }\r\n\r\n  updateAudioLevels(fps, frame) {\r\n    if (this.audio.freqArray.length > 0) {\r\n      let effectiveFPS = fps;\r\n      if (!AudioLevels.isFiniteNumber(effectiveFPS) || effectiveFPS < 15) {\r\n        effectiveFPS = 15;\r\n      } else if (effectiveFPS > 144) {\r\n        effectiveFPS = 144;\r\n      }\r\n\r\n      // Clear for next loop\r\n      this.imm.fill(0);\r\n      for (let i = 0; i < 3; i++) {\r\n        for (let j = this.starts[i]; j < this.stops[i]; j++) {\r\n          this.imm[i] += this.audio.freqArray[j];\r\n        }\r\n      }\r\n\r\n      for (let i = 0; i < 3; i++) {\r\n        let rate;\r\n        if (this.imm[i] > this.avg[i]) {\r\n          rate = 0.2;\r\n        } else {\r\n          rate = 0.5;\r\n        }\r\n        rate = AudioLevels.adjustRateToFPS(rate, 30.0, effectiveFPS);\r\n        this.avg[i] = this.avg[i] * rate + this.imm[i] * (1 - rate);\r\n\r\n        if (frame < 50) {\r\n          rate = 0.9;\r\n        } else {\r\n          rate = 0.992;\r\n        }\r\n        rate = AudioLevels.adjustRateToFPS(rate, 30.0, effectiveFPS);\r\n        this.longAvg[i] = this.longAvg[i] * rate + this.imm[i] * (1 - rate);\r\n\r\n        if (this.longAvg[i] < 0.001) {\r\n          this.val[i] = 1.0;\r\n          this.att[i] = 1.0;\r\n        } else {\r\n          this.val[i] = this.imm[i] / this.longAvg[i];\r\n          this.att[i] = this.avg[i] / this.longAvg[i];\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","/* eslint-disable */\r\nconst pmap = {\r\n    baseVals: {\r\n      gammaadj: 1.25,\r\n      wave_g: 0.5,\r\n      mv_x: 12.0,\r\n      warpscale: 1.0,\r\n      brighten: 0.0,\r\n      mv_y: 9.0,\r\n      wave_scale: 1.0,\r\n      echo_alpha: 0.0,\r\n      additivewave: 0.0,\r\n      sx: 1.0,\r\n      sy: 1.0,\r\n      warp: 0.01,\r\n      red_blue: 0.0,\r\n      wave_mode: 0.0,\r\n      wave_brighten: 0.0,\r\n      wrap: 0.0,\r\n      zoomexp: 1.0,\r\n      fshader: 0.0,\r\n      wave_r: 0.5,\r\n      echo_zoom: 1.0,\r\n      wave_smoothing: 0.75,\r\n      warpanimspeed: 1.0,\r\n      wave_dots: 0.0,\r\n      wave_x: 0.5,\r\n      wave_y: 0.5,\r\n      zoom: 1.0,\r\n      solarize: 0.0,\r\n      modwavealphabyvolume: 0.0,\r\n      dx: 0.0,\r\n      cx: 0.5,\r\n      dy: 0.0,\r\n      darken_center: 0.0,\r\n      cy: 0.5,\r\n      invert: 0.0,\r\n      bmotionvectorson: 0.0,\r\n      rot: 0.0,\r\n      modwavealphaend: 0.95,\r\n      wave_mystery: -0.2,\r\n      decay: 0.9,\r\n      wave_a: 1.0,\r\n      wave_b: 0.5,\r\n      rating: 5.0,\r\n      modwavealphastart: 0.75,\r\n      darken: 0.0,\r\n      echo_orient: 0.0,\r\n      ib_r: 0.5,\r\n      ib_g: 0.5,\r\n      ib_b: 0.5,\r\n      ib_a: 0.0,\r\n      ib_size: 0.0,\r\n      ob_r: 0.5,\r\n      ob_g: 0.5,\r\n      ob_b: 0.5,\r\n      ob_a: 0.0,\r\n      ob_size: 0.0,\r\n      mv_dx: 0.0,\r\n      mv_dy: 0.0,\r\n      mv_a: 0.0,\r\n      mv_r: 0.5,\r\n      mv_g: 0.5,\r\n      mv_b: 0.5,\r\n      mv_l: 0.0,\r\n    },\r\n    init_eqs: function () {\r\n      var m = {};\r\n      return m;\r\n    },\r\n    frame_eqs: function (m) {\r\n      m.rkeys = [\"warp\"];\r\n      m.zoom = 1.01 + 0.02 * m.treb_att;\r\n      m.warp = 0.15 + 0.25 * m.bass_att;\r\n      return m;\r\n    },\r\n    pixel_eqs: function (m) {\r\n      m.warp = m.warp + m.rad * 0.15;\r\n      return m;\r\n    },\r\n    waves: [\r\n      {\r\n        baseVals: {\r\n          a: 1.0,\r\n          enabled: 0.0,\r\n          b: 1.0,\r\n          g: 1.0,\r\n          scaling: 1.0,\r\n          samples: 512.0,\r\n          additive: 0.0,\r\n          usedots: 0.0,\r\n          spectrum: 0.0,\r\n          r: 1.0,\r\n          smoothing: 0.5,\r\n          thick: 0.0,\r\n          sep: 0.0,\r\n        },\r\n        init_eqs: function (m) {\r\n          m.rkeys = [];\r\n          return m;\r\n        },\r\n        frame_eqs: function (m) {\r\n          return m;\r\n        },\r\n        point_eqs: \"\",\r\n      },\r\n      {\r\n        baseVals: {\r\n          a: 1.0,\r\n          enabled: 0.0,\r\n          b: 1.0,\r\n          g: 1.0,\r\n          scaling: 1.0,\r\n          samples: 512.0,\r\n          additive: 0.0,\r\n          usedots: 0.0,\r\n          spectrum: 0.0,\r\n          r: 1.0,\r\n          smoothing: 0.5,\r\n          thick: 0.0,\r\n          sep: 0.0,\r\n        },\r\n        init_eqs: function (m) {\r\n          m.rkeys = [];\r\n          return m;\r\n        },\r\n        frame_eqs: function (m) {\r\n          return m;\r\n        },\r\n        point_eqs: \"\",\r\n      },\r\n      {\r\n        baseVals: {\r\n          a: 1.0,\r\n          enabled: 0.0,\r\n          b: 1.0,\r\n          g: 1.0,\r\n          scaling: 1.0,\r\n          samples: 512.0,\r\n          additive: 0.0,\r\n          usedots: 0.0,\r\n          spectrum: 0.0,\r\n          r: 1.0,\r\n          smoothing: 0.5,\r\n          thick: 0.0,\r\n          sep: 0.0,\r\n        },\r\n        init_eqs: function (m) {\r\n          m.rkeys = [];\r\n          return m;\r\n        },\r\n        frame_eqs: function (m) {\r\n          return m;\r\n        },\r\n        point_eqs: \"\",\r\n      },\r\n      {\r\n        baseVals: {\r\n          a: 1.0,\r\n          enabled: 0.0,\r\n          b: 1.0,\r\n          g: 1.0,\r\n          scaling: 1.0,\r\n          samples: 512.0,\r\n          additive: 0.0,\r\n          usedots: 0.0,\r\n          spectrum: 0.0,\r\n          r: 1.0,\r\n          smoothing: 0.5,\r\n          thick: 0.0,\r\n          sep: 0.0,\r\n        },\r\n        init_eqs: function (m) {\r\n          m.rkeys = [];\r\n          return m;\r\n        },\r\n        frame_eqs: function (m) {\r\n          return m;\r\n        },\r\n        point_eqs: \"\",\r\n      },\r\n    ],\r\n    shapes: [\r\n      {\r\n        baseVals: {\r\n          r2: 0.0,\r\n          a: 1.0,\r\n          enabled: 0.0,\r\n          b: 0.0,\r\n          tex_ang: 0.0,\r\n          thickoutline: 0.0,\r\n          g: 0.0,\r\n          textured: 0.0,\r\n          g2: 1.0,\r\n          tex_zoom: 1.0,\r\n          additive: 0.0,\r\n          border_a: 0.1,\r\n          border_b: 1.0,\r\n          b2: 0.0,\r\n          a2: 0.0,\r\n          r: 1.0,\r\n          border_g: 1.0,\r\n          rad: 0.1,\r\n          x: 0.5,\r\n          y: 0.5,\r\n          ang: 0.0,\r\n          sides: 4.0,\r\n          border_r: 1.0,\r\n        },\r\n        init_eqs: function (m) {\r\n          m.rkeys = [];\r\n          return m;\r\n        },\r\n        frame_eqs: function (m) {\r\n          return m;\r\n        },\r\n      },\r\n      {\r\n        baseVals: {\r\n          r2: 0.0,\r\n          a: 1.0,\r\n          enabled: 0.0,\r\n          b: 0.0,\r\n          tex_ang: 0.0,\r\n          thickoutline: 0.0,\r\n          g: 0.0,\r\n          textured: 0.0,\r\n          g2: 1.0,\r\n          tex_zoom: 1.0,\r\n          additive: 0.0,\r\n          border_a: 0.1,\r\n          border_b: 1.0,\r\n          b2: 0.0,\r\n          a2: 0.0,\r\n          r: 1.0,\r\n          border_g: 1.0,\r\n          rad: 0.1,\r\n          x: 0.5,\r\n          y: 0.5,\r\n          ang: 0.0,\r\n          sides: 4.0,\r\n          border_r: 1.0,\r\n        },\r\n        init_eqs: function (m) {\r\n          m.rkeys = [];\r\n          return m;\r\n        },\r\n        frame_eqs: function (m) {\r\n          return m;\r\n        },\r\n      },\r\n      {\r\n        baseVals: {\r\n          r2: 0.0,\r\n          a: 1.0,\r\n          enabled: 0.0,\r\n          b: 0.0,\r\n          tex_ang: 0.0,\r\n          thickoutline: 0.0,\r\n          g: 0.0,\r\n          textured: 0.0,\r\n          g2: 1.0,\r\n          tex_zoom: 1.0,\r\n          additive: 0.0,\r\n          border_a: 0.1,\r\n          border_b: 1.0,\r\n          b2: 0.0,\r\n          a2: 0.0,\r\n          r: 1.0,\r\n          border_g: 1.0,\r\n          rad: 0.1,\r\n          x: 0.5,\r\n          y: 0.5,\r\n          ang: 0.0,\r\n          sides: 4.0,\r\n          border_r: 1.0,\r\n        },\r\n        init_eqs: function (m) {\r\n          m.rkeys = [];\r\n          return m;\r\n        },\r\n        frame_eqs: function (m) {\r\n          return m;\r\n        },\r\n      },\r\n      {\r\n        baseVals: {\r\n          r2: 0.0,\r\n          a: 1.0,\r\n          enabled: 0.0,\r\n          b: 0.0,\r\n          tex_ang: 0.0,\r\n          thickoutline: 0.0,\r\n          g: 0.0,\r\n          textured: 0.0,\r\n          g2: 1.0,\r\n          tex_zoom: 1.0,\r\n          additive: 0.0,\r\n          border_a: 0.1,\r\n          border_b: 1.0,\r\n          b2: 0.0,\r\n          a2: 0.0,\r\n          r: 1.0,\r\n          border_g: 1.0,\r\n          rad: 0.1,\r\n          x: 0.5,\r\n          y: 0.5,\r\n          ang: 0.0,\r\n          sides: 4.0,\r\n          border_r: 1.0,\r\n        },\r\n        init_eqs: function (m) {\r\n          m.rkeys = [];\r\n          return m;\r\n        },\r\n        frame_eqs: function (m) {\r\n          return m;\r\n        },\r\n      },\r\n    ],\r\n    warp:\r\n      \"shader_body {\\nret = texture2D(sampler_main, uv).rgb;\\nret -= 0.004;\\n}\\n\",\r\n    comp:\r\n      \"shader_body {\\nret = texture2D(sampler_main, uv).rgb;\\nret *= hue_shader;\\n}\\n\",\r\n  };\r\n\r\nexport default pmap;\r\n/* eslint-enable */\r\n","export default class Utils {\r\n  static atan2(x, y) {\r\n    let a = Math.atan2(x, y);\r\n    if (a < 0) {\r\n      a += 2 * Math.PI;\r\n    }\r\n    return a;\r\n  }\r\n\r\n  static cloneVars(vars) {\r\n    return Object.assign({}, vars);\r\n  }\r\n\r\n  static range(start, end) {\r\n    if (end === undefined) {\r\n      return [...Array(start).keys()];\r\n    }\r\n\r\n    return Array.from({ length: end - start }, (_, i) => i + start);\r\n  }\r\n\r\n  static pick(obj, keys) {\r\n    const newObj = {};\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const key = keys[i];\r\n      newObj[key] = obj[key] || 0;\r\n    }\r\n    return newObj;\r\n  }\r\n\r\n  static omit(obj, keys) {\r\n    const newObj = Object.assign({}, obj);\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const key = keys[i];\r\n      delete newObj[key];\r\n    }\r\n    return newObj;\r\n  }\r\n\r\n  static setWasm(wasmGlobals, obj, keys) {\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const key = keys[i];\r\n      // eslint-disable-next-line no-param-reassign\r\n      wasmGlobals[key].value = obj[key];\r\n    }\r\n  }\r\n\r\n  static pickWasm(wasmGlobals, keys) {\r\n    const newObj = {};\r\n    for (let i = 0; i < keys.length; i++) {\r\n      const key = keys[i];\r\n      newObj[key] = wasmGlobals[key].value;\r\n    }\r\n    return newObj;\r\n  }\r\n}\r\n","/**\r\n * SeededRandom - Deterministic pseudo-random number generator\r\n * Using xorshift128+ algorithm\r\n */\r\nexport class SeededRandom {\r\n  constructor(seed = 1) {\r\n    this.state = new Uint32Array(4);\r\n    SeededRandom.initializeState(this.state, seed);\r\n    this.warmUp();\r\n  }\r\n\r\n  static initializeState(state, seed) {\r\n    state[0] = seed;\r\n    state[1] = seed ^ 0x9e3779b9;\r\n    state[2] = seed ^ 0x6a09e667;\r\n    state[3] = seed ^ 0xbb67ae85;\r\n  }\r\n\r\n  warmUp() {\r\n    for (let i = 0; i < 10; i++) {\r\n      this.next();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generate next random number in [0, 1)\r\n   */\r\n  next() {\r\n    // xorshift128+ algorithm\r\n    let t = this.state[3];\r\n    let s = this.state[0];\r\n    this.state[3] = this.state[2];\r\n    this.state[2] = this.state[1];\r\n    this.state[1] = s;\r\n\r\n    t ^= t << 11;\r\n    t ^= t >>> 8;\r\n    this.state[0] = t ^ s ^ (s >>> 19);\r\n\r\n    // Convert to [0, 1) range\r\n    return (this.state[0] >>> 0) / 0x100000000;\r\n  }\r\n\r\n  /**\r\n   * Generate random integer in [0, max)\r\n   */\r\n  nextInt(max) {\r\n    return Math.floor(this.next() * max);\r\n  }\r\n\r\n  /**\r\n   * Generate random number in [0, max)\r\n   * Mimics butterchurn's rand() behavior\r\n   */\r\n  rand(max) {\r\n    if (max < 1) {\r\n      return this.next();\r\n    }\r\n    return Math.floor(this.next() * Math.floor(max));\r\n  }\r\n\r\n  /**\r\n   * Reset generator to initial seed\r\n   */\r\n  reset(seed) {\r\n    SeededRandom.initializeState(this.state, seed);\r\n    this.warmUp();\r\n  }\r\n}\r\n\r\nexport function createRNGContext(seed = 1) {\r\n  const rng = new SeededRandom(seed);\r\n\r\n  return {\r\n    random: () => rng.next(),\r\n    rand: (x) => rng.rand(x),\r\n    randint: (x) => Math.floor(rng.rand(x) + 1),\r\n    getRNG: () => rng,\r\n    reset: (newSeed) => {\r\n      if (newSeed !== undefined) {\r\n        rng.reset(newSeed);\r\n      } else {\r\n        rng.reset(seed);\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nexport function createDefaultRNGContext() {\r\n  return {\r\n    random: Math.random,\r\n    rand: (x) => x < 1 ? Math.random() : Math.random() * Math.floor(x),\r\n    randint: (x) => Math.floor((x < 1 ? Math.random() : Math.random() * Math.floor(x)) + 1),\r\n    getRNG: () => null,\r\n    reset: () => {}\r\n  };\r\n}\r\n","import { createRNGContext, createDefaultRNGContext } from './seededRandom';\r\n\r\nlet globalRNG = null;\r\nlet originalRand = null;\r\nlet originalRandint = null;\r\nlet originalMathRandom = null;\r\n\r\nexport function initializeRNG(opts = {}) {\r\n  if (opts.deterministic || opts.testMode) {\r\n    globalRNG = createRNGContext(opts.seed || 12345);\r\n  } else {\r\n    globalRNG = createDefaultRNGContext();\r\n  }\r\n\r\n  if (opts.deterministic || opts.testMode) {\r\n    if (!originalRand && window.rand) {\r\n      originalRand = window.rand;\r\n      originalRandint = window.randint;\r\n    }\r\n\r\n    if (!originalMathRandom) {\r\n      originalMathRandom = Math.random;\r\n    }\r\n\r\n    // Override globals with our RNG\r\n    window.rand = (x) => globalRNG.rand(x);\r\n    window.randint = (x) => globalRNG.randint(x);\r\n    Math.random = () => globalRNG.random();\r\n  }\r\n\r\n  return globalRNG;\r\n}\r\n\r\nexport function getRNG() {\r\n  if (!globalRNG) {\r\n    globalRNG = createDefaultRNGContext();\r\n  }\r\n  return globalRNG;\r\n}\r\n\r\n\r\nexport function cleanup() {\r\n  if (originalRand) {\r\n    window.rand = originalRand;\r\n    window.randint = originalRandint;\r\n    originalRand = null;\r\n    originalRandint = null;\r\n  }\r\n\r\n  if (originalMathRandom) {\r\n    Math.random = originalMathRandom;\r\n    originalMathRandom = null;\r\n  }\r\n\r\n  globalRNG = null;\r\n}","import Utils from \"../utils\";\r\nimport { getRNG } from \"../utils/rngContext\";\r\n\r\nexport default class PresetEquationRunner {\r\n  constructor(preset, globalVars, opts) {\r\n    this.rng = getRNG();\r\n    this.preset = preset;\r\n\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.qs = Utils.range(1, 33).map((x) => `q${x}`);\r\n    this.ts = Utils.range(1, 9).map((x) => `t${x}`);\r\n    this.regs = Utils.range(100).map((x) => {\r\n      if (x < 10) {\r\n        return `reg0${x}`;\r\n      }\r\n      return `reg${x}`;\r\n    });\r\n\r\n    this.initializeEquations(globalVars);\r\n  }\r\n\r\n  initializeEquations(globalVars) {\r\n    this.runVertEQs = this.preset.pixel_eqs !== \"\";\r\n\r\n    this.mdVSQInit = null;\r\n    this.mdVSRegs = null;\r\n    this.mdVSFrame = null;\r\n    this.mdVSUserKeys = null;\r\n    this.mdVSFrameMap = null;\r\n\r\n    this.mdVSShapes = null;\r\n    this.mdVSUserKeysShapes = null;\r\n    this.mdVSFrameMapShapes = null;\r\n\r\n    this.mdVSWaves = null;\r\n    this.mdVSUserKeysWaves = null;\r\n    this.mdVSFrameMapWaves = null;\r\n\r\n    this.mdVSQAfterFrame = null;\r\n\r\n    this.gmegabuf = new Array(1048576).fill(0);\r\n\r\n    const mdVSBase = {\r\n      frame: globalVars.frame,\r\n      time: globalVars.time,\r\n      fps: globalVars.fps,\r\n      bass: globalVars.bass,\r\n      bass_att: globalVars.bass_att,\r\n      mid: globalVars.mid,\r\n      mid_att: globalVars.mid_att,\r\n      treb: globalVars.treb,\r\n      treb_att: globalVars.treb_att,\r\n      meshx: this.mesh_width,\r\n      meshy: this.mesh_height,\r\n      aspectx: this.invAspectx,\r\n      aspecty: this.invAspecty,\r\n      pixelsx: this.texsizeX,\r\n      pixelsy: this.texsizeY,\r\n      gmegabuf: this.gmegabuf,\r\n    };\r\n\r\n    this.mdVS = Object.assign({}, this.preset.baseVals, mdVSBase);\r\n\r\n    this.mdVS.megabuf = new Array(1048576).fill(0);\r\n    this.mdVS.rand_start = new Float32Array([\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n    ]);\r\n    this.mdVS.rand_preset = new Float32Array([\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n    ]);\r\n\r\n    const nonUserKeys = this.qs.concat(this.regs, Object.keys(this.mdVS));\r\n\r\n    const mdVSAfterInit = this.preset.init_eqs(Utils.cloneVars(this.mdVS));\r\n\r\n    // qs need to be initialized to there init values every frame\r\n    this.mdVSQInit = Utils.pick(mdVSAfterInit, this.qs);\r\n    this.mdVSRegs = Utils.pick(mdVSAfterInit, this.regs);\r\n    const initUserVars = Utils.pick(\r\n      mdVSAfterInit,\r\n      Object.keys(Utils.omit(mdVSAfterInit, nonUserKeys))\r\n    );\r\n    initUserVars.megabuf = mdVSAfterInit.megabuf;\r\n    initUserVars.gmegabuf = mdVSAfterInit.gmegabuf;\r\n\r\n    this.mdVSFrame = this.preset.frame_eqs(\r\n      Object.assign({}, this.mdVS, this.mdVSQInit, this.mdVSRegs, initUserVars)\r\n    );\r\n\r\n    // user vars need to be copied between frames\r\n    this.mdVSUserKeys = Object.keys(Utils.omit(this.mdVSFrame, nonUserKeys));\r\n\r\n    // Determine vars to carry over between frames\r\n    this.mdVSFrameMap = Utils.pick(this.mdVSFrame, this.mdVSUserKeys);\r\n\r\n    // qs for shapes\r\n    this.mdVSQAfterFrame = Utils.pick(this.mdVSFrame, this.qs);\r\n    this.mdVSRegs = Utils.pick(this.mdVSFrame, this.regs);\r\n\r\n    this.mdVSWaves = [];\r\n    this.mdVSTWaveInits = [];\r\n    this.mdVSUserKeysWaves = [];\r\n    this.mdVSFrameMapWaves = [];\r\n    if (this.preset.waves && this.preset.waves.length > 0) {\r\n      for (let i = 0; i < this.preset.waves.length; i++) {\r\n        const wave = this.preset.waves[i];\r\n        const baseVals = wave.baseVals;\r\n        if (baseVals.enabled !== 0) {\r\n          let mdVSWave = Object.assign({}, baseVals, mdVSBase);\r\n\r\n          const nonUserWaveKeys = this.qs.concat(\r\n            this.ts,\r\n            this.regs,\r\n            Object.keys(mdVSWave)\r\n          );\r\n\r\n          Object.assign(mdVSWave, this.mdVSQAfterFrame, this.mdVSRegs);\r\n          mdVSWave.megabuf = new Array(1048576).fill(0);\r\n\r\n          if (wave.init_eqs) {\r\n            mdVSWave = wave.init_eqs(mdVSWave);\r\n\r\n            this.mdVSRegs = Utils.pick(mdVSWave, this.regs);\r\n\r\n            // base vals need to be reset\r\n            Object.assign(mdVSWave, baseVals);\r\n          }\r\n          this.mdVSWaves.push(mdVSWave);\r\n          this.mdVSTWaveInits.push(Utils.pick(mdVSWave, this.ts));\r\n\r\n          this.mdVSUserKeysWaves.push(\r\n            Object.keys(Utils.omit(mdVSWave, nonUserWaveKeys))\r\n          );\r\n          this.mdVSFrameMapWaves.push(\r\n            Utils.pick(mdVSWave, this.mdVSUserKeysWaves[i])\r\n          );\r\n        } else {\r\n          this.mdVSWaves.push({});\r\n          this.mdVSTWaveInits.push({});\r\n\r\n          this.mdVSUserKeysWaves.push([]);\r\n          this.mdVSFrameMapWaves.push({});\r\n        }\r\n      }\r\n    }\r\n\r\n    this.mdVSShapes = [];\r\n    this.mdVSTShapeInits = [];\r\n    this.mdVSUserKeysShapes = [];\r\n    this.mdVSFrameMapShapes = [];\r\n    if (this.preset.shapes && this.preset.shapes.length > 0) {\r\n      for (let i = 0; i < this.preset.shapes.length; i++) {\r\n        const shape = this.preset.shapes[i];\r\n        const baseVals = shape.baseVals;\r\n        if (baseVals.enabled !== 0) {\r\n          let mdVSShape = Object.assign({}, baseVals, mdVSBase);\r\n\r\n          const nonUserShapeKeys = this.qs.concat(\r\n            this.ts,\r\n            this.regs,\r\n            Object.keys(mdVSShape)\r\n          );\r\n\r\n          Object.assign(mdVSShape, this.mdVSQAfterFrame, this.mdVSRegs);\r\n          mdVSShape.megabuf = new Array(1048576).fill(0);\r\n\r\n          if (shape.init_eqs) {\r\n            mdVSShape = shape.init_eqs(mdVSShape);\r\n\r\n            this.mdVSRegs = Utils.pick(mdVSShape, this.regs);\r\n\r\n            // base vals need to be reset\r\n            Object.assign(mdVSShape, baseVals);\r\n          }\r\n          this.mdVSShapes.push(mdVSShape);\r\n          this.mdVSTShapeInits.push(Utils.pick(mdVSShape, this.ts));\r\n\r\n          this.mdVSUserKeysShapes.push(\r\n            Object.keys(Utils.omit(mdVSShape, nonUserShapeKeys))\r\n          );\r\n          this.mdVSFrameMapShapes.push(\r\n            Utils.pick(mdVSShape, this.mdVSUserKeysShapes[i])\r\n          );\r\n        } else {\r\n          this.mdVSShapes.push({});\r\n          this.mdVSTShapeInits.push({});\r\n\r\n          this.mdVSUserKeysShapes.push([]);\r\n          this.mdVSFrameMapShapes.push({});\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  updatePreset(preset, globalVars) {\r\n    this.preset = preset;\r\n    this.initializeEquations(globalVars);\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n  }\r\n\r\n  runFrameEquations(globalVars) {\r\n    this.mdVSFrame = Object.assign(\r\n      {},\r\n      this.mdVS,\r\n      this.mdVSQInit,\r\n      this.mdVSFrameMap,\r\n      globalVars\r\n    );\r\n\r\n    this.mdVSFrame = this.preset.frame_eqs(this.mdVSFrame);\r\n\r\n    this.mdVSFrameMap = Utils.pick(this.mdVSFrame, this.mdVSUserKeys);\r\n    this.mdVSQAfterFrame = Utils.pick(this.mdVSFrame, this.qs);\r\n\r\n    return this.mdVSFrame;\r\n  }\r\n\r\n  runPixelEquations(mdVSVertex) {\r\n    return this.preset.pixel_eqs(mdVSVertex);\r\n  }\r\n\r\n  runShapeFrameEquations(shapeIdx, mdVSShape) {\r\n    return this.preset.shapes[shapeIdx].frame_eqs(mdVSShape);\r\n  }\r\n\r\n  runWaveFrameEquations(waveIdx, mdVSWave) {\r\n    return this.preset.waves[waveIdx].frame_eqs(mdVSWave);\r\n  }\r\n\r\n  runWavePointEquations(waveIdx, mdVSWaveFrame) {\r\n    return this.preset.waves[waveIdx].point_eqs(mdVSWaveFrame);\r\n  }\r\n}\r\n","import Utils from \"../utils\";\r\nimport { getRNG } from \"../utils/rngContext\";\r\n\r\nexport default class PresetEquationRunnerWASM {\r\n  constructor(preset, globalVars, opts) {\r\n    this.rng = getRNG();\r\n    this.preset = preset;\r\n\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.qs = Utils.range(1, 33).map((x) => `q${x}`);\r\n    this.ts = Utils.range(1, 9).map((x) => `t${x}`);\r\n    this.regs = Utils.range(100).map((x) => {\r\n      if (x < 10) {\r\n        return `reg0${x}`;\r\n      }\r\n      return `reg${x}`;\r\n    });\r\n\r\n    this.globalKeys = [\r\n      \"frame\",\r\n      \"time\",\r\n      \"fps\",\r\n      \"bass\",\r\n      \"bass_att\",\r\n      \"mid\",\r\n      \"mid_att\",\r\n      \"treb\",\r\n      \"treb_att\",\r\n      \"meshx\",\r\n      \"meshy\",\r\n      \"aspectx\",\r\n      \"aspecty\",\r\n      \"pixelsx\",\r\n      \"pixelsy\",\r\n    ];\r\n\r\n    this.frameKeys = [\r\n      \"decay\",\r\n      \"wave_a\",\r\n      \"wave_r\",\r\n      \"wave_g\",\r\n      \"wave_b\",\r\n      \"wave_x\",\r\n      \"wave_y\",\r\n      \"wave_scale\",\r\n      \"wave_smoothing\",\r\n      \"wave_mode\",\r\n      \"old_wave_mode\",\r\n      \"wave_mystery\",\r\n      \"ob_size\",\r\n      \"ob_r\",\r\n      \"ob_g\",\r\n      \"ob_b\",\r\n      \"ob_a\",\r\n      \"ib_size\",\r\n      \"ib_r\",\r\n      \"ib_g\",\r\n      \"ib_b\",\r\n      \"ib_a\",\r\n      \"mv_x\",\r\n      \"mv_y\",\r\n      \"mv_dx\",\r\n      \"mv_dy\",\r\n      \"mv_l\",\r\n      \"mv_r\",\r\n      \"mv_g\",\r\n      \"mv_b\",\r\n      \"mv_a\",\r\n      \"echo_zoom\",\r\n      \"echo_alpha\",\r\n      \"echo_orient\",\r\n      \"wave_dots\",\r\n      \"wave_thick\",\r\n      \"additivewave\",\r\n      \"wave_brighten\",\r\n      \"modwavealphabyvolume\",\r\n      \"modwavealphastart\",\r\n      \"modwavealphaend\",\r\n      \"darken_center\",\r\n      \"gammaadj\",\r\n      \"warp\",\r\n      \"warpanimspeed\",\r\n      \"warpscale\",\r\n      \"zoom\",\r\n      \"zoomexp\",\r\n      \"rot\",\r\n      \"cx\",\r\n      \"cy\",\r\n      \"dx\",\r\n      \"dy\",\r\n      \"sx\",\r\n      \"sy\",\r\n      \"fshader\",\r\n      \"wrap\",\r\n      \"invert\",\r\n      \"brighten\",\r\n      \"darken\",\r\n      \"solarize\",\r\n      \"bmotionvectorson\",\r\n      \"b1n\",\r\n      \"b2n\",\r\n      \"b3n\",\r\n      \"b1x\",\r\n      \"b2x\",\r\n      \"b3x\",\r\n      \"b1ed\",\r\n    ];\r\n\r\n    this.waveFrameKeys = [\r\n      \"samples\",\r\n      \"sep\",\r\n      \"scaling\",\r\n      \"spectrum\",\r\n      \"smoothing\",\r\n      \"r\",\r\n      \"g\",\r\n      \"b\",\r\n      \"a\",\r\n    ];\r\n\r\n    this.waveFrameInputKeys = [\"samples\", \"r\", \"g\", \"b\", \"a\"];\r\n\r\n    this.initializeEquations(globalVars);\r\n  }\r\n\r\n  getQVars(pool) {\r\n    return Utils.pickWasm(this.preset.globalPools[pool], this.qs);\r\n  }\r\n\r\n  getTVars(pool) {\r\n    return Utils.pickWasm(this.preset.globalPools[pool], this.ts);\r\n  }\r\n\r\n  initializeEquations(globalVars) {\r\n    this.runVertEQs = !!this.preset.pixel_eqs;\r\n\r\n    this.mdVSQInit = null;\r\n    this.mdVSQAfterFrame = null;\r\n\r\n    const mdVSBase = {\r\n      frame: globalVars.frame,\r\n      time: globalVars.time,\r\n      fps: globalVars.fps,\r\n      bass: globalVars.bass,\r\n      bass_att: globalVars.bass_att,\r\n      mid: globalVars.mid,\r\n      mid_att: globalVars.mid_att,\r\n      treb: globalVars.treb,\r\n      treb_att: globalVars.treb_att,\r\n      meshx: this.mesh_width,\r\n      meshy: this.mesh_height,\r\n      aspectx: this.invAspectx,\r\n      aspecty: this.invAspecty,\r\n      pixelsx: this.texsizeX,\r\n      pixelsy: this.texsizeY,\r\n    };\r\n\r\n    this.mdVS = Object.assign({}, this.preset.baseVals, mdVSBase);\r\n\r\n    // eslint-disable-next-line max-len\r\n    Utils.setWasm(\r\n      this.preset.globalPools.perFrame,\r\n      this.mdVS,\r\n      Object.keys(this.mdVS)\r\n    );\r\n\r\n    this.rand_start = new Float32Array([\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n    ]);\r\n    this.rand_preset = new Float32Array([\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n      this.rng.random(),\r\n    ]);\r\n\r\n    this.preset.init_eqs();\r\n\r\n    // qs need to be initialized to there init values every frame\r\n    this.mdVSQInit = this.getQVars(\"perFrame\");\r\n\r\n    this.preset.frame_eqs();\r\n\r\n    this.mdVSQAfterFrame = this.getQVars(\"perFrame\");\r\n\r\n    this.mdVSTWaveInits = [];\r\n    if (this.preset.waves && this.preset.waves.length > 0) {\r\n      for (let i = 0; i < this.preset.waves.length; i++) {\r\n        const wave = this.preset.waves[i];\r\n        const baseVals = wave.baseVals;\r\n        if (baseVals.enabled !== 0) {\r\n          // eslint-disable-next-line max-len\r\n          Utils.setWasm(\r\n            this.preset.globalPools[`wavePerFrame${i}`],\r\n            baseVals,\r\n            Object.keys(baseVals)\r\n          );\r\n          if (wave.init_eqs) {\r\n            wave.init_eqs();\r\n\r\n            // base vals need to be reset\r\n            // eslint-disable-next-line max-len\r\n            Utils.setWasm(\r\n              this.preset.globalPools[`wavePerFrame${i}`],\r\n              baseVals,\r\n              Object.keys(baseVals)\r\n            );\r\n          }\r\n          this.mdVSTWaveInits.push(this.getTVars(`wavePerFrame${i}`));\r\n        } else {\r\n          this.mdVSTWaveInits.push({});\r\n        }\r\n      }\r\n    }\r\n\r\n    this.mdVSTShapeInits = [];\r\n    if (this.preset.shapes && this.preset.shapes.length > 0) {\r\n      for (let i = 0; i < this.preset.shapes.length; i++) {\r\n        const shape = this.preset.shapes[i];\r\n        const baseVals = shape.baseVals;\r\n        if (baseVals.enabled !== 0) {\r\n          // eslint-disable-next-line max-len\r\n          Utils.setWasm(\r\n            this.preset.globalPools[`shapePerFrame${i}`],\r\n            baseVals,\r\n            Object.keys(baseVals)\r\n          );\r\n          if (shape.init_eqs) {\r\n            shape.init_eqs();\r\n\r\n            // base vals need to be reset\r\n            // eslint-disable-next-line max-len\r\n            Utils.setWasm(\r\n              this.preset.globalPools[`shapePerFrame${i}`],\r\n              baseVals,\r\n              Object.keys(baseVals)\r\n            );\r\n          }\r\n          this.mdVSTShapeInits.push(this.getTVars(`shapePerFrame${i}`));\r\n        } else {\r\n          this.mdVSTShapeInits.push({});\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  updatePreset(preset, globalVars) {\r\n    this.preset = preset;\r\n    this.initializeEquations(globalVars);\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n  }\r\n\r\n  runFrameEquations(globalVars) {\r\n    Utils.setWasm(this.preset.globalPools.perFrame, this.mdVS, this.frameKeys);\r\n    Utils.setWasm(this.preset.globalPools.perFrame, this.mdVSQInit, this.qs);\r\n    Utils.setWasm(\r\n      this.preset.globalPools.perFrame,\r\n      globalVars,\r\n      this.globalKeys\r\n    );\r\n\r\n    this.preset.frame_eqs();\r\n    this.preset.save_qs();\r\n\r\n    this.mdVSQAfterFrame = this.getQVars(\"perFrame\");\r\n\r\n    // eslint-disable-next-line max-len\r\n    const mdVSFrame = Utils.pickWasm(this.preset.globalPools.perFrame, [\r\n      ...this.frameKeys,\r\n      ...this.globalKeys,\r\n    ]);\r\n    mdVSFrame.rand_preset = this.rand_preset;\r\n    mdVSFrame.rand_start = this.rand_start;\r\n\r\n    return mdVSFrame;\r\n  }\r\n\r\n  /* eslint-disable max-len */\r\n  runWaveFrameEquations(waveIdx, globalVars) {\r\n    const baseVals = this.preset.waves[waveIdx].baseVals;\r\n    Utils.setWasm(\r\n      this.preset.globalPools[`wavePerFrame${waveIdx}`],\r\n      baseVals,\r\n      this.waveFrameInputKeys\r\n    );\r\n    Utils.setWasm(\r\n      this.preset.globalPools[`wavePerFrame${waveIdx}`],\r\n      this.mdVSQAfterFrame,\r\n      this.qs\r\n    );\r\n    Utils.setWasm(\r\n      this.preset.globalPools[`wavePerFrame${waveIdx}`],\r\n      this.mdVSTWaveInits[waveIdx],\r\n      this.ts\r\n    );\r\n    Utils.setWasm(\r\n      this.preset.globalPools[`wavePerFrame${waveIdx}`],\r\n      globalVars,\r\n      this.globalKeys\r\n    );\r\n    this.preset.waves[waveIdx].frame_eqs();\r\n    return Utils.pickWasm(\r\n      this.preset.globalPools[`wavePerFrame${waveIdx}`],\r\n      this.waveFrameKeys\r\n    );\r\n  }\r\n  /* eslint-enable max-len */\r\n}\r\n","const lineMatcher = /uniform sampler2D sampler_(?:.+?);/g;\r\nconst samplerMatcher = /uniform sampler2D sampler_(.+?);/;\r\n\r\nexport default class ShaderUtils {\r\n  static getShaderParts(t) {\r\n    const sbIndex = t.indexOf(\"shader_body\");\r\n    if (t && sbIndex > -1) {\r\n      const beforeShaderBody = t.substring(0, sbIndex);\r\n      const afterShaderBody = t.substring(sbIndex);\r\n      const firstCurly = afterShaderBody.indexOf(\"{\");\r\n      const lastCurly = afterShaderBody.lastIndexOf(\"}\");\r\n      const shaderBody = afterShaderBody.substring(firstCurly + 1, lastCurly);\r\n      return [beforeShaderBody, shaderBody];\r\n    }\r\n\r\n    return [\"\", t];\r\n  }\r\n\r\n  static getFragmentFloatPrecision(gl) {\r\n    if (\r\n      gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT).precision >\r\n      0\r\n    ) {\r\n      return \"highp\";\r\n    } else if (\r\n      gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT)\r\n        .precision > 0\r\n    ) {\r\n      return \"mediump\";\r\n    }\r\n    return \"lowp\";\r\n  }\r\n\r\n  static getUserSamplers(text) {\r\n    const samplers = [];\r\n    const lineMatches = text.match(lineMatcher);\r\n    if (lineMatches && lineMatches.length > 0) {\r\n      for (let i = 0; i < lineMatches.length; i++) {\r\n        const samplerMatches = lineMatches[i].match(samplerMatcher);\r\n        if (samplerMatches && samplerMatches.length > 0) {\r\n          const sampler = samplerMatches[1];\r\n          samplers.push({ sampler });\r\n        }\r\n      }\r\n    }\r\n    return samplers;\r\n  }\r\n}\r\n","export default class WaveUtils {\r\n  /* eslint-disable no-param-reassign */\r\n  static smoothWave(positions, positionsSmoothed, nVertsIn, zCoord = false) {\r\n    const c1 = -0.15;\r\n    const c2 = 1.15;\r\n    const c3 = 1.15;\r\n    const c4 = -0.15;\r\n    const invSum = 1.0 / (c1 + c2 + c3 + c4);\r\n\r\n    let j = 0;\r\n\r\n    let iBelow = 0;\r\n    let iAbove;\r\n    let iAbove2 = 1;\r\n    for (let i = 0; i < nVertsIn - 1; i++) {\r\n      iAbove = iAbove2;\r\n      iAbove2 = Math.min(nVertsIn - 1, i + 2);\r\n\r\n      for (let k = 0; k < 3; k++) {\r\n        positionsSmoothed[j * 3 + k] = positions[i * 3 + k];\r\n      }\r\n\r\n      if (zCoord) {\r\n        for (let k = 0; k < 3; k++) {\r\n          positionsSmoothed[(j + 1) * 3 + k] =\r\n            (c1 * positions[iBelow * 3 + k] +\r\n              c2 * positions[i * 3 + k] +\r\n              c3 * positions[iAbove * 3 + k] +\r\n              c4 * positions[iAbove2 * 3 + k]) *\r\n            invSum;\r\n        }\r\n      } else {\r\n        for (let k = 0; k < 2; k++) {\r\n          positionsSmoothed[(j + 1) * 3 + k] =\r\n            (c1 * positions[iBelow * 3 + k] +\r\n              c2 * positions[i * 3 + k] +\r\n              c3 * positions[iAbove * 3 + k] +\r\n              c4 * positions[iAbove2 * 3 + k]) *\r\n            invSum;\r\n        }\r\n        positionsSmoothed[(j + 1) * 3 + 2] = 0;\r\n      }\r\n\r\n      iBelow = i;\r\n      j += 2;\r\n    }\r\n\r\n    for (let k = 0; k < 3; k++) {\r\n      positionsSmoothed[j * 3 + k] = positions[(nVertsIn - 1) * 3 + k];\r\n    }\r\n  }\r\n\r\n  static smoothWaveAndColor(\r\n    positions,\r\n    colors,\r\n    positionsSmoothed,\r\n    colorsSmoothed,\r\n    nVertsIn,\r\n    zCoord = false\r\n  ) {\r\n    const c1 = -0.15;\r\n    const c2 = 1.15;\r\n    const c3 = 1.15;\r\n    const c4 = -0.15;\r\n    const invSum = 1.0 / (c1 + c2 + c3 + c4);\r\n\r\n    let j = 0;\r\n\r\n    let iBelow = 0;\r\n    let iAbove;\r\n    let iAbove2 = 1;\r\n    for (let i = 0; i < nVertsIn - 1; i++) {\r\n      iAbove = iAbove2;\r\n      iAbove2 = Math.min(nVertsIn - 1, i + 2);\r\n\r\n      for (let k = 0; k < 3; k++) {\r\n        positionsSmoothed[j * 3 + k] = positions[i * 3 + k];\r\n      }\r\n\r\n      if (zCoord) {\r\n        for (let k = 0; k < 3; k++) {\r\n          positionsSmoothed[(j + 1) * 3 + k] =\r\n            (c1 * positions[iBelow * 3 + k] +\r\n              c2 * positions[i * 3 + k] +\r\n              c3 * positions[iAbove * 3 + k] +\r\n              c4 * positions[iAbove2 * 3 + k]) *\r\n            invSum;\r\n        }\r\n      } else {\r\n        for (let k = 0; k < 2; k++) {\r\n          positionsSmoothed[(j + 1) * 3 + k] =\r\n            (c1 * positions[iBelow * 3 + k] +\r\n              c2 * positions[i * 3 + k] +\r\n              c3 * positions[iAbove * 3 + k] +\r\n              c4 * positions[iAbove2 * 3 + k]) *\r\n            invSum;\r\n        }\r\n        positionsSmoothed[(j + 1) * 3 + 2] = 0;\r\n      }\r\n\r\n      for (let k = 0; k < 4; k++) {\r\n        colorsSmoothed[j * 4 + k] = colors[i * 4 + k];\r\n        colorsSmoothed[(j + 1) * 4 + k] = colors[i * 4 + k];\r\n      }\r\n\r\n      iBelow = i;\r\n      j += 2;\r\n    }\r\n\r\n    for (let k = 0; k < 3; k++) {\r\n      positionsSmoothed[j * 3 + k] = positions[(nVertsIn - 1) * 3 + k];\r\n    }\r\n\r\n    for (let k = 0; k < 4; k++) {\r\n      colorsSmoothed[j * 4 + k] = colors[(nVertsIn - 1) * 4 + k];\r\n    }\r\n  }\r\n\r\n  /* eslint-enable no-param-reassign */\r\n}\r\n","import ShaderUtils from \"../shaders/shaderUtils\";\r\nimport WaveUtils from \"./waveUtils\";\r\n\r\nexport default class BasicWaveform {\r\n  constructor(gl, opts = {}) {\r\n    this.gl = gl;\r\n\r\n    const numAudioSamples = 512;\r\n    this.positions = new Float32Array(numAudioSamples * 3);\r\n    this.positions2 = new Float32Array(numAudioSamples * 3);\r\n    this.oldPositions = new Float32Array(numAudioSamples * 3);\r\n    this.oldPositions2 = new Float32Array(numAudioSamples * 3);\r\n    this.smoothedPositions = new Float32Array((numAudioSamples * 2 - 1) * 3);\r\n    this.smoothedPositions2 = new Float32Array((numAudioSamples * 2 - 1) * 3);\r\n    this.color = [0, 0, 0, 1];\r\n\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n\r\n    this.vertexBuf = this.gl.createBuffer();\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      in vec3 aPos;\r\n      uniform vec2 thickOffset;\r\n      void main(void) {\r\n        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      precision highp int;\r\n      precision mediump sampler2D;\r\n      out vec4 fragColor;\r\n      uniform vec4 u_color;\r\n      void main(void) {\r\n        fragColor = u_color;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.aPosLoc = this.gl.getAttribLocation(this.shaderProgram, \"aPos\");\r\n\r\n    this.colorLoc = this.gl.getUniformLocation(this.shaderProgram, \"u_color\");\r\n    this.thickOffsetLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"thickOffset\"\r\n    );\r\n  }\r\n\r\n  static processWaveform(timeArray, mdVSFrame) {\r\n    const waveform = [];\r\n\r\n    const scale = mdVSFrame.wave_scale / 128.0;\r\n    const smooth = mdVSFrame.wave_smoothing;\r\n    const smooth2 = scale * (1.0 - smooth);\r\n\r\n    waveform.push(timeArray[0] * scale);\r\n    for (let i = 1; i < timeArray.length; i++) {\r\n      waveform.push(timeArray[i] * smooth2 + waveform[i - 1] * smooth);\r\n    }\r\n\r\n    return waveform;\r\n  }\r\n\r\n  generateWaveform(blending, blendProgress, timeArrayL, timeArrayR, mdVSFrame) {\r\n    let alpha = mdVSFrame.wave_a;\r\n    const vol = (mdVSFrame.bass + mdVSFrame.mid + mdVSFrame.treb) / 3.0;\r\n\r\n    if (vol > -0.01 && alpha > 0.001 && timeArrayL.length > 0) {\r\n      const waveL = BasicWaveform.processWaveform(timeArrayL, mdVSFrame);\r\n      const waveR = BasicWaveform.processWaveform(timeArrayR, mdVSFrame);\r\n\r\n      const newWaveMode = Math.floor(mdVSFrame.wave_mode) % 8;\r\n      const oldWaveMode = Math.floor(mdVSFrame.old_wave_mode) % 8;\r\n\r\n      const wavePosX = mdVSFrame.wave_x * 2.0 - 1.0;\r\n      const wavePosY = mdVSFrame.wave_y * 2.0 - 1.0;\r\n\r\n      this.numVert = 0;\r\n      this.oldNumVert = 0;\r\n\r\n      const its = blending && newWaveMode !== oldWaveMode ? 2 : 1;\r\n      for (let it = 0; it < its; it++) {\r\n        const waveMode = it === 0 ? newWaveMode : oldWaveMode;\r\n\r\n        let fWaveParam2 = mdVSFrame.wave_mystery;\r\n        if (\r\n          (waveMode === 0 || waveMode === 1 || waveMode === 4) &&\r\n          (fWaveParam2 < -1 || fWaveParam2 > 1)\r\n        ) {\r\n          fWaveParam2 = fWaveParam2 * 0.5 + 0.5;\r\n          fWaveParam2 -= Math.floor(fWaveParam2);\r\n          fWaveParam2 = Math.abs(fWaveParam2);\r\n          fWaveParam2 = fWaveParam2 * 2 - 1;\r\n        }\r\n\r\n        let numVert;\r\n        let positions;\r\n        let positions2;\r\n        if (it === 0) {\r\n          positions = this.positions;\r\n          positions2 = this.positions2;\r\n        } else {\r\n          positions = this.oldPositions;\r\n          positions2 = this.oldPositions2;\r\n        }\r\n\r\n        alpha = mdVSFrame.wave_a;\r\n        if (waveMode === 0) {\r\n          if (mdVSFrame.modwavealphabyvolume > 0) {\r\n            const alphaDiff =\r\n              mdVSFrame.modwavealphaend - mdVSFrame.modwavealphastart;\r\n            alpha *= (vol - mdVSFrame.modwavealphastart) / alphaDiff;\r\n          }\r\n          alpha = Math.clamp(alpha, 0, 1);\r\n\r\n          numVert = Math.floor(waveL.length / 2) + 1;\r\n          const numVertInv = 1.0 / (numVert - 1);\r\n          const sampleOffset = Math.floor((waveL.length - numVert) / 2);\r\n          for (let i = 0; i < numVert - 1; i++) {\r\n            let rad = 0.5 + 0.4 * waveR[i + sampleOffset] + fWaveParam2;\r\n            const ang = i * numVertInv * 2 * Math.PI + mdVSFrame.time * 0.2;\r\n\r\n            if (i < numVert / 10) {\r\n              let mix = i / (numVert * 0.1);\r\n              mix = 0.5 - 0.5 * Math.cos(mix * Math.PI);\r\n              const rad2 =\r\n                0.5 + 0.4 * waveR[i + numVert + sampleOffset] + fWaveParam2;\r\n              rad = (1.0 - mix) * rad2 + rad * mix;\r\n            }\r\n\r\n            positions[i * 3 + 0] =\r\n              rad * Math.cos(ang) * this.aspecty + wavePosX;\r\n            positions[i * 3 + 1] =\r\n              rad * Math.sin(ang) * this.aspectx + wavePosY;\r\n            positions[i * 3 + 2] = 0;\r\n          }\r\n\r\n          // connect the loop\r\n          positions[(numVert - 1) * 3 + 0] = positions[0];\r\n          positions[(numVert - 1) * 3 + 1] = positions[1];\r\n          positions[(numVert - 1) * 3 + 2] = 0;\r\n        } else if (waveMode === 1) {\r\n          alpha *= 1.25;\r\n          if (mdVSFrame.modwavealphabyvolume > 0) {\r\n            const alphaDiff =\r\n              mdVSFrame.modwavealphaend - mdVSFrame.modwavealphastart;\r\n            alpha *= (vol - mdVSFrame.modwavealphastart) / alphaDiff;\r\n          }\r\n          alpha = Math.clamp(alpha, 0, 1);\r\n\r\n          numVert = Math.floor(waveL.length / 2);\r\n          for (let i = 0; i < numVert; i++) {\r\n            const rad = 0.53 + 0.43 * waveR[i] + fWaveParam2;\r\n            const ang = waveL[i + 32] * 0.5 * Math.PI + mdVSFrame.time * 2.3;\r\n\r\n            positions[i * 3 + 0] =\r\n              rad * Math.cos(ang) * this.aspecty + wavePosX;\r\n            positions[i * 3 + 1] =\r\n              rad * Math.sin(ang) * this.aspectx + wavePosY;\r\n            positions[i * 3 + 2] = 0;\r\n          }\r\n        } else if (waveMode === 2) {\r\n          if (this.texsizeX < 1024) {\r\n            alpha *= 0.09;\r\n          } else if (this.texsizeX >= 1024 && this.texsizeX < 2048) {\r\n            alpha *= 0.11;\r\n          } else {\r\n            alpha *= 0.13;\r\n          }\r\n\r\n          if (mdVSFrame.modwavealphabyvolume > 0) {\r\n            const alphaDiff =\r\n              mdVSFrame.modwavealphaend - mdVSFrame.modwavealphastart;\r\n            alpha *= (vol - mdVSFrame.modwavealphastart) / alphaDiff;\r\n          }\r\n          alpha = Math.clamp(alpha, 0, 1);\r\n\r\n          numVert = waveL.length;\r\n          for (let i = 0; i < waveL.length; i++) {\r\n            positions[i * 3 + 0] = waveR[i] * this.aspecty + wavePosX;\r\n            positions[i * 3 + 1] =\r\n              waveL[(i + 32) % waveL.length] * this.aspectx + wavePosY;\r\n            positions[i * 3 + 2] = 0;\r\n          }\r\n        } else if (waveMode === 3) {\r\n          if (this.texsizeX < 1024) {\r\n            alpha *= 0.15;\r\n          } else if (this.texsizeX >= 1024 && this.texsizeX < 2048) {\r\n            alpha *= 0.22;\r\n          } else {\r\n            alpha *= 0.33;\r\n          }\r\n\r\n          alpha *= 1.3;\r\n          alpha *= mdVSFrame.treb * mdVSFrame.treb; // should be treb_imm\r\n\r\n          if (mdVSFrame.modwavealphabyvolume > 0) {\r\n            const alphaDiff =\r\n              mdVSFrame.modwavealphaend - mdVSFrame.modwavealphastart;\r\n            alpha *= (vol - mdVSFrame.modwavealphastart) / alphaDiff;\r\n          }\r\n          alpha = Math.clamp(alpha, 0, 1);\r\n\r\n          numVert = waveL.length;\r\n          for (let i = 0; i < waveL.length; i++) {\r\n            positions[i * 3 + 0] = waveR[i] * this.aspecty + wavePosX;\r\n            positions[i * 3 + 1] =\r\n              waveL[(i + 32) % waveL.length] * this.aspectx + wavePosY;\r\n            positions[i * 3 + 2] = 0;\r\n          }\r\n        } else if (waveMode === 4) {\r\n          if (mdVSFrame.modwavealphabyvolume > 0) {\r\n            const alphaDiff =\r\n              mdVSFrame.modwavealphaend - mdVSFrame.modwavealphastart;\r\n            alpha *= (vol - mdVSFrame.modwavealphastart) / alphaDiff;\r\n          }\r\n          alpha = Math.clamp(alpha, 0, 1);\r\n\r\n          numVert = waveL.length;\r\n          if (numVert > this.texsizeX / 3) {\r\n            numVert = Math.floor(this.texsizeX / 3);\r\n          }\r\n          const numVertInv = 1.0 / numVert;\r\n          const sampleOffset = Math.floor((waveL.length - numVert) / 2);\r\n\r\n          const w1 = 0.45 + 0.5 * (fWaveParam2 * 0.5 + 0.5);\r\n          const w2 = 1.0 - w1;\r\n          for (let i = 0; i < numVert; i++) {\r\n            let x =\r\n              2.0 * i * numVertInv +\r\n              (wavePosX - 1) +\r\n              waveR[(i + 25 + sampleOffset) % waveL.length] * 0.44;\r\n            let y = waveL[i + sampleOffset] * 0.47 + wavePosY;\r\n\r\n            // momentum\r\n            if (i > 1) {\r\n              x =\r\n                x * w2 +\r\n                w1 *\r\n                  (positions[(i - 1) * 3 + 0] * 2.0 -\r\n                    positions[(i - 2) * 3 + 0]);\r\n              y =\r\n                y * w2 +\r\n                w1 *\r\n                  (positions[(i - 1) * 3 + 1] * 2.0 -\r\n                    positions[(i - 2) * 3 + 1]);\r\n            }\r\n\r\n            positions[i * 3 + 0] = x;\r\n            positions[i * 3 + 1] = y;\r\n            positions[i * 3 + 2] = 0;\r\n          }\r\n        } else if (waveMode === 5) {\r\n          if (this.texsizeX < 1024) {\r\n            alpha *= 0.09;\r\n          } else if (this.texsizeX >= 1024 && this.texsizeX < 2048) {\r\n            alpha *= 0.11;\r\n          } else {\r\n            alpha *= 0.13;\r\n          }\r\n\r\n          if (mdVSFrame.modwavealphabyvolume > 0) {\r\n            const alphaDiff =\r\n              mdVSFrame.modwavealphaend - mdVSFrame.modwavealphastart;\r\n            alpha *= (vol - mdVSFrame.modwavealphastart) / alphaDiff;\r\n          }\r\n          alpha = Math.clamp(alpha, 0, 1);\r\n\r\n          const cosRot = Math.cos(mdVSFrame.time * 0.3);\r\n          const sinRot = Math.sin(mdVSFrame.time * 0.3);\r\n\r\n          numVert = waveL.length;\r\n          for (let i = 0; i < waveL.length; i++) {\r\n            const ioff = (i + 32) % waveL.length;\r\n            const x0 = waveR[i] * waveL[ioff] + waveL[i] * waveR[ioff];\r\n            const y0 = waveR[i] * waveR[i] - waveL[ioff] * waveL[ioff];\r\n\r\n            positions[i * 3 + 0] =\r\n              (x0 * cosRot - y0 * sinRot) * (this.aspecty + wavePosX);\r\n            positions[i * 3 + 1] =\r\n              (x0 * sinRot + y0 * cosRot) * (this.aspectx + wavePosY);\r\n            positions[i * 3 + 2] = 0;\r\n          }\r\n        } else if (waveMode === 6 || waveMode === 7) {\r\n          if (mdVSFrame.modwavealphabyvolume > 0) {\r\n            const alphaDiff =\r\n              mdVSFrame.modwavealphaend - mdVSFrame.modwavealphastart;\r\n            alpha *= (vol - mdVSFrame.modwavealphastart) / alphaDiff;\r\n          }\r\n          alpha = Math.clamp(alpha, 0, 1);\r\n\r\n          numVert = Math.floor(waveL.length / 2);\r\n          if (numVert > this.texsizeX / 3) {\r\n            numVert = Math.floor(this.texsizeX / 3);\r\n          }\r\n          const sampleOffset = Math.floor((waveL.length - numVert) / 2);\r\n\r\n          const ang = Math.PI * 0.5 * fWaveParam2;\r\n          let dx = Math.cos(ang);\r\n          let dy = Math.sin(ang);\r\n\r\n          const edgex = [\r\n            wavePosX * Math.cos(ang + Math.PI * 0.5) - dx * 3.0,\r\n            wavePosX * Math.cos(ang + Math.PI * 0.5) + dx * 3.0,\r\n          ];\r\n          const edgey = [\r\n            wavePosX * Math.sin(ang + Math.PI * 0.5) - dy * 3.0,\r\n            wavePosX * Math.sin(ang + Math.PI * 0.5) + dy * 3.0,\r\n          ];\r\n\r\n          for (let i = 0; i < 2; i++) {\r\n            for (let j = 0; j < 4; j++) {\r\n              let t;\r\n              let bClip = false;\r\n\r\n              switch (j) {\r\n                case 0:\r\n                  if (edgex[i] > 1.1) {\r\n                    t = (1.1 - edgex[1 - i]) / (edgex[i] - edgex[1 - i]);\r\n                    bClip = true;\r\n                  }\r\n                  break;\r\n                case 1:\r\n                  if (edgex[i] < -1.1) {\r\n                    t = (-1.1 - edgex[1 - i]) / (edgex[i] - edgex[1 - i]);\r\n                    bClip = true;\r\n                  }\r\n                  break;\r\n                case 2:\r\n                  if (edgey[i] > 1.1) {\r\n                    t = (1.1 - edgey[1 - i]) / (edgey[i] - edgey[1 - i]);\r\n                    bClip = true;\r\n                  }\r\n                  break;\r\n                case 3:\r\n                  if (edgey[i] < -1.1) {\r\n                    t = (-1.1 - edgey[1 - i]) / (edgey[i] - edgey[1 - i]);\r\n                    bClip = true;\r\n                  }\r\n                  break;\r\n                default:\r\n              }\r\n\r\n              if (bClip) {\r\n                const dxi = edgex[i] - edgex[1 - i];\r\n                const dyi = edgey[i] - edgey[1 - i];\r\n                edgex[i] = edgex[1 - i] + dxi * t;\r\n                edgey[i] = edgey[1 - i] + dyi * t;\r\n              }\r\n            }\r\n          }\r\n\r\n          dx = (edgex[1] - edgex[0]) / numVert;\r\n          dy = (edgey[1] - edgey[0]) / numVert;\r\n\r\n          const ang2 = Math.atan2(dy, dx);\r\n          const perpDx = Math.cos(ang2 + Math.PI * 0.5);\r\n          const perpDy = Math.sin(ang2 + Math.PI * 0.5);\r\n\r\n          if (waveMode === 6) {\r\n            for (let i = 0; i < numVert; i++) {\r\n              const sample = waveL[i + sampleOffset];\r\n              positions[i * 3 + 0] = edgex[0] + dx * i + perpDx * 0.25 * sample;\r\n              positions[i * 3 + 1] = edgey[0] + dy * i + perpDy * 0.25 * sample;\r\n              positions[i * 3 + 2] = 0;\r\n            }\r\n          } else if (waveMode === 7) {\r\n            const sep = (wavePosY * 0.5 + 0.5) ** 2;\r\n            for (let i = 0; i < numVert; i++) {\r\n              const sample = waveL[i + sampleOffset];\r\n              positions[i * 3 + 0] =\r\n                edgex[0] + dx * i + perpDx * (0.25 * sample + sep);\r\n              positions[i * 3 + 1] =\r\n                edgey[0] + dy * i + perpDy * (0.25 * sample + sep);\r\n              positions[i * 3 + 2] = 0;\r\n            }\r\n\r\n            for (let i = 0; i < numVert; i++) {\r\n              const sample = waveR[i + sampleOffset];\r\n              positions2[i * 3 + 0] =\r\n                edgex[0] + dx * i + perpDx * (0.25 * sample - sep);\r\n              positions2[i * 3 + 1] =\r\n                edgey[0] + dy * i + perpDy * (0.25 * sample - sep);\r\n              positions2[i * 3 + 2] = 0;\r\n            }\r\n          }\r\n        }\r\n\r\n        if (it === 0) {\r\n          this.positions = positions;\r\n          this.positions2 = positions2;\r\n          this.numVert = numVert;\r\n          this.alpha = alpha;\r\n        } else {\r\n          this.oldPositions = positions;\r\n          this.oldPositions2 = positions2;\r\n          this.oldNumVert = numVert;\r\n          this.oldAlpha = alpha;\r\n        }\r\n      }\r\n\r\n      const mix = 0.5 - 0.5 * Math.cos(blendProgress * Math.PI);\r\n      const mix2 = 1 - mix;\r\n\r\n      if (this.oldNumVert > 0) {\r\n        alpha = mix * this.alpha + mix2 * this.oldAlpha;\r\n      }\r\n\r\n      let r = Math.clamp(mdVSFrame.wave_r, 0, 1);\r\n      let g = Math.clamp(mdVSFrame.wave_g, 0, 1);\r\n      let b = Math.clamp(mdVSFrame.wave_b, 0, 1);\r\n\r\n      if (mdVSFrame.wave_brighten !== 0) {\r\n        const maxc = Math.max(r, g, b);\r\n        if (maxc > 0.01) {\r\n          r /= maxc;\r\n          g /= maxc;\r\n          b /= maxc;\r\n        }\r\n      }\r\n\r\n      this.color = [r, g, b, alpha];\r\n\r\n      if (this.oldNumVert > 0) {\r\n        if (newWaveMode === 7) {\r\n          const m = (this.oldNumVert - 1) / (this.numVert * 2);\r\n          for (let i = 0; i < this.numVert; i++) {\r\n            const fIdx = i * m;\r\n            const nIdx = Math.floor(fIdx);\r\n            const t = fIdx - nIdx;\r\n\r\n            const x =\r\n              this.oldPositions[nIdx * 3 + 0] * (1 - t) +\r\n              this.oldPositions[(nIdx + 1) * 3 + 0] * t;\r\n            const y =\r\n              this.oldPositions[nIdx * 3 + 1] * (1 - t) +\r\n              this.oldPositions[(nIdx + 1) * 3 + 1] * t;\r\n\r\n            this.positions[i * 3 + 0] =\r\n              this.positions[i * 3 + 0] * mix + x * mix2;\r\n            this.positions[i * 3 + 1] =\r\n              this.positions[i * 3 + 1] * mix + y * mix2;\r\n            this.positions[i * 3 + 2] = 0;\r\n          }\r\n\r\n          for (let i = 0; i < this.numVert; i++) {\r\n            const fIdx = (i + this.numVert) * m;\r\n            const nIdx = Math.floor(fIdx);\r\n            const t = fIdx - nIdx;\r\n\r\n            const x =\r\n              this.oldPositions[nIdx * 3 + 0] * (1 - t) +\r\n              this.oldPositions[(nIdx + 1) * 3 + 0] * t;\r\n            const y =\r\n              this.oldPositions[nIdx * 3 + 1] * (1 - t) +\r\n              this.oldPositions[(nIdx + 1) * 3 + 1] * t;\r\n\r\n            this.positions2[i * 3 + 0] =\r\n              this.positions2[i * 3 + 0] * mix + x * mix2;\r\n            this.positions2[i * 3 + 1] =\r\n              this.positions2[i * 3 + 1] * mix + y * mix2;\r\n            this.positions2[i * 3 + 2] = 0;\r\n          }\r\n        } else if (oldWaveMode === 7) {\r\n          const halfNumVert = this.numVert / 2;\r\n          const m = (this.oldNumVert - 1) / halfNumVert;\r\n          for (let i = 0; i < halfNumVert; i++) {\r\n            const fIdx = i * m;\r\n            const nIdx = Math.floor(fIdx);\r\n            const t = fIdx - nIdx;\r\n\r\n            const x =\r\n              this.oldPositions[nIdx * 3 + 0] * (1 - t) +\r\n              this.oldPositions[(nIdx + 1) * 3 + 0] * t;\r\n            const y =\r\n              this.oldPositions[nIdx * 3 + 1] * (1 - t) +\r\n              this.oldPositions[(nIdx + 1) * 3 + 1] * t;\r\n\r\n            this.positions[i * 3 + 0] =\r\n              this.positions[i * 3 + 0] * mix + x * mix2;\r\n            this.positions[i * 3 + 1] =\r\n              this.positions[i * 3 + 1] * mix + y * mix2;\r\n            this.positions[i * 3 + 2] = 0;\r\n          }\r\n\r\n          for (let i = 0; i < halfNumVert; i++) {\r\n            const fIdx = i * m;\r\n            const nIdx = Math.floor(fIdx);\r\n            const t = fIdx - nIdx;\r\n\r\n            const x =\r\n              this.oldPositions2[nIdx * 3 + 0] * (1 - t) +\r\n              this.oldPositions2[(nIdx + 1) * 3 + 0] * t;\r\n            const y =\r\n              this.oldPositions2[nIdx * 3 + 1] * (1 - t) +\r\n              this.oldPositions2[(nIdx + 1) * 3 + 1] * t;\r\n\r\n            this.positions2[i * 3 + 0] =\r\n              this.positions[(i + halfNumVert) * 3 + 0] * mix + x * mix2;\r\n            this.positions2[i * 3 + 1] =\r\n              this.positions[(i + halfNumVert) * 3 + 1] * mix + y * mix2;\r\n            this.positions2[i * 3 + 2] = 0;\r\n          }\r\n        } else {\r\n          const m = (this.oldNumVert - 1) / this.numVert;\r\n          for (let i = 0; i < this.numVert; i++) {\r\n            const fIdx = i * m;\r\n            const nIdx = Math.floor(fIdx);\r\n            const t = fIdx - nIdx;\r\n\r\n            const x =\r\n              this.oldPositions[nIdx * 3 + 0] * (1 - t) +\r\n              this.oldPositions[(nIdx + 1) * 3 + 0] * t;\r\n            const y =\r\n              this.oldPositions[nIdx * 3 + 1] * (1 - t) +\r\n              this.oldPositions[(nIdx + 1) * 3 + 1] * t;\r\n\r\n            this.positions[i * 3 + 0] =\r\n              this.positions[i * 3 + 0] * mix + x * mix2;\r\n            this.positions[i * 3 + 1] =\r\n              this.positions[i * 3 + 1] * mix + y * mix2;\r\n            this.positions[i * 3 + 2] = 0;\r\n          }\r\n        }\r\n      }\r\n\r\n      for (let i = 0; i < this.numVert; i++) {\r\n        this.positions[i * 3 + 1] = -this.positions[i * 3 + 1];\r\n      }\r\n\r\n      this.smoothedNumVert = this.numVert * 2 - 1;\r\n      WaveUtils.smoothWave(\r\n        this.positions,\r\n        this.smoothedPositions,\r\n        this.numVert\r\n      );\r\n\r\n      if (newWaveMode === 7 || oldWaveMode === 7) {\r\n        for (let i = 0; i < this.numVert; i++) {\r\n          this.positions2[i * 3 + 1] = -this.positions2[i * 3 + 1];\r\n        }\r\n\r\n        WaveUtils.smoothWave(\r\n          this.positions2,\r\n          this.smoothedPositions2,\r\n          this.numVert\r\n        );\r\n      }\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  drawBasicWaveform(\r\n    blending,\r\n    blendProgress,\r\n    timeArrayL,\r\n    timeArrayR,\r\n    mdVSFrame\r\n  ) {\r\n    if (\r\n      this.generateWaveform(\r\n        blending,\r\n        blendProgress,\r\n        timeArrayL,\r\n        timeArrayR,\r\n        mdVSFrame\r\n      )\r\n    ) {\r\n      this.gl.useProgram(this.shaderProgram);\r\n\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuf);\r\n      this.gl.bufferData(\r\n        this.gl.ARRAY_BUFFER,\r\n        this.smoothedPositions,\r\n        this.gl.STATIC_DRAW\r\n      );\r\n\r\n      this.gl.vertexAttribPointer(this.aPosLoc, 3, this.gl.FLOAT, false, 0, 0);\r\n      this.gl.enableVertexAttribArray(this.aPosLoc);\r\n\r\n      this.gl.uniform4fv(this.colorLoc, this.color);\r\n\r\n      let instances = 1;\r\n      if (mdVSFrame.wave_thick !== 0 || mdVSFrame.wave_dots !== 0) {\r\n        instances = 4;\r\n      }\r\n\r\n      if (mdVSFrame.additivewave !== 0) {\r\n        this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE);\r\n      } else {\r\n        this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n      }\r\n\r\n      const drawMode =\r\n        mdVSFrame.wave_dots !== 0 ? this.gl.POINTS : this.gl.LINE_STRIP;\r\n\r\n      // TODO: use drawArraysInstanced\r\n      for (let i = 0; i < instances; i++) {\r\n        const offset = 2;\r\n        if (i === 0) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [0, 0]);\r\n        } else if (i === 1) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [offset / this.texsizeX, 0]);\r\n        } else if (i === 2) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [0, offset / this.texsizeY]);\r\n        } else if (i === 3) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [\r\n            offset / this.texsizeX,\r\n            offset / this.texsizeY,\r\n          ]);\r\n        }\r\n\r\n        this.gl.drawArrays(drawMode, 0, this.smoothedNumVert);\r\n      }\r\n\r\n      const waveMode = Math.floor(mdVSFrame.wave_mode) % 8;\r\n      if (waveMode === 7) {\r\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuf);\r\n        this.gl.bufferData(\r\n          this.gl.ARRAY_BUFFER,\r\n          this.smoothedPositions2,\r\n          this.gl.STATIC_DRAW\r\n        );\r\n\r\n        this.gl.vertexAttribPointer(\r\n          this.aPosLoc,\r\n          3,\r\n          this.gl.FLOAT,\r\n          false,\r\n          0,\r\n          0\r\n        );\r\n        this.gl.enableVertexAttribArray(this.aPosLoc);\r\n\r\n        for (let i = 0; i < instances; i++) {\r\n          const offset = 2;\r\n          if (i === 0) {\r\n            this.gl.uniform2fv(this.thickOffsetLoc, [0, 0]);\r\n          } else if (i === 1) {\r\n            this.gl.uniform2fv(this.thickOffsetLoc, [\r\n              offset / this.texsizeX,\r\n              0,\r\n            ]);\r\n          } else if (i === 2) {\r\n            this.gl.uniform2fv(this.thickOffsetLoc, [\r\n              0,\r\n              offset / this.texsizeY,\r\n            ]);\r\n          } else if (i === 3) {\r\n            this.gl.uniform2fv(this.thickOffsetLoc, [\r\n              offset / this.texsizeX,\r\n              offset / this.texsizeY,\r\n            ]);\r\n          }\r\n\r\n          this.gl.drawArrays(drawMode, 0, this.smoothedNumVert);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","import Utils from \"../../utils\";\r\nimport ShaderUtils from \"../shaders/shaderUtils\";\r\nimport WaveUtils from \"./waveUtils\";\r\n\r\nexport default class CustomWaveform {\r\n  constructor(index, gl, opts) {\r\n    this.index = index;\r\n    this.gl = gl;\r\n\r\n    const maxSamples = 512;\r\n    this.pointsData = [\r\n      new Float32Array(maxSamples),\r\n      new Float32Array(maxSamples),\r\n    ];\r\n    this.positions = new Float32Array(maxSamples * 3);\r\n    this.colors = new Float32Array(maxSamples * 4);\r\n    this.smoothedPositions = new Float32Array((maxSamples * 2 - 1) * 3);\r\n    this.smoothedColors = new Float32Array((maxSamples * 2 - 1) * 4);\r\n\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.positionVertexBuf = this.gl.createBuffer();\r\n    this.colorVertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      uniform float uSize;\r\n      uniform vec2 thickOffset;\r\n      in vec3 aPos;\r\n      in vec4 aColor;\r\n      out vec4 vColor;\r\n      void main(void) {\r\n        vColor = aColor;\r\n        gl_PointSize = uSize;\r\n        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      precision highp int;\r\n      precision mediump sampler2D;\r\n      in vec4 vColor;\r\n      out vec4 fragColor;\r\n      void main(void) {\r\n        fragColor = vColor;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.aPosLocation = this.gl.getAttribLocation(this.shaderProgram, \"aPos\");\r\n    this.aColorLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aColor\"\r\n    );\r\n\r\n    this.sizeLoc = this.gl.getUniformLocation(this.shaderProgram, \"uSize\");\r\n    this.thickOffsetLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"thickOffset\"\r\n    );\r\n  }\r\n\r\n  generateWaveform(\r\n    timeArrayL,\r\n    timeArrayR,\r\n    freqArrayL,\r\n    freqArrayR,\r\n    globalVars,\r\n    presetEquationRunner,\r\n    waveEqs,\r\n    alphaMult\r\n  ) {\r\n    if (waveEqs.baseVals.enabled !== 0 && timeArrayL.length > 0) {\r\n      let mdVSWaveFrame;\r\n      if (presetEquationRunner.preset.useWASM) {\r\n        mdVSWaveFrame = presetEquationRunner.runWaveFrameEquations(\r\n          this.index,\r\n          globalVars\r\n        );\r\n      } else {\r\n        const mdVSWave = Object.assign(\r\n          {},\r\n          presetEquationRunner.mdVSWaves[this.index],\r\n          presetEquationRunner.mdVSFrameMapWaves[this.index],\r\n          presetEquationRunner.mdVSQAfterFrame,\r\n          presetEquationRunner.mdVSTWaveInits[this.index],\r\n          globalVars\r\n        );\r\n\r\n        mdVSWaveFrame = presetEquationRunner.runWaveFrameEquations(\r\n          this.index,\r\n          mdVSWave\r\n        );\r\n      }\r\n\r\n      const maxSamples = 512;\r\n      if (Object.prototype.hasOwnProperty.call(mdVSWaveFrame, \"samples\")) {\r\n        this.samples = mdVSWaveFrame.samples;\r\n      } else {\r\n        this.samples = maxSamples;\r\n      }\r\n\r\n      if (this.samples > maxSamples) {\r\n        this.samples = maxSamples;\r\n      }\r\n      this.samples = Math.floor(this.samples);\r\n\r\n      const baseVals = presetEquationRunner.preset.waves[this.index].baseVals;\r\n\r\n      const sep = Math.floor(mdVSWaveFrame.sep);\r\n      const scaling = mdVSWaveFrame.scaling;\r\n      const spectrum = mdVSWaveFrame.spectrum;\r\n      const smoothing = mdVSWaveFrame.smoothing;\r\n      const usedots = baseVals.usedots;\r\n\r\n      const frameR = mdVSWaveFrame.r;\r\n      const frameG = mdVSWaveFrame.g;\r\n      const frameB = mdVSWaveFrame.b;\r\n      const frameA = mdVSWaveFrame.a;\r\n\r\n      const waveScale = presetEquationRunner.preset.baseVals.wave_scale;\r\n\r\n      this.samples -= sep;\r\n\r\n      if (this.samples >= 2 || (usedots !== 0 && this.samples >= 1)) {\r\n        const useSpectrum = spectrum !== 0;\r\n        const scale = (useSpectrum ? 0.15 : 0.004) * scaling * waveScale;\r\n        const pointsLeft = useSpectrum ? freqArrayL : timeArrayL;\r\n        const pointsRight = useSpectrum ? freqArrayR : timeArrayR;\r\n\r\n        const j0 = useSpectrum\r\n          ? 0\r\n          : Math.floor((maxSamples - this.samples) / 2 - sep / 2);\r\n        const j1 = useSpectrum\r\n          ? 0\r\n          : Math.floor((maxSamples - this.samples) / 2 + sep / 2);\r\n        const t = useSpectrum ? (maxSamples - sep) / this.samples : 1;\r\n        const mix1 = (smoothing * 0.98) ** 0.5;\r\n        const mix2 = 1 - mix1;\r\n\r\n        // Milkdrop smooths waveform forward, backward and then scales\r\n        this.pointsData[0][0] = pointsLeft[j0];\r\n        this.pointsData[1][0] = pointsRight[j1];\r\n        for (let j = 1; j < this.samples; j++) {\r\n          const left = pointsLeft[Math.floor(j * t + j0)];\r\n          const right = pointsRight[Math.floor(j * t + j1)];\r\n          this.pointsData[0][j] =\r\n            left * mix2 + this.pointsData[0][j - 1] * mix1;\r\n          this.pointsData[1][j] =\r\n            right * mix2 + this.pointsData[1][j - 1] * mix1;\r\n        }\r\n        for (let j = this.samples - 2; j >= 0; j--) {\r\n          this.pointsData[0][j] =\r\n            this.pointsData[0][j] * mix2 + this.pointsData[0][j + 1] * mix1;\r\n          this.pointsData[1][j] =\r\n            this.pointsData[1][j] * mix2 + this.pointsData[1][j + 1] * mix1;\r\n        }\r\n        for (let j = 0; j < this.samples; j++) {\r\n          this.pointsData[0][j] *= scale;\r\n          this.pointsData[1][j] *= scale;\r\n        }\r\n\r\n        if (!presetEquationRunner.preset.useWASM) {\r\n          for (let j = 0; j < this.samples; j++) {\r\n            const value1 = this.pointsData[0][j];\r\n            const value2 = this.pointsData[1][j];\r\n\r\n            mdVSWaveFrame.sample = j / (this.samples - 1);\r\n            mdVSWaveFrame.value1 = value1;\r\n            mdVSWaveFrame.value2 = value2;\r\n            mdVSWaveFrame.x = 0.5 + value1;\r\n            mdVSWaveFrame.y = 0.5 + value2;\r\n            mdVSWaveFrame.r = frameR;\r\n            mdVSWaveFrame.g = frameG;\r\n            mdVSWaveFrame.b = frameB;\r\n            mdVSWaveFrame.a = frameA;\r\n\r\n            if (waveEqs.point_eqs !== \"\") {\r\n              mdVSWaveFrame = presetEquationRunner.runWavePointEquations(\r\n                this.index,\r\n                mdVSWaveFrame\r\n              );\r\n            }\r\n\r\n            const x = (mdVSWaveFrame.x * 2 - 1) * this.invAspectx;\r\n            const y = (mdVSWaveFrame.y * -2 + 1) * this.invAspecty;\r\n            const r = mdVSWaveFrame.r;\r\n            const g = mdVSWaveFrame.g;\r\n            const b = mdVSWaveFrame.b;\r\n            const a = mdVSWaveFrame.a;\r\n\r\n            this.positions[j * 3 + 0] = x;\r\n            this.positions[j * 3 + 1] = y;\r\n            this.positions[j * 3 + 2] = 0;\r\n\r\n            this.colors[j * 4 + 0] = r;\r\n            this.colors[j * 4 + 1] = g;\r\n            this.colors[j * 4 + 2] = b;\r\n            this.colors[j * 4 + 3] = a * alphaMult;\r\n          }\r\n        } else {\r\n          const varPool =\r\n            presetEquationRunner.preset.globalPools[\r\n              `wavePerFrame${this.index}`\r\n            ];\r\n          for (let j = 0; j < this.samples; j++) {\r\n            const value1 = this.pointsData[0][j];\r\n            const value2 = this.pointsData[1][j];\r\n\r\n            varPool.sample.value = j / (this.samples - 1);\r\n            varPool.value1.value = value1;\r\n            varPool.value2.value = value2;\r\n            varPool.x.value = 0.5 + value1;\r\n            varPool.y.value = 0.5 + value2;\r\n            varPool.r.value = frameR;\r\n            varPool.g.value = frameG;\r\n            varPool.b.value = frameB;\r\n            varPool.a.value = frameA;\r\n\r\n            if (waveEqs.point_eqs) {\r\n              presetEquationRunner.preset.waves[this.index].point_eqs();\r\n            }\r\n\r\n            const x = (varPool.x.value * 2 - 1) * this.invAspectx;\r\n            const y = (varPool.y.value * -2 + 1) * this.invAspecty;\r\n            const r = varPool.r.value;\r\n            const g = varPool.g.value;\r\n            const b = varPool.b.value;\r\n            const a = varPool.a.value;\r\n\r\n            this.positions[j * 3 + 0] = x;\r\n            this.positions[j * 3 + 1] = y;\r\n            this.positions[j * 3 + 2] = 0;\r\n\r\n            this.colors[j * 4 + 0] = r;\r\n            this.colors[j * 4 + 1] = g;\r\n            this.colors[j * 4 + 2] = b;\r\n            this.colors[j * 4 + 3] = a * alphaMult;\r\n          }\r\n        }\r\n\r\n        // this needs to be after per point (check fishbrain - witchcraft)\r\n        if (!presetEquationRunner.preset.useWASM) {\r\n          const mdvsUserKeysWave =\r\n            presetEquationRunner.mdVSUserKeysWaves[this.index];\r\n          const mdVSNewFrameMapWave = Utils.pick(\r\n            mdVSWaveFrame,\r\n            mdvsUserKeysWave\r\n          );\r\n\r\n          // eslint-disable-next-line no-param-reassign\r\n          presetEquationRunner.mdVSFrameMapWaves[\r\n            this.index\r\n          ] = mdVSNewFrameMapWave;\r\n        } else {\r\n          mdVSWaveFrame.usedots = usedots;\r\n          mdVSWaveFrame.thick = baseVals.thick;\r\n          mdVSWaveFrame.additive = baseVals.additive;\r\n        }\r\n\r\n        this.mdVSWaveFrame = mdVSWaveFrame;\r\n\r\n        if (usedots === 0) {\r\n          WaveUtils.smoothWaveAndColor(\r\n            this.positions,\r\n            this.colors,\r\n            this.smoothedPositions,\r\n            this.smoothedColors,\r\n            this.samples\r\n          );\r\n        }\r\n\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  drawCustomWaveform(\r\n    blendProgress,\r\n    timeArrayL,\r\n    timeArrayR,\r\n    freqArrayL,\r\n    freqArrayR,\r\n    globalVars,\r\n    presetEquationRunner,\r\n    waveEqs\r\n  ) {\r\n    if (\r\n      waveEqs &&\r\n      this.generateWaveform(\r\n        timeArrayL,\r\n        timeArrayR,\r\n        freqArrayL,\r\n        freqArrayR,\r\n        globalVars,\r\n        presetEquationRunner,\r\n        waveEqs,\r\n        blendProgress\r\n      )\r\n    ) {\r\n      this.gl.useProgram(this.shaderProgram);\r\n\r\n      const waveUseDots = this.mdVSWaveFrame.usedots !== 0;\r\n      const waveThick = this.mdVSWaveFrame.thick !== 0;\r\n      const waveAdditive = this.mdVSWaveFrame.additive !== 0;\r\n\r\n      let positions;\r\n      let colors;\r\n      let numVerts;\r\n      if (!waveUseDots) {\r\n        positions = this.smoothedPositions;\r\n        colors = this.smoothedColors;\r\n        numVerts = this.samples * 2 - 1;\r\n      } else {\r\n        positions = this.positions;\r\n        colors = this.colors;\r\n        numVerts = this.samples;\r\n      }\r\n\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionVertexBuf);\r\n      this.gl.bufferData(this.gl.ARRAY_BUFFER, positions, this.gl.STATIC_DRAW);\r\n\r\n      this.gl.vertexAttribPointer(\r\n        this.aPosLocation,\r\n        3,\r\n        this.gl.FLOAT,\r\n        false,\r\n        0,\r\n        0\r\n      );\r\n      this.gl.enableVertexAttribArray(this.aPosLocation);\r\n\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.colorVertexBuf);\r\n      this.gl.bufferData(this.gl.ARRAY_BUFFER, colors, this.gl.STATIC_DRAW);\r\n\r\n      this.gl.vertexAttribPointer(\r\n        this.aColorLocation,\r\n        4,\r\n        this.gl.FLOAT,\r\n        false,\r\n        0,\r\n        0\r\n      );\r\n      this.gl.enableVertexAttribArray(this.aColorLocation);\r\n\r\n      let instances = 1;\r\n      if (waveUseDots) {\r\n        if (waveThick) {\r\n          this.gl.uniform1f(this.sizeLoc, 2 + (this.texsizeX >= 1024 ? 1 : 0));\r\n        } else {\r\n          this.gl.uniform1f(this.sizeLoc, 1 + (this.texsizeX >= 1024 ? 1 : 0));\r\n        }\r\n      } else {\r\n        this.gl.uniform1f(this.sizeLoc, 1);\r\n        if (waveThick) {\r\n          instances = 4;\r\n        }\r\n      }\r\n\r\n      if (waveAdditive) {\r\n        this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE);\r\n      } else {\r\n        this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n      }\r\n\r\n      const drawMode = waveUseDots ? this.gl.POINTS : this.gl.LINE_STRIP;\r\n\r\n      // TODO: use drawArraysInstanced\r\n      for (let i = 0; i < instances; i++) {\r\n        const offset = 2;\r\n        if (i === 0) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [0, 0]);\r\n        } else if (i === 1) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [offset / this.texsizeX, 0]);\r\n        } else if (i === 2) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [0, offset / this.texsizeY]);\r\n        } else if (i === 3) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [\r\n            offset / this.texsizeX,\r\n            offset / this.texsizeY,\r\n          ]);\r\n        }\r\n\r\n        this.gl.drawArrays(drawMode, 0, numVerts);\r\n      }\r\n    }\r\n  }\r\n}\r\n","import Utils from \"../../utils\";\r\nimport ShaderUtils from \"../shaders/shaderUtils\";\r\n\r\nexport default class CustomShape {\r\n  constructor(index, gl, opts) {\r\n    this.index = index;\r\n    this.gl = gl;\r\n\r\n    const maxSides = 101;\r\n    this.positions = new Float32Array((maxSides + 2) * 3);\r\n    this.colors = new Float32Array((maxSides + 2) * 4);\r\n    this.uvs = new Float32Array((maxSides + 2) * 2);\r\n    this.borderPositions = new Float32Array((maxSides + 1) * 3);\r\n\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.positionVertexBuf = this.gl.createBuffer();\r\n    this.colorVertexBuf = this.gl.createBuffer();\r\n    this.uvVertexBuf = this.gl.createBuffer();\r\n    this.borderPositionVertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n    this.createBorderShader();\r\n\r\n    this.mainSampler = this.gl.createSampler();\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSampler,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    gl.samplerParameteri(this.mainSampler, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.samplerParameteri(this.mainSampler, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n    gl.samplerParameteri(this.mainSampler, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      in vec3 aPos;\r\n      in vec4 aColor;\r\n      in vec2 aUv;\r\n      out vec4 vColor;\r\n      out vec2 vUv;\r\n      void main(void) {\r\n        vColor = aColor;\r\n        vUv = aUv;\r\n        gl_Position = vec4(aPos, 1.0);\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      precision highp int;\r\n      precision mediump sampler2D;\r\n      uniform sampler2D uTexture;\r\n      uniform float uTextured;\r\n      in vec4 vColor;\r\n      in vec2 vUv;\r\n      out vec4 fragColor;\r\n      void main(void) {\r\n        if (uTextured != 0.0) {\r\n          fragColor = texture(uTexture, vUv) * vColor;\r\n        } else {\r\n          fragColor = vColor;\r\n        }\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.aPosLocation = this.gl.getAttribLocation(this.shaderProgram, \"aPos\");\r\n    this.aColorLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aColor\"\r\n    );\r\n    this.aUvLocation = this.gl.getAttribLocation(this.shaderProgram, \"aUv\");\r\n\r\n    this.texturedLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"uTextured\"\r\n    );\r\n    this.textureLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"uTexture\"\r\n    );\r\n  }\r\n\r\n  createBorderShader() {\r\n    this.borderShaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      in vec3 aBorderPos;\r\n      uniform vec2 thickOffset;\r\n      void main(void) {\r\n        gl_Position = vec4(aBorderPos +\r\n                            vec3(thickOffset, 0.0), 1.0);\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      precision highp int;\r\n      precision mediump sampler2D;\r\n      out vec4 fragColor;\r\n      uniform vec4 uBorderColor;\r\n      void main(void) {\r\n        fragColor = uBorderColor;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.borderShaderProgram, vertShader);\r\n    this.gl.attachShader(this.borderShaderProgram, fragShader);\r\n    this.gl.linkProgram(this.borderShaderProgram);\r\n\r\n    this.aBorderPosLoc = this.gl.getAttribLocation(\r\n      this.borderShaderProgram,\r\n      \"aBorderPos\"\r\n    );\r\n\r\n    this.uBorderColorLoc = this.gl.getUniformLocation(\r\n      this.borderShaderProgram,\r\n      \"uBorderColor\"\r\n    );\r\n    this.thickOffsetLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"thickOffset\"\r\n    );\r\n  }\r\n\r\n  drawCustomShape(\r\n    blendProgress,\r\n    globalVars,\r\n    presetEquationRunner,\r\n    shapeEqs,\r\n    prevTexture\r\n  ) {\r\n    if (shapeEqs.baseVals.enabled !== 0) {\r\n      if (!presetEquationRunner.preset.useWASM) {\r\n        this.setupShapeBuffers(presetEquationRunner.mdVSFrame.wrap);\r\n\r\n        let mdVSShape = Object.assign(\r\n          {},\r\n          presetEquationRunner.mdVSShapes[this.index],\r\n          presetEquationRunner.mdVSFrameMapShapes[this.index],\r\n          globalVars\r\n        );\r\n\r\n        // If we aren't setting these every instance, set them initially\r\n        if (\r\n          presetEquationRunner.preset.shapes[this.index].frame_eqs_str === \"\"\r\n        ) {\r\n          mdVSShape = Object.assign(\r\n            mdVSShape,\r\n            presetEquationRunner.mdVSQAfterFrame,\r\n            presetEquationRunner.mdVSTShapeInits[this.index]\r\n          );\r\n        }\r\n\r\n        const baseVals =\r\n          presetEquationRunner.preset.shapes[this.index].baseVals;\r\n\r\n        const numInst = Math.clamp(baseVals.num_inst, 1, 1024);\r\n        for (let j = 0; j < numInst; j++) {\r\n          mdVSShape.instance = j;\r\n          mdVSShape.x = baseVals.x;\r\n          mdVSShape.y = baseVals.y;\r\n          mdVSShape.rad = baseVals.rad;\r\n          mdVSShape.ang = baseVals.ang;\r\n          mdVSShape.r = baseVals.r;\r\n          mdVSShape.g = baseVals.g;\r\n          mdVSShape.b = baseVals.b;\r\n          mdVSShape.a = baseVals.a;\r\n          mdVSShape.r2 = baseVals.r2;\r\n          mdVSShape.g2 = baseVals.g2;\r\n          mdVSShape.b2 = baseVals.b2;\r\n          mdVSShape.a2 = baseVals.a2;\r\n          mdVSShape.border_r = baseVals.border_r;\r\n          mdVSShape.border_g = baseVals.border_g;\r\n          mdVSShape.border_b = baseVals.border_b;\r\n          mdVSShape.border_a = baseVals.border_a;\r\n          mdVSShape.thickoutline = baseVals.thickoutline;\r\n          mdVSShape.textured = baseVals.textured;\r\n          mdVSShape.tex_zoom = baseVals.tex_zoom;\r\n          mdVSShape.tex_ang = baseVals.tex_ang;\r\n          mdVSShape.additive = baseVals.additive;\r\n\r\n          let mdVSShapeFrame;\r\n          if (\r\n            presetEquationRunner.preset.shapes[this.index].frame_eqs_str !== \"\"\r\n          ) {\r\n            mdVSShape = Object.assign(\r\n              mdVSShape,\r\n              presetEquationRunner.mdVSQAfterFrame,\r\n              presetEquationRunner.mdVSTShapeInits[this.index]\r\n            );\r\n\r\n            mdVSShapeFrame = presetEquationRunner.runShapeFrameEquations(\r\n              this.index,\r\n              mdVSShape\r\n            );\r\n          } else {\r\n            mdVSShapeFrame = mdVSShape;\r\n          }\r\n\r\n          let sides = mdVSShapeFrame.sides;\r\n          sides = Math.clamp(sides, 3, 100);\r\n          sides = Math.floor(sides);\r\n\r\n          const rad = mdVSShapeFrame.rad;\r\n          const ang = mdVSShapeFrame.ang;\r\n\r\n          const x = mdVSShapeFrame.x * 2 - 1;\r\n          const y = mdVSShapeFrame.y * -2 + 1;\r\n\r\n          const r = mdVSShapeFrame.r;\r\n          const g = mdVSShapeFrame.g;\r\n          const b = mdVSShapeFrame.b;\r\n          const a = mdVSShapeFrame.a;\r\n          const r2 = mdVSShapeFrame.r2;\r\n          const g2 = mdVSShapeFrame.g2;\r\n          const b2 = mdVSShapeFrame.b2;\r\n          const a2 = mdVSShapeFrame.a2;\r\n\r\n          const borderR = mdVSShapeFrame.border_r;\r\n          const borderG = mdVSShapeFrame.border_g;\r\n          const borderB = mdVSShapeFrame.border_b;\r\n          const borderA = mdVSShapeFrame.border_a;\r\n          this.borderColor = [\r\n            borderR,\r\n            borderG,\r\n            borderB,\r\n            borderA * blendProgress,\r\n          ];\r\n\r\n          const thickoutline = mdVSShapeFrame.thickoutline;\r\n\r\n          const textured = mdVSShapeFrame.textured;\r\n          const texZoom = mdVSShapeFrame.tex_zoom;\r\n          const texAng = mdVSShapeFrame.tex_ang;\r\n\r\n          const additive = mdVSShapeFrame.additive;\r\n\r\n          const hasBorder = this.borderColor[3] > 0;\r\n          const isTextured = Math.abs(textured) >= 1;\r\n          const isBorderThick = Math.abs(thickoutline) >= 1;\r\n          const isAdditive = Math.abs(additive) >= 1;\r\n\r\n          this.positions[0] = x;\r\n          this.positions[1] = y;\r\n          this.positions[2] = 0;\r\n\r\n          this.colors[0] = r;\r\n          this.colors[1] = g;\r\n          this.colors[2] = b;\r\n          this.colors[3] = a * blendProgress;\r\n\r\n          if (isTextured) {\r\n            this.uvs[0] = 0.5;\r\n            this.uvs[1] = 0.5;\r\n          }\r\n\r\n          const quarterPi = Math.PI * 0.25;\r\n          for (let k = 1; k <= sides + 1; k++) {\r\n            const p = (k - 1) / sides;\r\n            const pTwoPi = p * 2 * Math.PI;\r\n\r\n            const angSum = pTwoPi + ang + quarterPi;\r\n            this.positions[k * 3 + 0] =\r\n              x + rad * Math.cos(angSum) * this.aspecty;\r\n            this.positions[k * 3 + 1] = y + rad * Math.sin(angSum);\r\n            this.positions[k * 3 + 2] = 0;\r\n\r\n            this.colors[k * 4 + 0] = r2;\r\n            this.colors[k * 4 + 1] = g2;\r\n            this.colors[k * 4 + 2] = b2;\r\n            this.colors[k * 4 + 3] = a2 * blendProgress;\r\n\r\n            if (isTextured) {\r\n              const texAngSum = pTwoPi + texAng + quarterPi;\r\n              this.uvs[k * 2 + 0] =\r\n                0.5 + ((0.5 * Math.cos(texAngSum)) / texZoom) * this.aspecty;\r\n              this.uvs[k * 2 + 1] = 0.5 + (0.5 * Math.sin(texAngSum)) / texZoom;\r\n            }\r\n\r\n            if (hasBorder) {\r\n              this.borderPositions[(k - 1) * 3 + 0] = this.positions[k * 3 + 0];\r\n              this.borderPositions[(k - 1) * 3 + 1] = this.positions[k * 3 + 1];\r\n              this.borderPositions[(k - 1) * 3 + 2] = this.positions[k * 3 + 2];\r\n            }\r\n          }\r\n\r\n          this.mdVSShapeFrame = mdVSShapeFrame;\r\n\r\n          this.drawCustomShapeInstance(\r\n            prevTexture,\r\n            sides,\r\n            isTextured,\r\n            hasBorder,\r\n            isBorderThick,\r\n            isAdditive\r\n          );\r\n        }\r\n\r\n        const mdVSUserKeysShape =\r\n          presetEquationRunner.mdVSUserKeysShapes[this.index];\r\n        const mdVSNewFrameMapShape = Utils.pick(\r\n          this.mdVSShapeFrame,\r\n          mdVSUserKeysShape\r\n        );\r\n\r\n        // eslint-disable-next-line no-param-reassign\r\n        presetEquationRunner.mdVSFrameMapShapes[\r\n          this.index\r\n        ] = mdVSNewFrameMapShape;\r\n      } else {\r\n        // eslint-disable-next-line max-len\r\n        this.setupShapeBuffers(\r\n          presetEquationRunner.preset.globalPools.perFrame.wrap.value\r\n        );\r\n\r\n        const baseVals =\r\n          presetEquationRunner.preset.shapes[this.index].baseVals;\r\n        const varPool =\r\n          presetEquationRunner.preset.globalPools[`shapePerFrame${this.index}`];\r\n        Utils.setWasm(varPool, globalVars, presetEquationRunner.globalKeys);\r\n\r\n        // If we aren't setting these every instance, set them initially\r\n        if (!presetEquationRunner.preset.shapes[this.index].frame_eqs) {\r\n          presetEquationRunner.preset.restore_qs();\r\n        }\r\n\r\n        Utils.setWasm(\r\n          varPool,\r\n          presetEquationRunner.mdVSTShapeInits[this.index],\r\n          presetEquationRunner.ts\r\n        );\r\n        presetEquationRunner.preset.save_ts();\r\n\r\n        varPool.x.value = baseVals.x;\r\n        varPool.y.value = baseVals.y;\r\n        varPool.rad.value = baseVals.rad;\r\n        varPool.ang.value = baseVals.ang;\r\n        varPool.r.value = baseVals.r;\r\n        varPool.g.value = baseVals.g;\r\n        varPool.b.value = baseVals.b;\r\n        varPool.a.value = baseVals.a;\r\n        varPool.r2.value = baseVals.r2;\r\n        varPool.g2.value = baseVals.g2;\r\n        varPool.b2.value = baseVals.b2;\r\n        varPool.a2.value = baseVals.a2;\r\n        varPool.border_r.value = baseVals.border_r;\r\n        varPool.border_g.value = baseVals.border_g;\r\n        varPool.border_b.value = baseVals.border_b;\r\n        varPool.border_a.value = baseVals.border_a;\r\n        varPool.thickoutline.value = baseVals.thickoutline;\r\n        varPool.textured.value = baseVals.textured;\r\n        varPool.tex_zoom.value = baseVals.tex_zoom;\r\n        varPool.tex_ang.value = baseVals.tex_ang;\r\n        varPool.additive.value = baseVals.additive;\r\n        presetEquationRunner.preset.shapes[this.index].frame_eqs_save();\r\n\r\n        const numInst = Math.clamp(baseVals.num_inst, 1, 1024);\r\n        for (let j = 0; j < numInst; j++) {\r\n          varPool.instance.value = j;\r\n\r\n          // this condition should check the JS equations because of comments\r\n          if (presetEquationRunner.preset.shapes[this.index].frame_eqs) {\r\n            presetEquationRunner.preset.shapes[this.index].frame_eqs_restore();\r\n            presetEquationRunner.preset.restore_qs();\r\n            presetEquationRunner.preset.restore_ts();\r\n            presetEquationRunner.preset.shapes[this.index].frame_eqs();\r\n          }\r\n\r\n          let sides = varPool.sides.value;\r\n          sides = Math.clamp(sides, 3, 100);\r\n          sides = Math.floor(sides);\r\n\r\n          const rad = varPool.rad.value;\r\n          const ang = varPool.ang.value;\r\n\r\n          const x = varPool.x.value * 2 - 1;\r\n          const y = varPool.y.value * -2 + 1;\r\n\r\n          const r = varPool.r.value;\r\n          const g = varPool.g.value;\r\n          const b = varPool.b.value;\r\n          const a = varPool.a.value;\r\n          const r2 = varPool.r2.value;\r\n          const g2 = varPool.g2.value;\r\n          const b2 = varPool.b2.value;\r\n          const a2 = varPool.a2.value;\r\n\r\n          const borderR = varPool.border_r.value;\r\n          const borderG = varPool.border_g.value;\r\n          const borderB = varPool.border_b.value;\r\n          const borderA = varPool.border_a.value;\r\n          this.borderColor = [\r\n            borderR,\r\n            borderG,\r\n            borderB,\r\n            borderA * blendProgress,\r\n          ];\r\n\r\n          const thickoutline = varPool.thickoutline.value;\r\n\r\n          const textured = varPool.textured.value;\r\n          const texZoom = varPool.tex_zoom.value;\r\n          const texAng = varPool.tex_ang.value;\r\n\r\n          const additive = varPool.additive.value;\r\n\r\n          const hasBorder = this.borderColor[3] > 0;\r\n          const isTextured = Math.abs(textured) >= 1;\r\n          const isBorderThick = Math.abs(thickoutline) >= 1;\r\n          const isAdditive = Math.abs(additive) >= 1;\r\n\r\n          this.positions[0] = x;\r\n          this.positions[1] = y;\r\n          this.positions[2] = 0;\r\n\r\n          this.colors[0] = r;\r\n          this.colors[1] = g;\r\n          this.colors[2] = b;\r\n          this.colors[3] = a * blendProgress;\r\n\r\n          if (isTextured) {\r\n            this.uvs[0] = 0.5;\r\n            this.uvs[1] = 0.5;\r\n          }\r\n\r\n          const quarterPi = Math.PI * 0.25;\r\n          for (let k = 1; k <= sides + 1; k++) {\r\n            const p = (k - 1) / sides;\r\n            const pTwoPi = p * 2 * Math.PI;\r\n\r\n            const angSum = pTwoPi + ang + quarterPi;\r\n            this.positions[k * 3 + 0] =\r\n              x + rad * Math.cos(angSum) * this.aspecty;\r\n            this.positions[k * 3 + 1] = y + rad * Math.sin(angSum);\r\n            this.positions[k * 3 + 2] = 0;\r\n\r\n            this.colors[k * 4 + 0] = r2;\r\n            this.colors[k * 4 + 1] = g2;\r\n            this.colors[k * 4 + 2] = b2;\r\n            this.colors[k * 4 + 3] = a2 * blendProgress;\r\n\r\n            if (isTextured) {\r\n              const texAngSum = pTwoPi + texAng + quarterPi;\r\n              this.uvs[k * 2 + 0] =\r\n                0.5 + ((0.5 * Math.cos(texAngSum)) / texZoom) * this.aspecty;\r\n              this.uvs[k * 2 + 1] = 0.5 + (0.5 * Math.sin(texAngSum)) / texZoom;\r\n            }\r\n\r\n            if (hasBorder) {\r\n              this.borderPositions[(k - 1) * 3 + 0] = this.positions[k * 3 + 0];\r\n              this.borderPositions[(k - 1) * 3 + 1] = this.positions[k * 3 + 1];\r\n              this.borderPositions[(k - 1) * 3 + 2] = this.positions[k * 3 + 2];\r\n            }\r\n          }\r\n\r\n          this.drawCustomShapeInstance(\r\n            prevTexture,\r\n            sides,\r\n            isTextured,\r\n            hasBorder,\r\n            isBorderThick,\r\n            isAdditive\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setupShapeBuffers(wrap) {\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionVertexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ARRAY_BUFFER,\r\n      this.positions,\r\n      this.gl.DYNAMIC_DRAW\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.aPosLocation,\r\n      3,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.aPosLocation);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.colorVertexBuf);\r\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.colors, this.gl.DYNAMIC_DRAW);\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.aColorLocation,\r\n      4,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.aColorLocation);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.uvVertexBuf);\r\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.uvs, this.gl.DYNAMIC_DRAW);\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.aUvLocation,\r\n      2,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.aUvLocation);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.borderPositionVertexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ARRAY_BUFFER,\r\n      this.borderPositions,\r\n      this.gl.DYNAMIC_DRAW\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.aBorderPosLoc,\r\n      3,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.aBorderPosLoc);\r\n\r\n    const wrapping = wrap !== 0 ? this.gl.REPEAT : this.gl.CLAMP_TO_EDGE;\r\n    this.gl.samplerParameteri(\r\n      this.mainSampler,\r\n      this.gl.TEXTURE_WRAP_S,\r\n      wrapping\r\n    );\r\n    this.gl.samplerParameteri(\r\n      this.mainSampler,\r\n      this.gl.TEXTURE_WRAP_T,\r\n      wrapping\r\n    );\r\n  }\r\n\r\n  drawCustomShapeInstance(\r\n    prevTexture,\r\n    sides,\r\n    isTextured,\r\n    hasBorder,\r\n    isBorderThick,\r\n    isAdditive\r\n  ) {\r\n    this.gl.useProgram(this.shaderProgram);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionVertexBuf);\r\n    this.gl.bufferSubData(\r\n      this.gl.ARRAY_BUFFER,\r\n      0,\r\n      this.positions,\r\n      0,\r\n      (sides + 2) * 3\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.aPosLocation,\r\n      3,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.aPosLocation);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.colorVertexBuf);\r\n    this.gl.bufferSubData(\r\n      this.gl.ARRAY_BUFFER,\r\n      0,\r\n      this.colors,\r\n      0,\r\n      (sides + 2) * 4\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.aColorLocation,\r\n      4,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.aColorLocation);\r\n\r\n    if (isTextured) {\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.uvVertexBuf);\r\n      this.gl.bufferSubData(\r\n        this.gl.ARRAY_BUFFER,\r\n        0,\r\n        this.uvs,\r\n        0,\r\n        (sides + 2) * 2\r\n      );\r\n\r\n      this.gl.vertexAttribPointer(\r\n        this.aUvLocation,\r\n        2,\r\n        this.gl.FLOAT,\r\n        false,\r\n        0,\r\n        0\r\n      );\r\n      this.gl.enableVertexAttribArray(this.aUvLocation);\r\n    }\r\n\r\n    this.gl.uniform1f(this.texturedLoc, isTextured ? 1 : 0);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE0);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, prevTexture);\r\n    this.gl.bindSampler(0, this.mainSampler);\r\n    this.gl.uniform1i(this.textureLoc, 0);\r\n\r\n    if (isAdditive) {\r\n      this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE);\r\n    } else {\r\n      this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n    }\r\n\r\n    this.gl.drawArrays(this.gl.TRIANGLE_FAN, 0, sides + 2);\r\n\r\n    if (hasBorder) {\r\n      this.gl.useProgram(this.borderShaderProgram);\r\n\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.borderPositionVertexBuf);\r\n      this.gl.bufferSubData(\r\n        this.gl.ARRAY_BUFFER,\r\n        0,\r\n        this.borderPositions,\r\n        0,\r\n        (sides + 1) * 3\r\n      );\r\n\r\n      this.gl.vertexAttribPointer(\r\n        this.aBorderPosLoc,\r\n        3,\r\n        this.gl.FLOAT,\r\n        false,\r\n        0,\r\n        0\r\n      );\r\n      this.gl.enableVertexAttribArray(this.aBorderPosLoc);\r\n\r\n      this.gl.uniform4fv(this.uBorderColorLoc, this.borderColor);\r\n\r\n      // TODO: use drawArraysInstanced\r\n      const instances = isBorderThick ? 4 : 1;\r\n      for (let i = 0; i < instances; i++) {\r\n        const offset = 2;\r\n        if (i === 0) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [0, 0]);\r\n        } else if (i === 1) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [offset / this.texsizeX, 0]);\r\n        } else if (i === 2) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [0, offset / this.texsizeY]);\r\n        } else if (i === 3) {\r\n          this.gl.uniform2fv(this.thickOffsetLoc, [\r\n            offset / this.texsizeX,\r\n            offset / this.texsizeY,\r\n          ]);\r\n        }\r\n\r\n        this.gl.drawArrays(this.gl.LINE_STRIP, 0, sides + 1);\r\n      }\r\n    }\r\n  }\r\n}\r\n","import ShaderUtils from \"../shaders/shaderUtils\";\r\n\r\nexport default class Border {\r\n  constructor(gl, opts = {}) {\r\n    this.gl = gl;\r\n\r\n    this.positions = new Float32Array(72);\r\n\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n\r\n    this.vertexBuf = this.gl.createBuffer();\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      in vec3 aPos;\r\n      void main(void) {\r\n        gl_Position = vec4(aPos, 1.0);\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      precision highp int;\r\n      precision mediump sampler2D;\r\n      out vec4 fragColor;\r\n      uniform vec4 u_color;\r\n      void main(void) {\r\n        fragColor = u_color;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.aPosLoc = this.gl.getAttribLocation(this.shaderProgram, \"aPos\");\r\n\r\n    this.colorLoc = this.gl.getUniformLocation(this.shaderProgram, \"u_color\");\r\n  }\r\n\r\n  addTriangle(offset, point1, point2, point3) {\r\n    this.positions[offset + 0] = point1[0];\r\n    this.positions[offset + 1] = point1[1];\r\n    this.positions[offset + 2] = point1[2];\r\n\r\n    this.positions[offset + 3] = point2[0];\r\n    this.positions[offset + 4] = point2[1];\r\n    this.positions[offset + 5] = point2[2];\r\n\r\n    this.positions[offset + 6] = point3[0];\r\n    this.positions[offset + 7] = point3[1];\r\n    this.positions[offset + 8] = point3[2];\r\n  }\r\n\r\n  // based on https://github.com/mrdoob/three.js/blob/master/src/geometries/PlaneGeometry.js\r\n  generateBorder(borderColor, borderSize, prevBorderSize) {\r\n    if (borderSize > 0 && borderColor[3] > 0) {\r\n      const width = 2;\r\n      const height = 2;\r\n\r\n      const widthHalf = width / 2;\r\n      const heightHalf = height / 2;\r\n\r\n      const prevBorderWidth = prevBorderSize / 2;\r\n      const borderWidth = borderSize / 2 + prevBorderWidth;\r\n\r\n      const prevBorderWidthWidth = prevBorderWidth * width;\r\n      const prevBorderWidthHeight = prevBorderWidth * height;\r\n      const borderWidthWidth = borderWidth * width;\r\n      const borderWidthHeight = borderWidth * height;\r\n\r\n      // 1st side\r\n      let point1 = [\r\n        -widthHalf + prevBorderWidthWidth,\r\n        -heightHalf + borderWidthHeight,\r\n        0,\r\n      ];\r\n      let point2 = [\r\n        -widthHalf + prevBorderWidthWidth,\r\n        heightHalf - borderWidthHeight,\r\n        0,\r\n      ];\r\n      let point3 = [\r\n        -widthHalf + borderWidthWidth,\r\n        heightHalf - borderWidthHeight,\r\n        0,\r\n      ];\r\n      let point4 = [\r\n        -widthHalf + borderWidthWidth,\r\n        -heightHalf + borderWidthHeight,\r\n        0,\r\n      ];\r\n\r\n      this.addTriangle(0, point4, point2, point1);\r\n      this.addTriangle(9, point4, point3, point2);\r\n\r\n      // 2nd side\r\n      point1 = [\r\n        widthHalf - prevBorderWidthWidth,\r\n        -heightHalf + borderWidthHeight,\r\n        0,\r\n      ];\r\n      point2 = [\r\n        widthHalf - prevBorderWidthWidth,\r\n        heightHalf - borderWidthHeight,\r\n        0,\r\n      ];\r\n      point3 = [\r\n        widthHalf - borderWidthWidth,\r\n        heightHalf - borderWidthHeight,\r\n        0,\r\n      ];\r\n      point4 = [\r\n        widthHalf - borderWidthWidth,\r\n        -heightHalf + borderWidthHeight,\r\n        0,\r\n      ];\r\n\r\n      this.addTriangle(18, point1, point2, point4);\r\n      this.addTriangle(27, point2, point3, point4);\r\n\r\n      // Top\r\n      point1 = [\r\n        -widthHalf + prevBorderWidthWidth,\r\n        -heightHalf + prevBorderWidthHeight,\r\n        0,\r\n      ];\r\n      point2 = [\r\n        -widthHalf + prevBorderWidthWidth,\r\n        borderWidthHeight - heightHalf,\r\n        0,\r\n      ];\r\n      point3 = [\r\n        widthHalf - prevBorderWidthWidth,\r\n        borderWidthHeight - heightHalf,\r\n        0,\r\n      ];\r\n      point4 = [\r\n        widthHalf - prevBorderWidthWidth,\r\n        -heightHalf + prevBorderWidthHeight,\r\n        0,\r\n      ];\r\n\r\n      this.addTriangle(36, point4, point2, point1);\r\n      this.addTriangle(45, point4, point3, point2);\r\n\r\n      // Bottom\r\n      point1 = [\r\n        -widthHalf + prevBorderWidthWidth,\r\n        heightHalf - prevBorderWidthHeight,\r\n        0,\r\n      ];\r\n      point2 = [\r\n        -widthHalf + prevBorderWidthWidth,\r\n        heightHalf - borderWidthHeight,\r\n        0,\r\n      ];\r\n      point3 = [\r\n        widthHalf - prevBorderWidthWidth,\r\n        heightHalf - borderWidthHeight,\r\n        0,\r\n      ];\r\n      point4 = [\r\n        widthHalf - prevBorderWidthWidth,\r\n        heightHalf - prevBorderWidthHeight,\r\n        0,\r\n      ];\r\n\r\n      this.addTriangle(54, point1, point2, point4);\r\n      this.addTriangle(63, point2, point3, point4);\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  drawBorder(borderColor, borderSize, prevBorderSize) {\r\n    if (this.generateBorder(borderColor, borderSize, prevBorderSize)) {\r\n      this.gl.useProgram(this.shaderProgram);\r\n\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuf);\r\n      this.gl.bufferData(\r\n        this.gl.ARRAY_BUFFER,\r\n        this.positions,\r\n        this.gl.STATIC_DRAW\r\n      );\r\n\r\n      this.gl.vertexAttribPointer(this.aPosLoc, 3, this.gl.FLOAT, false, 0, 0);\r\n      this.gl.enableVertexAttribArray(this.aPosLoc);\r\n\r\n      this.gl.uniform4fv(this.colorLoc, borderColor);\r\n\r\n      this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n      this.gl.drawArrays(this.gl.TRIANGLES, 0, this.positions.length / 3);\r\n    }\r\n  }\r\n}\r\n","import ShaderUtils from \"../shaders/shaderUtils\";\r\n\r\nexport default class CustomShape {\r\n  constructor(gl, opts) {\r\n    this.gl = gl;\r\n\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.generatePositions();\r\n\r\n    this.colors = new Float32Array([\r\n      0,\r\n      0,\r\n      0,\r\n      3 / 32,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n      0,\r\n    ]);\r\n\r\n    this.positionVertexBuf = this.gl.createBuffer();\r\n    this.colorVertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.generatePositions();\r\n  }\r\n\r\n  generatePositions() {\r\n    const halfSize = 0.05;\r\n    this.positions = new Float32Array([\r\n      0,\r\n      0,\r\n      0,\r\n      -halfSize * this.aspecty,\r\n      0,\r\n      0,\r\n      0,\r\n      -halfSize,\r\n      0,\r\n      halfSize * this.aspecty,\r\n      0,\r\n      0,\r\n      0,\r\n      halfSize,\r\n      0,\r\n      -halfSize * this.aspecty,\r\n      0,\r\n      0,\r\n    ]);\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      in vec3 aPos;\r\n      in vec4 aColor;\r\n      out vec4 vColor;\r\n      void main(void) {\r\n        vColor = aColor;\r\n        gl_Position = vec4(aPos, 1.0);\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      precision highp int;\r\n      precision mediump sampler2D;\r\n      in vec4 vColor;\r\n      out vec4 fragColor;\r\n      void main(void) {\r\n        fragColor = vColor;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.aPosLocation = this.gl.getAttribLocation(this.shaderProgram, \"aPos\");\r\n    this.aColorLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aColor\"\r\n    );\r\n  }\r\n\r\n  drawDarkenCenter(mdVSFrame) {\r\n    if (mdVSFrame.darken_center !== 0) {\r\n      this.gl.useProgram(this.shaderProgram);\r\n\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionVertexBuf);\r\n      this.gl.bufferData(\r\n        this.gl.ARRAY_BUFFER,\r\n        this.positions,\r\n        this.gl.STATIC_DRAW\r\n      );\r\n\r\n      this.gl.vertexAttribPointer(\r\n        this.aPosLocation,\r\n        3,\r\n        this.gl.FLOAT,\r\n        false,\r\n        0,\r\n        0\r\n      );\r\n      this.gl.enableVertexAttribArray(this.aPosLocation);\r\n\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.colorVertexBuf);\r\n      this.gl.bufferData(\r\n        this.gl.ARRAY_BUFFER,\r\n        this.colors,\r\n        this.gl.STATIC_DRAW\r\n      );\r\n\r\n      this.gl.vertexAttribPointer(\r\n        this.aColorLocation,\r\n        4,\r\n        this.gl.FLOAT,\r\n        false,\r\n        0,\r\n        0\r\n      );\r\n      this.gl.enableVertexAttribArray(this.aColorLocation);\r\n\r\n      this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n      this.gl.drawArrays(this.gl.TRIANGLE_FAN, 0, this.positions.length / 3);\r\n    }\r\n  }\r\n}\r\n","import ShaderUtils from \"../shaders/shaderUtils\";\r\n\r\nexport default class MotionVectors {\r\n  constructor(gl, opts) {\r\n    this.gl = gl;\r\n\r\n    this.maxX = 64;\r\n    this.maxY = 48;\r\n    this.positions = new Float32Array(this.maxX * this.maxY * 2 * 3);\r\n\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n\r\n    this.positionVertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      in vec3 aPos;\r\n      void main(void) {\r\n        gl_Position = vec4(aPos, 1.0);\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      precision highp int;\r\n      precision mediump sampler2D;\r\n      out vec4 fragColor;\r\n      uniform vec4 u_color;\r\n      void main(void) {\r\n        fragColor = u_color;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.aPosLoc = this.gl.getAttribLocation(this.shaderProgram, \"aPos\");\r\n\r\n    this.colorLoc = this.gl.getUniformLocation(this.shaderProgram, \"u_color\");\r\n  }\r\n\r\n  getMotionDir(warpUVs, fx, fy) {\r\n    const y0 = Math.floor(fy * this.mesh_height);\r\n    const dy = fy * this.mesh_height - y0;\r\n\r\n    const x0 = Math.floor(fx * this.mesh_width);\r\n    const dx = fx * this.mesh_width - x0;\r\n\r\n    const x1 = x0 + 1;\r\n    const y1 = y0 + 1;\r\n\r\n    const gridX1 = this.mesh_width + 1;\r\n\r\n    let fx2;\r\n    let fy2;\r\n    fx2 = warpUVs[(y0 * gridX1 + x0) * 2 + 0] * (1 - dx) * (1 - dy);\r\n    fy2 = warpUVs[(y0 * gridX1 + x0) * 2 + 1] * (1 - dx) * (1 - dy);\r\n    fx2 += warpUVs[(y0 * gridX1 + x1) * 2 + 0] * dx * (1 - dy);\r\n    fy2 += warpUVs[(y0 * gridX1 + x1) * 2 + 1] * dx * (1 - dy);\r\n    fx2 += warpUVs[(y1 * gridX1 + x0) * 2 + 0] * (1 - dx) * dy;\r\n    fy2 += warpUVs[(y1 * gridX1 + x0) * 2 + 1] * (1 - dx) * dy;\r\n    fx2 += warpUVs[(y1 * gridX1 + x1) * 2 + 0] * dx * dy;\r\n    fy2 += warpUVs[(y1 * gridX1 + x1) * 2 + 1] * dx * dy;\r\n\r\n    return [fx2, 1.0 - fy2];\r\n  }\r\n\r\n  generateMotionVectors(mdVSFrame, warpUVs) {\r\n    const mvOn = mdVSFrame.bmotionvectorson;\r\n    const mvA = mvOn === 0 ? 0 : mdVSFrame.mv_a;\r\n    let nX = Math.floor(mdVSFrame.mv_x);\r\n    let nY = Math.floor(mdVSFrame.mv_y);\r\n\r\n    if (mvA > 0.001 && nX > 0 && nY > 0) {\r\n      let dx = mdVSFrame.mv_x - nX;\r\n      let dy = mdVSFrame.mv_y - nY;\r\n\r\n      if (nX > this.maxX) {\r\n        nX = this.maxX;\r\n        dx = 0;\r\n      }\r\n\r\n      if (nY > this.maxY) {\r\n        nY = this.maxY;\r\n        dy = 0;\r\n      }\r\n\r\n      const dx2 = mdVSFrame.mv_dx;\r\n      const dy2 = mdVSFrame.mv_dy;\r\n\r\n      const lenMult = mdVSFrame.mv_l;\r\n      const minLen = 1.0 / this.texsizeX;\r\n\r\n      this.numVecVerts = 0;\r\n      for (let j = 0; j < nY; j++) {\r\n        let fy = (j + 0.25) / (nY + dy + 0.25 - 1.0);\r\n        fy -= dy2;\r\n\r\n        if (fy > 0.0001 && fy < 0.9999) {\r\n          for (let i = 0; i < nX; i++) {\r\n            let fx = (i + 0.25) / (nX + dx + 0.25 - 1.0);\r\n            fx += dx2;\r\n\r\n            if (fx > 0.0001 && fx < 0.9999) {\r\n              const fx2arr = this.getMotionDir(warpUVs, fx, fy);\r\n              let fx2 = fx2arr[0];\r\n              let fy2 = fx2arr[1];\r\n\r\n              let dxi = fx2 - fx;\r\n              let dyi = fy2 - fy;\r\n              dxi *= lenMult;\r\n              dyi *= lenMult;\r\n\r\n              let fdist = Math.sqrt(dxi * dxi + dyi * dyi);\r\n\r\n              if (fdist < minLen && fdist > 0.00000001) {\r\n                fdist = minLen / fdist;\r\n                dxi *= fdist;\r\n                dyi *= fdist;\r\n              } else {\r\n                dxi = minLen;\r\n                dxi = minLen;\r\n              }\r\n\r\n              fx2 = fx + dxi;\r\n              fy2 = fy + dyi;\r\n\r\n              const vx1 = 2.0 * fx - 1.0;\r\n              const vy1 = 2.0 * fy - 1.0;\r\n              const vx2 = 2.0 * fx2 - 1.0;\r\n              const vy2 = 2.0 * fy2 - 1.0;\r\n\r\n              this.positions[this.numVecVerts * 3 + 0] = vx1;\r\n              this.positions[this.numVecVerts * 3 + 1] = vy1;\r\n              this.positions[this.numVecVerts * 3 + 2] = 0;\r\n\r\n              this.positions[(this.numVecVerts + 1) * 3 + 0] = vx2;\r\n              this.positions[(this.numVecVerts + 1) * 3 + 1] = vy2;\r\n              this.positions[(this.numVecVerts + 1) * 3 + 2] = 0;\r\n\r\n              this.numVecVerts += 2;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      if (this.numVecVerts > 0) {\r\n        this.color = [mdVSFrame.mv_r, mdVSFrame.mv_g, mdVSFrame.mv_b, mvA];\r\n\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  drawMotionVectors(mdVSFrame, warpUVs) {\r\n    if (this.generateMotionVectors(mdVSFrame, warpUVs)) {\r\n      this.gl.useProgram(this.shaderProgram);\r\n\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionVertexBuf);\r\n      this.gl.bufferData(\r\n        this.gl.ARRAY_BUFFER,\r\n        this.positions,\r\n        this.gl.STATIC_DRAW\r\n      );\r\n\r\n      this.gl.vertexAttribPointer(this.aPosLoc, 3, this.gl.FLOAT, false, 0, 0);\r\n      this.gl.enableVertexAttribArray(this.aPosLoc);\r\n\r\n      this.gl.uniform4fv(this.colorLoc, this.color);\r\n\r\n      this.gl.lineWidth(1);\r\n      this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n      this.gl.drawArrays(this.gl.LINES, 0, this.numVecVerts);\r\n    }\r\n  }\r\n}\r\n","import ShaderUtils from \"./shaderUtils\";\r\nimport { getRNG } from \"../../utils/rngContext\";\r\n\r\nexport default class WarpShader {\r\n  constructor(gl, noise, image, opts = {}) {\r\n    this.gl = gl;\r\n    this.noise = noise;\r\n    this.image = image;\r\n    this.rng = getRNG();\r\n\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.buildPositions();\r\n\r\n    this.indexBuf = gl.createBuffer();\r\n    this.positionVertexBuf = this.gl.createBuffer();\r\n    this.warpUvVertexBuf = this.gl.createBuffer();\r\n    this.warpColorVertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n\r\n    this.mainSampler = this.gl.createSampler();\r\n    this.mainSamplerFW = this.gl.createSampler();\r\n    this.mainSamplerFC = this.gl.createSampler();\r\n    this.mainSamplerPW = this.gl.createSampler();\r\n    this.mainSamplerPC = this.gl.createSampler();\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSampler,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    gl.samplerParameteri(this.mainSampler, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.samplerParameteri(this.mainSampler, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n    gl.samplerParameteri(this.mainSampler, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSamplerFW,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    gl.samplerParameteri(this.mainSamplerFW, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.samplerParameteri(this.mainSamplerFW, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n    gl.samplerParameteri(this.mainSamplerFW, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSamplerFC,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    gl.samplerParameteri(this.mainSamplerFC, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.samplerParameteri(\r\n      this.mainSamplerFC,\r\n      gl.TEXTURE_WRAP_S,\r\n      gl.CLAMP_TO_EDGE\r\n    );\r\n    gl.samplerParameteri(\r\n      this.mainSamplerFC,\r\n      gl.TEXTURE_WRAP_T,\r\n      gl.CLAMP_TO_EDGE\r\n    );\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSamplerPW,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.NEAREST_MIPMAP_NEAREST\r\n    );\r\n    gl.samplerParameteri(this.mainSamplerPW, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.samplerParameteri(this.mainSamplerPW, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n    gl.samplerParameteri(this.mainSamplerPW, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSamplerPC,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.NEAREST_MIPMAP_NEAREST\r\n    );\r\n    gl.samplerParameteri(this.mainSamplerPC, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.samplerParameteri(\r\n      this.mainSamplerPC,\r\n      gl.TEXTURE_WRAP_S,\r\n      gl.CLAMP_TO_EDGE\r\n    );\r\n    gl.samplerParameteri(\r\n      this.mainSamplerPC,\r\n      gl.TEXTURE_WRAP_T,\r\n      gl.CLAMP_TO_EDGE\r\n    );\r\n  }\r\n\r\n  // based on https://github.com/mrdoob/three.js/blob/master/src/geometries/PlaneGeometry.js\r\n  buildPositions() {\r\n    const width = 2;\r\n    const height = 2;\r\n\r\n    const widthHalf = width / 2;\r\n    const heightHalf = height / 2;\r\n\r\n    const gridX = this.mesh_width;\r\n    const gridY = this.mesh_height;\r\n\r\n    const gridX1 = gridX + 1;\r\n    const gridY1 = gridY + 1;\r\n\r\n    const segmentWidth = width / gridX;\r\n    const segmentHeight = height / gridY;\r\n\r\n    const vertices = [];\r\n    for (let iy = 0; iy < gridY1; iy++) {\r\n      const y = iy * segmentHeight - heightHalf;\r\n      for (let ix = 0; ix < gridX1; ix++) {\r\n        const x = ix * segmentWidth - widthHalf;\r\n        vertices.push(x, -y, 0);\r\n      }\r\n    }\r\n\r\n    const indices = [];\r\n    for (let iy = 0; iy < gridY; iy++) {\r\n      for (let ix = 0; ix < gridX; ix++) {\r\n        const a = ix + gridX1 * iy;\r\n        const b = ix + gridX1 * (iy + 1);\r\n        const c = ix + 1 + gridX1 * (iy + 1);\r\n        const d = ix + 1 + gridX1 * iy;\r\n\r\n        indices.push(a, b, d);\r\n        indices.push(b, c, d);\r\n      }\r\n    }\r\n\r\n    this.vertices = new Float32Array(vertices);\r\n    this.indices = new Uint16Array(indices);\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.buildPositions();\r\n  }\r\n\r\n  createShader(shaderText = \"\") {\r\n    let fragShaderText;\r\n    let fragShaderHeaderText;\r\n    if (shaderText.length === 0) {\r\n      fragShaderText = \"ret = texture(sampler_main, uv).rgb * decay;\";\r\n      fragShaderHeaderText = \"\";\r\n    } else {\r\n      const shaderParts = ShaderUtils.getShaderParts(shaderText);\r\n      fragShaderHeaderText = shaderParts[0];\r\n      fragShaderText = shaderParts[1];\r\n    }\r\n\r\n    fragShaderText = fragShaderText.replace(/texture2D/g, \"texture\");\r\n    fragShaderText = fragShaderText.replace(/texture3D/g, \"texture\");\r\n\r\n    this.userTextures = ShaderUtils.getUserSamplers(fragShaderHeaderText);\r\n\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      const vec2 halfmad = vec2(0.5);\r\n      in vec2 aPos;\r\n      in vec2 aWarpUv;\r\n      in vec4 aWarpColor;\r\n      out vec2 uv;\r\n      out vec2 uv_orig;\r\n      out vec4 vColor;\r\n      void main(void) {\r\n        gl_Position = vec4(aPos, 0.0, 1.0);\r\n        uv_orig = aPos * halfmad + halfmad;\r\n        uv = aWarpUv;\r\n        vColor = aWarpColor;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      precision highp int;\r\n      precision mediump sampler2D;\r\n      precision mediump sampler3D;\r\n\r\n      in vec2 uv;\r\n      in vec2 uv_orig;\r\n      in vec4 vColor;\r\n      out vec4 fragColor;\r\n      uniform sampler2D sampler_main;\r\n      uniform sampler2D sampler_fw_main;\r\n      uniform sampler2D sampler_fc_main;\r\n      uniform sampler2D sampler_pw_main;\r\n      uniform sampler2D sampler_pc_main;\r\n      uniform sampler2D sampler_blur1;\r\n      uniform sampler2D sampler_blur2;\r\n      uniform sampler2D sampler_blur3;\r\n      uniform sampler2D sampler_noise_lq;\r\n      uniform sampler2D sampler_noise_lq_lite;\r\n      uniform sampler2D sampler_noise_mq;\r\n      uniform sampler2D sampler_noise_hq;\r\n      uniform sampler2D sampler_pw_noise_lq;\r\n      uniform sampler3D sampler_noisevol_lq;\r\n      uniform sampler3D sampler_noisevol_hq;\r\n      uniform float time;\r\n      uniform float decay;\r\n      uniform vec2 resolution;\r\n      uniform vec4 aspect;\r\n      uniform vec4 texsize;\r\n      uniform vec4 texsize_noise_lq;\r\n      uniform vec4 texsize_noise_mq;\r\n      uniform vec4 texsize_noise_hq;\r\n      uniform vec4 texsize_noise_lq_lite;\r\n      uniform vec4 texsize_noisevol_lq;\r\n      uniform vec4 texsize_noisevol_hq;\r\n\r\n      uniform float bass;\r\n      uniform float mid;\r\n      uniform float treb;\r\n      uniform float vol;\r\n      uniform float bass_att;\r\n      uniform float mid_att;\r\n      uniform float treb_att;\r\n      uniform float vol_att;\r\n\r\n      uniform float frame;\r\n      uniform float fps;\r\n\r\n      uniform vec4 _qa;\r\n      uniform vec4 _qb;\r\n      uniform vec4 _qc;\r\n      uniform vec4 _qd;\r\n      uniform vec4 _qe;\r\n      uniform vec4 _qf;\r\n      uniform vec4 _qg;\r\n      uniform vec4 _qh;\r\n\r\n      #define q1 _qa.x\r\n      #define q2 _qa.y\r\n      #define q3 _qa.z\r\n      #define q4 _qa.w\r\n      #define q5 _qb.x\r\n      #define q6 _qb.y\r\n      #define q7 _qb.z\r\n      #define q8 _qb.w\r\n      #define q9 _qc.x\r\n      #define q10 _qc.y\r\n      #define q11 _qc.z\r\n      #define q12 _qc.w\r\n      #define q13 _qd.x\r\n      #define q14 _qd.y\r\n      #define q15 _qd.z\r\n      #define q16 _qd.w\r\n      #define q17 _qe.x\r\n      #define q18 _qe.y\r\n      #define q19 _qe.z\r\n      #define q20 _qe.w\r\n      #define q21 _qf.x\r\n      #define q22 _qf.y\r\n      #define q23 _qf.z\r\n      #define q24 _qf.w\r\n      #define q25 _qg.x\r\n      #define q26 _qg.y\r\n      #define q27 _qg.z\r\n      #define q28 _qg.w\r\n      #define q29 _qh.x\r\n      #define q30 _qh.y\r\n      #define q31 _qh.z\r\n      #define q32 _qh.w\r\n\r\n      uniform vec4 slow_roam_cos;\r\n      uniform vec4 roam_cos;\r\n      uniform vec4 slow_roam_sin;\r\n      uniform vec4 roam_sin;\r\n\r\n      uniform float blur1_min;\r\n      uniform float blur1_max;\r\n      uniform float blur2_min;\r\n      uniform float blur2_max;\r\n      uniform float blur3_min;\r\n      uniform float blur3_max;\r\n\r\n      uniform float scale1;\r\n      uniform float scale2;\r\n      uniform float scale3;\r\n      uniform float bias1;\r\n      uniform float bias2;\r\n      uniform float bias3;\r\n\r\n      uniform vec4 rand_frame;\r\n      uniform vec4 rand_preset;\r\n\r\n      float PI = ${Math.PI};\r\n\r\n      ${fragShaderHeaderText}\r\n\r\n      void main(void) {\r\n        vec3 ret;\r\n        float rad = length(uv_orig - 0.5);\r\n        float ang = atan(uv_orig.x - 0.5, uv_orig.y - 0.5);\r\n\r\n        ${fragShaderText}\r\n\r\n        fragColor = vec4(ret, 1.0) * vColor;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.positionLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aPos\"\r\n    );\r\n    this.warpUvLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aWarpUv\"\r\n    );\r\n    this.warpColorLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aWarpColor\"\r\n    );\r\n    this.textureLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_main\"\r\n    );\r\n    this.textureFWLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_fw_main\"\r\n    );\r\n    this.textureFCLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_fc_main\"\r\n    );\r\n    this.texturePWLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_pw_main\"\r\n    );\r\n    this.texturePCLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_pc_main\"\r\n    );\r\n    this.blurTexture1Loc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_blur1\"\r\n    );\r\n    this.blurTexture2Loc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_blur2\"\r\n    );\r\n    this.blurTexture3Loc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_blur3\"\r\n    );\r\n    this.noiseLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noise_lq\"\r\n    );\r\n    this.noiseMQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noise_mq\"\r\n    );\r\n    this.noiseHQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noise_hq\"\r\n    );\r\n    this.noiseLQLiteLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noise_lq_lite\"\r\n    );\r\n    this.noisePointLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_pw_noise_lq\"\r\n    );\r\n    this.noiseVolLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noisevol_lq\"\r\n    );\r\n    this.noiseVolHQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noisevol_hq\"\r\n    );\r\n    this.decayLoc = this.gl.getUniformLocation(this.shaderProgram, \"decay\");\r\n    this.texsizeLoc = this.gl.getUniformLocation(this.shaderProgram, \"texsize\");\r\n    this.texsizeNoiseLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noise_lq\"\r\n    );\r\n    this.texsizeNoiseMQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noise_mq\"\r\n    );\r\n    this.texsizeNoiseHQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noise_hq\"\r\n    );\r\n    this.texsizeNoiseLQLiteLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noise_lq_lite\"\r\n    );\r\n    this.texsizeNoiseVolLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noisevol_lq\"\r\n    );\r\n    this.texsizeNoiseVolHQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noisevol_hq\"\r\n    );\r\n    this.resolutionLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"resolution\"\r\n    );\r\n    this.aspectLoc = this.gl.getUniformLocation(this.shaderProgram, \"aspect\");\r\n    this.bassLoc = this.gl.getUniformLocation(this.shaderProgram, \"bass\");\r\n    this.midLoc = this.gl.getUniformLocation(this.shaderProgram, \"mid\");\r\n    this.trebLoc = this.gl.getUniformLocation(this.shaderProgram, \"treb\");\r\n    this.volLoc = this.gl.getUniformLocation(this.shaderProgram, \"vol\");\r\n    this.bassAttLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"bass_att\"\r\n    );\r\n    this.midAttLoc = this.gl.getUniformLocation(this.shaderProgram, \"mid_att\");\r\n    this.trebAttLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"treb_att\"\r\n    );\r\n    this.volAttLoc = this.gl.getUniformLocation(this.shaderProgram, \"vol_att\");\r\n    this.timeLoc = this.gl.getUniformLocation(this.shaderProgram, \"time\");\r\n    this.frameLoc = this.gl.getUniformLocation(this.shaderProgram, \"frame\");\r\n    this.fpsLoc = this.gl.getUniformLocation(this.shaderProgram, \"fps\");\r\n    this.blur1MinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur1_min\"\r\n    );\r\n    this.blur1MaxLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur1_max\"\r\n    );\r\n    this.blur2MinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur2_min\"\r\n    );\r\n    this.blur2MaxLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur2_max\"\r\n    );\r\n    this.blur3MinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur3_min\"\r\n    );\r\n    this.blur3MaxLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur3_max\"\r\n    );\r\n    this.scale1Loc = this.gl.getUniformLocation(this.shaderProgram, \"scale1\");\r\n    this.scale2Loc = this.gl.getUniformLocation(this.shaderProgram, \"scale2\");\r\n    this.scale3Loc = this.gl.getUniformLocation(this.shaderProgram, \"scale3\");\r\n    this.bias1Loc = this.gl.getUniformLocation(this.shaderProgram, \"bias1\");\r\n    this.bias2Loc = this.gl.getUniformLocation(this.shaderProgram, \"bias2\");\r\n    this.bias3Loc = this.gl.getUniformLocation(this.shaderProgram, \"bias3\");\r\n    this.randPresetLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"rand_preset\"\r\n    );\r\n    this.randFrameLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"rand_frame\"\r\n    );\r\n\r\n    this.qaLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qa\");\r\n    this.qbLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qb\");\r\n    this.qcLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qc\");\r\n    this.qdLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qd\");\r\n    this.qeLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qe\");\r\n    this.qfLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qf\");\r\n    this.qgLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qg\");\r\n    this.qhLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qh\");\r\n\r\n    this.slowRoamCosLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"slow_roam_cos\"\r\n    );\r\n    this.roamCosLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"roam_cos\"\r\n    );\r\n    this.slowRoamSinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"slow_roam_sin\"\r\n    );\r\n    this.roamSinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"roam_sin\"\r\n    );\r\n\r\n    for (let i = 0; i < this.userTextures.length; i++) {\r\n      const userTexture = this.userTextures[i];\r\n      userTexture.textureLoc = this.gl.getUniformLocation(\r\n        this.shaderProgram,\r\n        `sampler_${userTexture.sampler}`\r\n      );\r\n    }\r\n  }\r\n\r\n  updateShader(shaderText) {\r\n    this.createShader(shaderText);\r\n  }\r\n\r\n  bindBlurVals(blurMins, blurMaxs) {\r\n    const blurMin1 = blurMins[0];\r\n    const blurMin2 = blurMins[1];\r\n    const blurMin3 = blurMins[2];\r\n    const blurMax1 = blurMaxs[0];\r\n    const blurMax2 = blurMaxs[1];\r\n    const blurMax3 = blurMaxs[2];\r\n\r\n    const scale1 = blurMax1 - blurMin1;\r\n    const bias1 = blurMin1;\r\n\r\n    const scale2 = blurMax2 - blurMin2;\r\n    const bias2 = blurMin2;\r\n\r\n    const scale3 = blurMax3 - blurMin3;\r\n    const bias3 = blurMin3;\r\n\r\n    this.gl.uniform1f(this.blur1MinLoc, blurMin1);\r\n    this.gl.uniform1f(this.blur1MaxLoc, blurMax1);\r\n    this.gl.uniform1f(this.blur2MinLoc, blurMin2);\r\n    this.gl.uniform1f(this.blur2MaxLoc, blurMax2);\r\n    this.gl.uniform1f(this.blur3MinLoc, blurMin3);\r\n    this.gl.uniform1f(this.blur3MaxLoc, blurMax3);\r\n    this.gl.uniform1f(this.scale1Loc, scale1);\r\n    this.gl.uniform1f(this.scale2Loc, scale2);\r\n    this.gl.uniform1f(this.scale3Loc, scale3);\r\n    this.gl.uniform1f(this.bias1Loc, bias1);\r\n    this.gl.uniform1f(this.bias2Loc, bias2);\r\n    this.gl.uniform1f(this.bias3Loc, bias3);\r\n  }\r\n\r\n  renderQuadTexture(\r\n    blending,\r\n    texture,\r\n    blurTexture1,\r\n    blurTexture2,\r\n    blurTexture3,\r\n    blurMins,\r\n    blurMaxs,\r\n    mdVSFrame,\r\n    mdVSQs,\r\n    warpUVs,\r\n    warpColor\r\n  ) {\r\n    this.gl.useProgram(this.shaderProgram);\r\n\r\n    this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.indexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ELEMENT_ARRAY_BUFFER,\r\n      this.indices,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionVertexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ARRAY_BUFFER,\r\n      this.vertices,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.positionLocation,\r\n      3,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.positionLocation);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.warpUvVertexBuf);\r\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, warpUVs, this.gl.STATIC_DRAW);\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.warpUvLocation,\r\n      2,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.warpUvLocation);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.warpColorVertexBuf);\r\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, warpColor, this.gl.STATIC_DRAW);\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.warpColorLocation,\r\n      4,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.warpColorLocation);\r\n\r\n    const wrapping =\r\n      mdVSFrame.wrap !== 0 ? this.gl.REPEAT : this.gl.CLAMP_TO_EDGE;\r\n    this.gl.samplerParameteri(\r\n      this.mainSampler,\r\n      this.gl.TEXTURE_WRAP_S,\r\n      wrapping\r\n    );\r\n    this.gl.samplerParameteri(\r\n      this.mainSampler,\r\n      this.gl.TEXTURE_WRAP_T,\r\n      wrapping\r\n    );\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE0);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(0, this.mainSampler);\r\n    this.gl.uniform1i(this.textureLoc, 0);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE1);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(1, this.mainSamplerFW);\r\n    this.gl.uniform1i(this.textureFWLoc, 1);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE2);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(2, this.mainSamplerFC);\r\n    this.gl.uniform1i(this.textureFCLoc, 2);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE3);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(3, this.mainSamplerPW);\r\n    this.gl.uniform1i(this.texturePWLoc, 3);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE4);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(4, this.mainSamplerPC);\r\n    this.gl.uniform1i(this.texturePCLoc, 4);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE5);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, blurTexture1);\r\n    this.gl.uniform1i(this.blurTexture1Loc, 5);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE6);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, blurTexture2);\r\n    this.gl.uniform1i(this.blurTexture2Loc, 6);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE7);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, blurTexture3);\r\n    this.gl.uniform1i(this.blurTexture3Loc, 7);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE8);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexLQ);\r\n    this.gl.uniform1i(this.noiseLQLoc, 8);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE9);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexMQ);\r\n    this.gl.uniform1i(this.noiseMQLoc, 9);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE10);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexHQ);\r\n    this.gl.uniform1i(this.noiseHQLoc, 10);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE11);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexLQLite);\r\n    this.gl.uniform1i(this.noiseLQLiteLoc, 11);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE12);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexLQ);\r\n    this.gl.bindSampler(12, this.noise.noiseTexPointLQ);\r\n    this.gl.uniform1i(this.noisePointLQLoc, 12);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE13);\r\n    this.gl.bindTexture(this.gl.TEXTURE_3D, this.noise.noiseTexVolLQ);\r\n    this.gl.uniform1i(this.noiseVolLQLoc, 13);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE14);\r\n    this.gl.bindTexture(this.gl.TEXTURE_3D, this.noise.noiseTexVolHQ);\r\n    this.gl.uniform1i(this.noiseVolHQLoc, 14);\r\n\r\n    for (let i = 0; i < this.userTextures.length; i++) {\r\n      const userTexture = this.userTextures[i];\r\n      this.gl.activeTexture(this.gl.TEXTURE15 + i);\r\n      this.gl.bindTexture(\r\n        this.gl.TEXTURE_2D,\r\n        this.image.getTexture(userTexture.sampler)\r\n      );\r\n      this.gl.uniform1i(userTexture.textureLoc, 15 + i);\r\n    }\r\n\r\n    this.gl.uniform1f(this.decayLoc, mdVSFrame.decay);\r\n    this.gl.uniform2fv(this.resolutionLoc, [this.texsizeX, this.texsizeY]);\r\n    this.gl.uniform4fv(this.aspectLoc, [\r\n      this.aspectx,\r\n      this.aspecty,\r\n      this.invAspectx,\r\n      this.invAspecty,\r\n    ]);\r\n    this.gl.uniform4fv(this.texsizeLoc, [\r\n      this.texsizeX,\r\n      this.texsizeY,\r\n      1.0 / this.texsizeX,\r\n      1.0 / this.texsizeY,\r\n    ]);\r\n    this.gl.uniform4fv(this.texsizeNoiseLQLoc, [256, 256, 1 / 256, 1 / 256]);\r\n    this.gl.uniform4fv(this.texsizeNoiseMQLoc, [256, 256, 1 / 256, 1 / 256]);\r\n    this.gl.uniform4fv(this.texsizeNoiseHQLoc, [256, 256, 1 / 256, 1 / 256]);\r\n    this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc, [32, 32, 1 / 32, 1 / 32]);\r\n    this.gl.uniform4fv(this.texsizeNoiseVolLQLoc, [32, 32, 1 / 32, 1 / 32]);\r\n    this.gl.uniform4fv(this.texsizeNoiseVolHQLoc, [32, 32, 1 / 32, 1 / 32]);\r\n\r\n    this.gl.uniform1f(this.bassLoc, mdVSFrame.bass);\r\n    this.gl.uniform1f(this.midLoc, mdVSFrame.mid);\r\n    this.gl.uniform1f(this.trebLoc, mdVSFrame.treb);\r\n    this.gl.uniform1f(\r\n      this.volLoc,\r\n      (mdVSFrame.bass + mdVSFrame.mid + mdVSFrame.treb) / 3\r\n    );\r\n    this.gl.uniform1f(this.bassAttLoc, mdVSFrame.bass_att);\r\n    this.gl.uniform1f(this.midAttLoc, mdVSFrame.mid_att);\r\n    this.gl.uniform1f(this.trebAttLoc, mdVSFrame.treb_att);\r\n    this.gl.uniform1f(\r\n      this.volAttLoc,\r\n      (mdVSFrame.bass_att + mdVSFrame.mid_att + mdVSFrame.treb_att) / 3\r\n    );\r\n    this.gl.uniform1f(this.timeLoc, mdVSFrame.time);\r\n    this.gl.uniform1f(this.frameLoc, mdVSFrame.frame);\r\n    this.gl.uniform1f(this.fpsLoc, mdVSFrame.fps);\r\n    this.gl.uniform4fv(this.randPresetLoc, mdVSFrame.rand_preset);\r\n    this.gl.uniform4fv(\r\n      this.randFrameLoc,\r\n      new Float32Array([\r\n        this.rng.random(),\r\n        this.rng.random(),\r\n        this.rng.random(),\r\n        this.rng.random(),\r\n      ])\r\n    );\r\n\r\n    this.gl.uniform4fv(\r\n      this.qaLoc,\r\n      new Float32Array([\r\n        mdVSQs.q1 || 0,\r\n        mdVSQs.q2 || 0,\r\n        mdVSQs.q3 || 0,\r\n        mdVSQs.q4 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qbLoc,\r\n      new Float32Array([\r\n        mdVSQs.q5 || 0,\r\n        mdVSQs.q6 || 0,\r\n        mdVSQs.q7 || 0,\r\n        mdVSQs.q8 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qcLoc,\r\n      new Float32Array([\r\n        mdVSQs.q9 || 0,\r\n        mdVSQs.q10 || 0,\r\n        mdVSQs.q11 || 0,\r\n        mdVSQs.q12 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qdLoc,\r\n      new Float32Array([\r\n        mdVSQs.q13 || 0,\r\n        mdVSQs.q14 || 0,\r\n        mdVSQs.q15 || 0,\r\n        mdVSQs.q16 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qeLoc,\r\n      new Float32Array([\r\n        mdVSQs.q17 || 0,\r\n        mdVSQs.q18 || 0,\r\n        mdVSQs.q19 || 0,\r\n        mdVSQs.q20 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qfLoc,\r\n      new Float32Array([\r\n        mdVSQs.q21 || 0,\r\n        mdVSQs.q22 || 0,\r\n        mdVSQs.q23 || 0,\r\n        mdVSQs.q24 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qgLoc,\r\n      new Float32Array([\r\n        mdVSQs.q25 || 0,\r\n        mdVSQs.q26 || 0,\r\n        mdVSQs.q27 || 0,\r\n        mdVSQs.q28 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qhLoc,\r\n      new Float32Array([\r\n        mdVSQs.q29 || 0,\r\n        mdVSQs.q30 || 0,\r\n        mdVSQs.q31 || 0,\r\n        mdVSQs.q32 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(this.slowRoamCosLoc, [\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.005),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.008),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.013),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.022),\r\n    ]);\r\n    this.gl.uniform4fv(this.roamCosLoc, [\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.3),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 1.3),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 5.0),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 20.0),\r\n    ]);\r\n    this.gl.uniform4fv(this.slowRoamSinLoc, [\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.005),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.008),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.013),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.022),\r\n    ]);\r\n    this.gl.uniform4fv(this.roamSinLoc, [\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.3),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 1.3),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 5.0),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 20.0),\r\n    ]);\r\n\r\n    this.bindBlurVals(blurMins, blurMaxs);\r\n\r\n    if (blending) {\r\n      this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n    } else {\r\n      this.gl.disable(this.gl.BLEND);\r\n    }\r\n\r\n    this.gl.drawElements(\r\n      this.gl.TRIANGLES,\r\n      this.indices.length,\r\n      this.gl.UNSIGNED_SHORT,\r\n      0\r\n    );\r\n\r\n    if (!blending) {\r\n      this.gl.enable(this.gl.BLEND);\r\n    }\r\n  }\r\n}\r\n","import ShaderUtils from \"./shaderUtils\";\r\nimport { getRNG } from \"../../utils/rngContext\";\r\n\r\nexport default class CompShader {\r\n  constructor(gl, noise, image, opts = {}) {\r\n    this.gl = gl;\r\n    this.noise = noise;\r\n    this.image = image;\r\n    this.rng = getRNG();\r\n\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.compWidth = 32;\r\n    this.compHeight = 24;\r\n\r\n    this.buildPositions();\r\n\r\n    this.indexBuf = gl.createBuffer();\r\n    this.positionVertexBuf = this.gl.createBuffer();\r\n    this.compColorVertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n\r\n    this.mainSampler = this.gl.createSampler();\r\n    this.mainSamplerFW = this.gl.createSampler();\r\n    this.mainSamplerFC = this.gl.createSampler();\r\n    this.mainSamplerPW = this.gl.createSampler();\r\n    this.mainSamplerPC = this.gl.createSampler();\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSampler,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    gl.samplerParameteri(this.mainSampler, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.samplerParameteri(this.mainSampler, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n    gl.samplerParameteri(this.mainSampler, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSamplerFW,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    gl.samplerParameteri(this.mainSamplerFW, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.samplerParameteri(this.mainSamplerFW, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n    gl.samplerParameteri(this.mainSamplerFW, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSamplerFC,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    gl.samplerParameteri(this.mainSamplerFC, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n    gl.samplerParameteri(\r\n      this.mainSamplerFC,\r\n      gl.TEXTURE_WRAP_S,\r\n      gl.CLAMP_TO_EDGE\r\n    );\r\n    gl.samplerParameteri(\r\n      this.mainSamplerFC,\r\n      gl.TEXTURE_WRAP_T,\r\n      gl.CLAMP_TO_EDGE\r\n    );\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSamplerPW,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.NEAREST_MIPMAP_NEAREST\r\n    );\r\n    gl.samplerParameteri(this.mainSamplerPW, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.samplerParameteri(this.mainSamplerPW, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n    gl.samplerParameteri(this.mainSamplerPW, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n\r\n    gl.samplerParameteri(\r\n      this.mainSamplerPC,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.NEAREST_MIPMAP_NEAREST\r\n    );\r\n    gl.samplerParameteri(this.mainSamplerPC, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.samplerParameteri(\r\n      this.mainSamplerPC,\r\n      gl.TEXTURE_WRAP_S,\r\n      gl.CLAMP_TO_EDGE\r\n    );\r\n    gl.samplerParameteri(\r\n      this.mainSamplerPC,\r\n      gl.TEXTURE_WRAP_T,\r\n      gl.CLAMP_TO_EDGE\r\n    );\r\n  }\r\n\r\n  // based on https://github.com/mrdoob/three.js/blob/master/src/geometries/PlaneGeometry.js\r\n  buildPositions() {\r\n    const width = 2;\r\n    const height = 2;\r\n\r\n    const widthHalf = width / 2;\r\n    const heightHalf = height / 2;\r\n\r\n    const gridX = this.compWidth;\r\n    const gridY = this.compHeight;\r\n\r\n    const gridX1 = gridX + 1;\r\n    const gridY1 = gridY + 1;\r\n\r\n    const segmentWidth = width / gridX;\r\n    const segmentHeight = height / gridY;\r\n\r\n    const vertices = [];\r\n    for (let iy = 0; iy < gridY1; iy++) {\r\n      const y = iy * segmentHeight - heightHalf;\r\n      for (let ix = 0; ix < gridX1; ix++) {\r\n        const x = ix * segmentWidth - widthHalf;\r\n\r\n        vertices.push(x, -y, 0);\r\n      }\r\n    }\r\n\r\n    const indices = [];\r\n    for (let iy = 0; iy < gridY; iy++) {\r\n      for (let ix = 0; ix < gridX; ix++) {\r\n        const a = ix + gridX1 * iy;\r\n        const b = ix + gridX1 * (iy + 1);\r\n        const c = ix + 1 + gridX1 * (iy + 1);\r\n        const d = ix + 1 + gridX1 * iy;\r\n\r\n        indices.push(a, b, d);\r\n        indices.push(b, c, d);\r\n      }\r\n    }\r\n\r\n    this.vertices = new Float32Array(vertices);\r\n    this.indices = new Uint16Array(indices);\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.buildPositions();\r\n  }\r\n\r\n  createShader(shaderText = \"\") {\r\n    let fragShaderText;\r\n    let fragShaderHeaderText;\r\n    if (shaderText.length === 0) {\r\n      fragShaderText = `float orient_horiz = mod(echo_orientation, 2.0);\r\n                        float orient_x = (orient_horiz != 0.0) ? -1.0 : 1.0;\r\n                        float orient_y = (echo_orientation >= 2.0) ? -1.0 : 1.0;\r\n                        vec2 uv_echo = ((uv - 0.5) *\r\n                                        (1.0 / echo_zoom) *\r\n                                        vec2(orient_x, orient_y)) + 0.5;\r\n\r\n                        ret = mix(texture(sampler_main, uv).rgb,\r\n                                  texture(sampler_main, uv_echo).rgb,\r\n                                  echo_alpha);\r\n\r\n                        ret *= gammaAdj;\r\n\r\n                        if(fShader >= 1.0) {\r\n                          ret *= hue_shader;\r\n                        } else if(fShader > 0.001) {\r\n                          ret *= (1.0 - fShader) + (fShader * hue_shader);\r\n                        }\r\n\r\n                        if(brighten != 0) ret = sqrt(ret);\r\n                        if(darken != 0) ret = ret*ret;\r\n                        if(solarize != 0) ret = ret * (1.0 - ret) * 4.0;\r\n                        if(invert != 0) ret = 1.0 - ret;`;\r\n      fragShaderHeaderText = \"\";\r\n    } else {\r\n      const shaderParts = ShaderUtils.getShaderParts(shaderText);\r\n      fragShaderHeaderText = shaderParts[0];\r\n      fragShaderText = shaderParts[1];\r\n    }\r\n\r\n    fragShaderText = fragShaderText.replace(/texture2D/g, \"texture\");\r\n    fragShaderText = fragShaderText.replace(/texture3D/g, \"texture\");\r\n\r\n    this.userTextures = ShaderUtils.getUserSamplers(fragShaderHeaderText);\r\n\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      const vec2 halfmad = vec2(0.5);\r\n      in vec2 aPos;\r\n      in vec4 aCompColor;\r\n      out vec2 vUv;\r\n      out vec4 vColor;\r\n      void main(void) {\r\n        gl_Position = vec4(aPos, 0.0, 1.0);\r\n        vUv = aPos * halfmad + halfmad;\r\n        vColor = aCompColor;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `\r\n      #version 300 es\r\n      precision ${this.floatPrecision} float;\r\n      precision highp int;\r\n      precision mediump sampler2D;\r\n      precision mediump sampler3D;\r\n\r\n      vec3 lum(vec3 v){\r\n          return vec3(dot(v, vec3(0.32,0.49,0.29)));\r\n      }\r\n\r\n      in vec2 vUv;\r\n      in vec4 vColor;\r\n      out vec4 fragColor;\r\n      uniform sampler2D sampler_main;\r\n      uniform sampler2D sampler_fw_main;\r\n      uniform sampler2D sampler_fc_main;\r\n      uniform sampler2D sampler_pw_main;\r\n      uniform sampler2D sampler_pc_main;\r\n      uniform sampler2D sampler_blur1;\r\n      uniform sampler2D sampler_blur2;\r\n      uniform sampler2D sampler_blur3;\r\n      uniform sampler2D sampler_noise_lq;\r\n      uniform sampler2D sampler_noise_lq_lite;\r\n      uniform sampler2D sampler_noise_mq;\r\n      uniform sampler2D sampler_noise_hq;\r\n      uniform sampler2D sampler_pw_noise_lq;\r\n      uniform sampler3D sampler_noisevol_lq;\r\n      uniform sampler3D sampler_noisevol_hq;\r\n\r\n      uniform float time;\r\n      uniform float gammaAdj;\r\n      uniform float echo_zoom;\r\n      uniform float echo_alpha;\r\n      uniform float echo_orientation;\r\n      uniform int invert;\r\n      uniform int brighten;\r\n      uniform int darken;\r\n      uniform int solarize;\r\n      uniform vec2 resolution;\r\n      uniform vec4 aspect;\r\n      uniform vec4 texsize;\r\n      uniform vec4 texsize_noise_lq;\r\n      uniform vec4 texsize_noise_mq;\r\n      uniform vec4 texsize_noise_hq;\r\n      uniform vec4 texsize_noise_lq_lite;\r\n      uniform vec4 texsize_noisevol_lq;\r\n      uniform vec4 texsize_noisevol_hq;\r\n\r\n      uniform float bass;\r\n      uniform float mid;\r\n      uniform float treb;\r\n      uniform float vol;\r\n      uniform float bass_att;\r\n      uniform float mid_att;\r\n      uniform float treb_att;\r\n      uniform float vol_att;\r\n\r\n      uniform float frame;\r\n      uniform float fps;\r\n\r\n      uniform vec4 _qa;\r\n      uniform vec4 _qb;\r\n      uniform vec4 _qc;\r\n      uniform vec4 _qd;\r\n      uniform vec4 _qe;\r\n      uniform vec4 _qf;\r\n      uniform vec4 _qg;\r\n      uniform vec4 _qh;\r\n\r\n      #define q1 _qa.x\r\n      #define q2 _qa.y\r\n      #define q3 _qa.z\r\n      #define q4 _qa.w\r\n      #define q5 _qb.x\r\n      #define q6 _qb.y\r\n      #define q7 _qb.z\r\n      #define q8 _qb.w\r\n      #define q9 _qc.x\r\n      #define q10 _qc.y\r\n      #define q11 _qc.z\r\n      #define q12 _qc.w\r\n      #define q13 _qd.x\r\n      #define q14 _qd.y\r\n      #define q15 _qd.z\r\n      #define q16 _qd.w\r\n      #define q17 _qe.x\r\n      #define q18 _qe.y\r\n      #define q19 _qe.z\r\n      #define q20 _qe.w\r\n      #define q21 _qf.x\r\n      #define q22 _qf.y\r\n      #define q23 _qf.z\r\n      #define q24 _qf.w\r\n      #define q25 _qg.x\r\n      #define q26 _qg.y\r\n      #define q27 _qg.z\r\n      #define q28 _qg.w\r\n      #define q29 _qh.x\r\n      #define q30 _qh.y\r\n      #define q31 _qh.z\r\n      #define q32 _qh.w\r\n\r\n      uniform vec4 slow_roam_cos;\r\n      uniform vec4 roam_cos;\r\n      uniform vec4 slow_roam_sin;\r\n      uniform vec4 roam_sin;\r\n\r\n      uniform float blur1_min;\r\n      uniform float blur1_max;\r\n      uniform float blur2_min;\r\n      uniform float blur2_max;\r\n      uniform float blur3_min;\r\n      uniform float blur3_max;\r\n\r\n      uniform float scale1;\r\n      uniform float scale2;\r\n      uniform float scale3;\r\n      uniform float bias1;\r\n      uniform float bias2;\r\n      uniform float bias3;\r\n\r\n      uniform vec4 rand_frame;\r\n      uniform vec4 rand_preset;\r\n\r\n      uniform float fShader;\r\n\r\n      float PI = ${Math.PI};\r\n\r\n      ${fragShaderHeaderText}\r\n\r\n      void main(void) {\r\n        vec3 ret;\r\n        vec2 uv = vUv;\r\n        vec2 uv_orig = vUv;\r\n        uv.y = 1.0 - uv.y;\r\n        uv_orig.y = 1.0 - uv_orig.y;\r\n        float rad = length(uv - 0.5);\r\n        float ang = atan(uv.x - 0.5, uv.y - 0.5);\r\n        vec3 hue_shader = vColor.rgb;\r\n\r\n        ${fragShaderText}\r\n\r\n        fragColor = vec4(ret, vColor.a);\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.positionLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aPos\"\r\n    );\r\n    this.compColorLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aCompColor\"\r\n    );\r\n    this.textureLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_main\"\r\n    );\r\n    this.textureFWLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_fw_main\"\r\n    );\r\n    this.textureFCLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_fc_main\"\r\n    );\r\n    this.texturePWLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_pw_main\"\r\n    );\r\n    this.texturePCLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_pc_main\"\r\n    );\r\n    this.blurTexture1Loc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_blur1\"\r\n    );\r\n    this.blurTexture2Loc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_blur2\"\r\n    );\r\n    this.blurTexture3Loc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_blur3\"\r\n    );\r\n    this.noiseLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noise_lq\"\r\n    );\r\n    this.noiseMQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noise_mq\"\r\n    );\r\n    this.noiseHQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noise_hq\"\r\n    );\r\n    this.noiseLQLiteLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noise_lq_lite\"\r\n    );\r\n    this.noisePointLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_pw_noise_lq\"\r\n    );\r\n    this.noiseVolLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noisevol_lq\"\r\n    );\r\n    this.noiseVolHQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"sampler_noisevol_hq\"\r\n    );\r\n    this.timeLoc = this.gl.getUniformLocation(this.shaderProgram, \"time\");\r\n    this.gammaAdjLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"gammaAdj\"\r\n    );\r\n    this.echoZoomLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"echo_zoom\"\r\n    );\r\n    this.echoAlphaLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"echo_alpha\"\r\n    );\r\n    this.echoOrientationLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"echo_orientation\"\r\n    );\r\n    this.invertLoc = this.gl.getUniformLocation(this.shaderProgram, \"invert\");\r\n    this.brightenLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"brighten\"\r\n    );\r\n    this.darkenLoc = this.gl.getUniformLocation(this.shaderProgram, \"darken\");\r\n    this.solarizeLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"solarize\"\r\n    );\r\n    this.texsizeLoc = this.gl.getUniformLocation(this.shaderProgram, \"texsize\");\r\n    this.texsizeNoiseLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noise_lq\"\r\n    );\r\n    this.texsizeNoiseMQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noise_mq\"\r\n    );\r\n    this.texsizeNoiseHQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noise_hq\"\r\n    );\r\n    this.texsizeNoiseLQLiteLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noise_lq_lite\"\r\n    );\r\n    this.texsizeNoiseVolLQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noisevol_lq\"\r\n    );\r\n    this.texsizeNoiseVolHQLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize_noisevol_hq\"\r\n    );\r\n    this.resolutionLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"resolution\"\r\n    );\r\n    this.aspectLoc = this.gl.getUniformLocation(this.shaderProgram, \"aspect\");\r\n    this.bassLoc = this.gl.getUniformLocation(this.shaderProgram, \"bass\");\r\n    this.midLoc = this.gl.getUniformLocation(this.shaderProgram, \"mid\");\r\n    this.trebLoc = this.gl.getUniformLocation(this.shaderProgram, \"treb\");\r\n    this.volLoc = this.gl.getUniformLocation(this.shaderProgram, \"vol\");\r\n    this.bassAttLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"bass_att\"\r\n    );\r\n    this.midAttLoc = this.gl.getUniformLocation(this.shaderProgram, \"mid_att\");\r\n    this.trebAttLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"treb_att\"\r\n    );\r\n    this.volAttLoc = this.gl.getUniformLocation(this.shaderProgram, \"vol_att\");\r\n    this.frameLoc = this.gl.getUniformLocation(this.shaderProgram, \"frame\");\r\n    this.fpsLoc = this.gl.getUniformLocation(this.shaderProgram, \"fps\");\r\n    this.blur1MinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur1_min\"\r\n    );\r\n    this.blur1MaxLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur1_max\"\r\n    );\r\n    this.blur2MinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur2_min\"\r\n    );\r\n    this.blur2MaxLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur2_max\"\r\n    );\r\n    this.blur3MinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur3_min\"\r\n    );\r\n    this.blur3MaxLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"blur3_max\"\r\n    );\r\n    this.scale1Loc = this.gl.getUniformLocation(this.shaderProgram, \"scale1\");\r\n    this.scale2Loc = this.gl.getUniformLocation(this.shaderProgram, \"scale2\");\r\n    this.scale3Loc = this.gl.getUniformLocation(this.shaderProgram, \"scale3\");\r\n    this.bias1Loc = this.gl.getUniformLocation(this.shaderProgram, \"bias1\");\r\n    this.bias2Loc = this.gl.getUniformLocation(this.shaderProgram, \"bias2\");\r\n    this.bias3Loc = this.gl.getUniformLocation(this.shaderProgram, \"bias3\");\r\n    this.randPresetLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"rand_preset\"\r\n    );\r\n    this.randFrameLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"rand_frame\"\r\n    );\r\n    this.fShaderLoc = this.gl.getUniformLocation(this.shaderProgram, \"fShader\");\r\n\r\n    this.qaLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qa\");\r\n    this.qbLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qb\");\r\n    this.qcLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qc\");\r\n    this.qdLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qd\");\r\n    this.qeLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qe\");\r\n    this.qfLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qf\");\r\n    this.qgLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qg\");\r\n    this.qhLoc = this.gl.getUniformLocation(this.shaderProgram, \"_qh\");\r\n\r\n    this.slowRoamCosLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"slow_roam_cos\"\r\n    );\r\n    this.roamCosLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"roam_cos\"\r\n    );\r\n    this.slowRoamSinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"slow_roam_sin\"\r\n    );\r\n    this.roamSinLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"roam_sin\"\r\n    );\r\n\r\n    for (let i = 0; i < this.userTextures.length; i++) {\r\n      const userTexture = this.userTextures[i];\r\n      userTexture.textureLoc = this.gl.getUniformLocation(\r\n        this.shaderProgram,\r\n        `sampler_${userTexture.sampler}`\r\n      );\r\n    }\r\n  }\r\n\r\n  updateShader(shaderText) {\r\n    this.createShader(shaderText);\r\n  }\r\n\r\n  bindBlurVals(blurMins, blurMaxs) {\r\n    const blurMin1 = blurMins[0];\r\n    const blurMin2 = blurMins[1];\r\n    const blurMin3 = blurMins[2];\r\n    const blurMax1 = blurMaxs[0];\r\n    const blurMax2 = blurMaxs[1];\r\n    const blurMax3 = blurMaxs[2];\r\n\r\n    const scale1 = blurMax1 - blurMin1;\r\n    const bias1 = blurMin1;\r\n\r\n    const scale2 = blurMax2 - blurMin2;\r\n    const bias2 = blurMin2;\r\n\r\n    const scale3 = blurMax3 - blurMin3;\r\n    const bias3 = blurMin3;\r\n\r\n    this.gl.uniform1f(this.blur1MinLoc, blurMin1);\r\n    this.gl.uniform1f(this.blur1MaxLoc, blurMax1);\r\n    this.gl.uniform1f(this.blur2MinLoc, blurMin2);\r\n    this.gl.uniform1f(this.blur2MaxLoc, blurMax2);\r\n    this.gl.uniform1f(this.blur3MinLoc, blurMin3);\r\n    this.gl.uniform1f(this.blur3MaxLoc, blurMax3);\r\n    this.gl.uniform1f(this.scale1Loc, scale1);\r\n    this.gl.uniform1f(this.scale2Loc, scale2);\r\n    this.gl.uniform1f(this.scale3Loc, scale3);\r\n    this.gl.uniform1f(this.bias1Loc, bias1);\r\n    this.gl.uniform1f(this.bias2Loc, bias2);\r\n    this.gl.uniform1f(this.bias3Loc, bias3);\r\n  }\r\n\r\n  static generateHueBase(mdVSFrame) {\r\n    const hueBase = new Float32Array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]);\r\n\r\n    /* eslint-disable max-len */\r\n    for (let i = 0; i < 4; i++) {\r\n      hueBase[i * 3 + 0] =\r\n        0.6 +\r\n        0.3 *\r\n          Math.sin(\r\n            mdVSFrame.time * 30.0 * 0.0143 +\r\n              3 +\r\n              i * 21 +\r\n              mdVSFrame.rand_start[3]\r\n          );\r\n      hueBase[i * 3 + 1] =\r\n        0.6 +\r\n        0.3 *\r\n          Math.sin(\r\n            mdVSFrame.time * 30.0 * 0.0107 +\r\n              1 +\r\n              i * 13 +\r\n              mdVSFrame.rand_start[1]\r\n          );\r\n      hueBase[i * 3 + 2] =\r\n        0.6 +\r\n        0.3 *\r\n          Math.sin(\r\n            mdVSFrame.time * 30.0 * 0.0129 + 6 + i * 9 + mdVSFrame.rand_start[2]\r\n          );\r\n      const maxshade = Math.max(\r\n        hueBase[i * 3],\r\n        hueBase[i * 3 + 1],\r\n        hueBase[i * 3 + 2]\r\n      );\r\n      for (let k = 0; k < 3; k++) {\r\n        hueBase[i * 3 + k] = hueBase[i * 3 + k] / maxshade;\r\n        hueBase[i * 3 + k] = 0.5 + 0.5 * hueBase[i * 3 + k];\r\n      }\r\n    }\r\n    /* eslint-enable max-len */\r\n\r\n    return hueBase;\r\n  }\r\n\r\n  generateCompColors(blending, mdVSFrame, warpColor) {\r\n    const hueBase = CompShader.generateHueBase(mdVSFrame);\r\n    const gridX1 = this.compWidth + 1;\r\n    const gridY1 = this.compHeight + 1;\r\n    const compColor = new Float32Array(gridX1 * gridY1 * 4);\r\n\r\n    let offsetColor = 0;\r\n    for (let j = 0; j < gridY1; j++) {\r\n      for (let i = 0; i < gridX1; i++) {\r\n        let x = i / this.compWidth;\r\n        let y = j / this.compHeight;\r\n\r\n        const col = [1, 1, 1];\r\n        for (let c = 0; c < 3; c++) {\r\n          col[c] =\r\n            hueBase[0 + c] * x * y +\r\n            hueBase[3 + c] * (1 - x) * y +\r\n            hueBase[6 + c] * x * (1 - y) +\r\n            hueBase[9 + c] * (1 - x) * (1 - y);\r\n        }\r\n\r\n        let alpha = 1;\r\n        if (blending) {\r\n          x *= this.mesh_width + 1;\r\n          y *= this.mesh_height + 1;\r\n          x = Math.clamp(x, 0, this.mesh_width - 1);\r\n          y = Math.clamp(y, 0, this.mesh_height - 1);\r\n          const nx = Math.floor(x);\r\n          const ny = Math.floor(y);\r\n          const dx = x - nx;\r\n          const dy = y - ny;\r\n          const alpha00 = warpColor[(ny * (this.mesh_width + 1) + nx) * 4 + 3];\r\n          const alpha01 =\r\n            warpColor[(ny * (this.mesh_width + 1) + (nx + 1)) * 4 + 3];\r\n          const alpha10 =\r\n            warpColor[((ny + 1) * (this.mesh_width + 1) + nx) * 4 + 3];\r\n          const alpha11 =\r\n            warpColor[((ny + 1) * (this.mesh_width + 1) + (nx + 1)) * 4 + 3];\r\n          alpha =\r\n            alpha00 * (1 - dx) * (1 - dy) +\r\n            alpha01 * dx * (1 - dy) +\r\n            alpha10 * (1 - dx) * dy +\r\n            alpha11 * dx * dy;\r\n        }\r\n\r\n        compColor[offsetColor + 0] = col[0];\r\n        compColor[offsetColor + 1] = col[1];\r\n        compColor[offsetColor + 2] = col[2];\r\n        compColor[offsetColor + 3] = alpha;\r\n\r\n        offsetColor += 4;\r\n      }\r\n    }\r\n\r\n    return compColor;\r\n  }\r\n\r\n  renderQuadTexture(\r\n    blending,\r\n    texture,\r\n    blurTexture1,\r\n    blurTexture2,\r\n    blurTexture3,\r\n    blurMins,\r\n    blurMaxs,\r\n    mdVSFrame,\r\n    mdVSQs,\r\n    warpColor\r\n  ) {\r\n    const compColors = this.generateCompColors(blending, mdVSFrame, warpColor);\r\n\r\n    this.gl.useProgram(this.shaderProgram);\r\n\r\n    this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.indexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ELEMENT_ARRAY_BUFFER,\r\n      this.indices,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionVertexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ARRAY_BUFFER,\r\n      this.vertices,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.positionLocation,\r\n      3,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.positionLocation);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.compColorVertexBuf);\r\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, compColors, this.gl.STATIC_DRAW);\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.compColorLocation,\r\n      4,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.compColorLocation);\r\n\r\n    const wrapping =\r\n      mdVSFrame.wrap !== 0 ? this.gl.REPEAT : this.gl.CLAMP_TO_EDGE;\r\n    this.gl.samplerParameteri(\r\n      this.mainSampler,\r\n      this.gl.TEXTURE_WRAP_S,\r\n      wrapping\r\n    );\r\n    this.gl.samplerParameteri(\r\n      this.mainSampler,\r\n      this.gl.TEXTURE_WRAP_T,\r\n      wrapping\r\n    );\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE0);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(0, this.mainSampler);\r\n    this.gl.uniform1i(this.textureLoc, 0);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE1);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(1, this.mainSamplerFW);\r\n    this.gl.uniform1i(this.textureFWLoc, 1);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE2);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(2, this.mainSamplerFC);\r\n    this.gl.uniform1i(this.textureFCLoc, 2);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE3);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(3, this.mainSamplerPW);\r\n    this.gl.uniform1i(this.texturePWLoc, 3);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE4);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.bindSampler(4, this.mainSamplerPC);\r\n    this.gl.uniform1i(this.texturePCLoc, 4);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE5);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, blurTexture1);\r\n    this.gl.uniform1i(this.blurTexture1Loc, 5);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE6);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, blurTexture2);\r\n    this.gl.uniform1i(this.blurTexture2Loc, 6);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE7);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, blurTexture3);\r\n    this.gl.uniform1i(this.blurTexture3Loc, 7);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE8);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexLQ);\r\n    this.gl.uniform1i(this.noiseLQLoc, 8);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE9);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexMQ);\r\n    this.gl.uniform1i(this.noiseMQLoc, 9);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE10);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexHQ);\r\n    this.gl.uniform1i(this.noiseHQLoc, 10);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE11);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexLQLite);\r\n    this.gl.uniform1i(this.noiseLQLiteLoc, 11);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE12);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.noise.noiseTexLQ);\r\n    this.gl.bindSampler(12, this.noise.noiseTexPointLQ);\r\n    this.gl.uniform1i(this.noisePointLQLoc, 12);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE13);\r\n    this.gl.bindTexture(this.gl.TEXTURE_3D, this.noise.noiseTexVolLQ);\r\n    this.gl.uniform1i(this.noiseVolLQLoc, 13);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE14);\r\n    this.gl.bindTexture(this.gl.TEXTURE_3D, this.noise.noiseTexVolHQ);\r\n    this.gl.uniform1i(this.noiseVolHQLoc, 14);\r\n\r\n    for (let i = 0; i < this.userTextures.length; i++) {\r\n      const userTexture = this.userTextures[i];\r\n      this.gl.activeTexture(this.gl.TEXTURE15 + i);\r\n      this.gl.bindTexture(\r\n        this.gl.TEXTURE_2D,\r\n        this.image.getTexture(userTexture.sampler)\r\n      );\r\n      this.gl.uniform1i(userTexture.textureLoc, 15 + i);\r\n    }\r\n\r\n    this.gl.uniform1f(this.timeLoc, mdVSFrame.time);\r\n    this.gl.uniform1f(this.gammaAdjLoc, mdVSFrame.gammaadj);\r\n    this.gl.uniform1f(this.echoZoomLoc, mdVSFrame.echo_zoom);\r\n    this.gl.uniform1f(this.echoAlphaLoc, mdVSFrame.echo_alpha);\r\n    this.gl.uniform1f(this.echoOrientationLoc, mdVSFrame.echo_orient);\r\n    this.gl.uniform1i(this.invertLoc, mdVSFrame.invert);\r\n    this.gl.uniform1i(this.brightenLoc, mdVSFrame.brighten);\r\n    this.gl.uniform1i(this.darkenLoc, mdVSFrame.darken);\r\n    this.gl.uniform1i(this.solarizeLoc, mdVSFrame.solarize);\r\n    this.gl.uniform2fv(this.resolutionLoc, [this.texsizeX, this.texsizeY]);\r\n    this.gl.uniform4fv(this.aspectLoc, [\r\n      this.aspectx,\r\n      this.aspecty,\r\n      this.invAspectx,\r\n      this.invAspecty,\r\n    ]);\r\n    this.gl.uniform4fv(\r\n      this.texsizeLoc,\r\n      new Float32Array([\r\n        this.texsizeX,\r\n        this.texsizeY,\r\n        1.0 / this.texsizeX,\r\n        1.0 / this.texsizeY,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(this.texsizeNoiseLQLoc, [256, 256, 1 / 256, 1 / 256]);\r\n    this.gl.uniform4fv(this.texsizeNoiseMQLoc, [256, 256, 1 / 256, 1 / 256]);\r\n    this.gl.uniform4fv(this.texsizeNoiseHQLoc, [256, 256, 1 / 256, 1 / 256]);\r\n    this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc, [32, 32, 1 / 32, 1 / 32]);\r\n    this.gl.uniform4fv(this.texsizeNoiseVolLQLoc, [32, 32, 1 / 32, 1 / 32]);\r\n    this.gl.uniform4fv(this.texsizeNoiseVolHQLoc, [32, 32, 1 / 32, 1 / 32]);\r\n    this.gl.uniform1f(this.bassLoc, mdVSFrame.bass);\r\n    this.gl.uniform1f(this.midLoc, mdVSFrame.mid);\r\n    this.gl.uniform1f(this.trebLoc, mdVSFrame.treb);\r\n    this.gl.uniform1f(\r\n      this.volLoc,\r\n      (mdVSFrame.bass + mdVSFrame.mid + mdVSFrame.treb) / 3\r\n    );\r\n    this.gl.uniform1f(this.bassAttLoc, mdVSFrame.bass_att);\r\n    this.gl.uniform1f(this.midAttLoc, mdVSFrame.mid_att);\r\n    this.gl.uniform1f(this.trebAttLoc, mdVSFrame.treb_att);\r\n    this.gl.uniform1f(\r\n      this.volAttLoc,\r\n      (mdVSFrame.bass_att + mdVSFrame.mid_att + mdVSFrame.treb_att) / 3\r\n    );\r\n    this.gl.uniform1f(this.frameLoc, mdVSFrame.frame);\r\n    this.gl.uniform1f(this.fpsLoc, mdVSFrame.fps);\r\n    this.gl.uniform4fv(this.randPresetLoc, mdVSFrame.rand_preset);\r\n    this.gl.uniform4fv(\r\n      this.randFrameLoc,\r\n      new Float32Array([\r\n        this.rng.random(),\r\n        this.rng.random(),\r\n        this.rng.random(),\r\n        this.rng.random(),\r\n      ])\r\n    );\r\n    this.gl.uniform1f(this.fShaderLoc, mdVSFrame.fshader);\r\n\r\n    this.gl.uniform4fv(\r\n      this.qaLoc,\r\n      new Float32Array([\r\n        mdVSQs.q1 || 0,\r\n        mdVSQs.q2 || 0,\r\n        mdVSQs.q3 || 0,\r\n        mdVSQs.q4 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qbLoc,\r\n      new Float32Array([\r\n        mdVSQs.q5 || 0,\r\n        mdVSQs.q6 || 0,\r\n        mdVSQs.q7 || 0,\r\n        mdVSQs.q8 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qcLoc,\r\n      new Float32Array([\r\n        mdVSQs.q9 || 0,\r\n        mdVSQs.q10 || 0,\r\n        mdVSQs.q11 || 0,\r\n        mdVSQs.q12 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qdLoc,\r\n      new Float32Array([\r\n        mdVSQs.q13 || 0,\r\n        mdVSQs.q14 || 0,\r\n        mdVSQs.q15 || 0,\r\n        mdVSQs.q16 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qeLoc,\r\n      new Float32Array([\r\n        mdVSQs.q17 || 0,\r\n        mdVSQs.q18 || 0,\r\n        mdVSQs.q19 || 0,\r\n        mdVSQs.q20 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qfLoc,\r\n      new Float32Array([\r\n        mdVSQs.q21 || 0,\r\n        mdVSQs.q22 || 0,\r\n        mdVSQs.q23 || 0,\r\n        mdVSQs.q24 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qgLoc,\r\n      new Float32Array([\r\n        mdVSQs.q25 || 0,\r\n        mdVSQs.q26 || 0,\r\n        mdVSQs.q27 || 0,\r\n        mdVSQs.q28 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(\r\n      this.qhLoc,\r\n      new Float32Array([\r\n        mdVSQs.q29 || 0,\r\n        mdVSQs.q30 || 0,\r\n        mdVSQs.q31 || 0,\r\n        mdVSQs.q32 || 0,\r\n      ])\r\n    );\r\n    this.gl.uniform4fv(this.slowRoamCosLoc, [\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.005),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.008),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.013),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.022),\r\n    ]);\r\n    this.gl.uniform4fv(this.roamCosLoc, [\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 0.3),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 1.3),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 5.0),\r\n      0.5 + 0.5 * Math.cos(mdVSFrame.time * 20.0),\r\n    ]);\r\n    this.gl.uniform4fv(this.slowRoamSinLoc, [\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.005),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.008),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.013),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.022),\r\n    ]);\r\n    this.gl.uniform4fv(this.roamSinLoc, [\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 0.3),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 1.3),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 5.0),\r\n      0.5 + 0.5 * Math.sin(mdVSFrame.time * 20.0),\r\n    ]);\r\n\r\n    this.bindBlurVals(blurMins, blurMaxs);\r\n\r\n    if (blending) {\r\n      this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n    } else {\r\n      this.gl.disable(this.gl.BLEND);\r\n    }\r\n\r\n    this.gl.drawElements(\r\n      this.gl.TRIANGLES,\r\n      this.indices.length,\r\n      this.gl.UNSIGNED_SHORT,\r\n      0\r\n    );\r\n\r\n    if (!blending) {\r\n      this.gl.enable(this.gl.BLEND);\r\n    }\r\n  }\r\n}\r\n","import ShaderUtils from \"./shaderUtils\";\r\n\r\nexport default class OutputShader {\r\n  constructor(gl, opts) {\r\n    this.gl = gl;\r\n\r\n    this.textureRatio = opts.textureRatio;\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n\r\n    this.positions = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);\r\n\r\n    this.vertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    if (this.useFXAA()) {\r\n      this.createFXAAShader();\r\n    } else {\r\n      this.createShader();\r\n    }\r\n  }\r\n\r\n  useFXAA() {\r\n    return this.textureRatio <= 1;\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.textureRatio = opts.textureRatio;\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n\r\n    this.gl.deleteProgram(this.shaderProgram);\r\n\r\n    if (this.useFXAA()) {\r\n      this.createFXAAShader();\r\n    } else {\r\n      this.createShader();\r\n    }\r\n  }\r\n\r\n  // based on https://github.com/mattdesl/glsl-fxaa\r\n  createFXAAShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `#version 300 es\r\n       const vec2 halfmad = vec2(0.5);\r\n       in vec2 aPos;\r\n       out vec2 v_rgbM;\r\n       out vec2 v_rgbNW;\r\n       out vec2 v_rgbNE;\r\n       out vec2 v_rgbSW;\r\n       out vec2 v_rgbSE;\r\n       uniform vec4 texsize;\r\n       void main(void) {\r\n         gl_Position = vec4(aPos, 0.0, 1.0);\r\n\r\n         v_rgbM = aPos * halfmad + halfmad;\r\n         v_rgbNW = v_rgbM + (vec2(-1.0, -1.0) * texsize.zx);\r\n         v_rgbNE = v_rgbM + (vec2(1.0, -1.0) * texsize.zx);\r\n         v_rgbSW = v_rgbM + (vec2(-1.0, 1.0) * texsize.zx);\r\n         v_rgbSE = v_rgbM + (vec2(1.0, 1.0) * texsize.zx);\r\n       }`\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `#version 300 es\r\n       precision ${this.floatPrecision} float;\r\n       precision highp int;\r\n       precision mediump sampler2D;\r\n\r\n       in vec2 v_rgbM;\r\n       in vec2 v_rgbNW;\r\n       in vec2 v_rgbNE;\r\n       in vec2 v_rgbSW;\r\n       in vec2 v_rgbSE;\r\n       out vec4 fragColor;\r\n       uniform vec4 texsize;\r\n       uniform sampler2D uTexture;\r\n\r\n       #ifndef FXAA_REDUCE_MIN\r\n         #define FXAA_REDUCE_MIN   (1.0/ 128.0)\r\n       #endif\r\n       #ifndef FXAA_REDUCE_MUL\r\n         #define FXAA_REDUCE_MUL   (1.0 / 8.0)\r\n       #endif\r\n       #ifndef FXAA_SPAN_MAX\r\n         #define FXAA_SPAN_MAX     8.0\r\n       #endif\r\n\r\n       void main(void) {\r\n         vec4 color;\r\n         vec3 rgbNW = textureLod(uTexture, v_rgbNW, 0.0).xyz;\r\n         vec3 rgbNE = textureLod(uTexture, v_rgbNE, 0.0).xyz;\r\n         vec3 rgbSW = textureLod(uTexture, v_rgbSW, 0.0).xyz;\r\n         vec3 rgbSE = textureLod(uTexture, v_rgbSE, 0.0).xyz;\r\n         vec3 rgbM  = textureLod(uTexture, v_rgbM, 0.0).xyz;\r\n         vec3 luma = vec3(0.299, 0.587, 0.114);\r\n         float lumaNW = dot(rgbNW, luma);\r\n         float lumaNE = dot(rgbNE, luma);\r\n         float lumaSW = dot(rgbSW, luma);\r\n         float lumaSE = dot(rgbSE, luma);\r\n         float lumaM  = dot(rgbM,  luma);\r\n         float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\r\n         float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\r\n\r\n         mediump vec2 dir;\r\n         dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\r\n         dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\r\n\r\n         float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\r\n                               (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\r\n\r\n         float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\r\n         dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\r\n                   max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\r\n                   dir * rcpDirMin)) * texsize.zw;\r\n\r\n         vec3 rgbA = 0.5 * (\r\n             textureLod(uTexture, v_rgbM + dir * (1.0 / 3.0 - 0.5), 0.0).xyz +\r\n             textureLod(uTexture, v_rgbM + dir * (2.0 / 3.0 - 0.5), 0.0).xyz);\r\n         vec3 rgbB = rgbA * 0.5 + 0.25 * (\r\n             textureLod(uTexture, v_rgbM + dir * -0.5, 0.0).xyz +\r\n             textureLod(uTexture, v_rgbM + dir * 0.5, 0.0).xyz);\r\n\r\n         float lumaB = dot(rgbB, luma);\r\n         if ((lumaB < lumaMin) || (lumaB > lumaMax))\r\n           color = vec4(rgbA, 1.0);\r\n         else\r\n           color = vec4(rgbB, 1.0);\r\n\r\n         fragColor = color;\r\n       }`\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.positionLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aPos\"\r\n    );\r\n    this.textureLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"uTexture\"\r\n    );\r\n    this.texsizeLoc = this.gl.getUniformLocation(this.shaderProgram, \"texsize\");\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `#version 300 es\r\n       const vec2 halfmad = vec2(0.5);\r\n       in vec2 aPos;\r\n       out vec2 uv;\r\n       void main(void) {\r\n         gl_Position = vec4(aPos, 0.0, 1.0);\r\n         uv = aPos * halfmad + halfmad;\r\n       }`\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `#version 300 es\r\n       precision ${this.floatPrecision} float;\r\n       precision highp int;\r\n       precision mediump sampler2D;\r\n\r\n       in vec2 uv;\r\n       out vec4 fragColor;\r\n       uniform sampler2D uTexture;\r\n\r\n       void main(void) {\r\n         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);\r\n       }`\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.positionLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aPos\"\r\n    );\r\n    this.textureLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"uTexture\"\r\n    );\r\n  }\r\n\r\n  renderQuadTexture(texture) {\r\n    this.gl.useProgram(this.shaderProgram);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ARRAY_BUFFER,\r\n      this.positions,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.positionLocation,\r\n      2,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.positionLocation);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE0);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n\r\n    this.gl.uniform1i(this.textureLoc, 0);\r\n\r\n    if (this.useFXAA()) {\r\n      this.gl.uniform4fv(\r\n        this.texsizeLoc,\r\n        new Float32Array([\r\n          this.texsizeX,\r\n          this.texsizeY,\r\n          1.0 / this.texsizeX,\r\n          1.0 / this.texsizeY,\r\n        ])\r\n      );\r\n    }\r\n\r\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\r\n  }\r\n}\r\n","import ShaderUtils from \"./shaderUtils\";\r\n\r\nexport default class ResampleShader {\r\n  constructor(gl) {\r\n    this.gl = gl;\r\n\r\n    this.positions = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);\r\n\r\n    this.vertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `#version 300 es\r\n       const vec2 halfmad = vec2(0.5);\r\n       in vec2 aPos;\r\n       out vec2 uv;\r\n       void main(void) {\r\n         gl_Position = vec4(aPos, 0.0, 1.0);\r\n         uv = aPos * halfmad + halfmad;\r\n       }`\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `#version 300 es\r\n       precision ${this.floatPrecision} float;\r\n       precision highp int;\r\n       precision mediump sampler2D;\r\n\r\n       in vec2 uv;\r\n       out vec4 fragColor;\r\n       uniform sampler2D uTexture;\r\n\r\n       void main(void) {\r\n         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);\r\n       }`\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.positionLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aPos\"\r\n    );\r\n    this.textureLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"uTexture\"\r\n    );\r\n  }\r\n\r\n  renderQuadTexture(texture) {\r\n    this.gl.useProgram(this.shaderProgram);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ARRAY_BUFFER,\r\n      this.positions,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.positionLocation,\r\n      2,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.positionLocation);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE0);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n    this.gl.uniform1i(this.textureLoc, 0);\r\n\r\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\r\n  }\r\n}\r\n","import ShaderUtils from \"../shaderUtils\";\r\n\r\nexport default class BlurVertical {\r\n  constructor(gl, blurLevel) {\r\n    this.gl = gl;\r\n    this.blurLevel = blurLevel;\r\n\r\n    const w = [4.0, 3.8, 3.5, 2.9, 1.9, 1.2, 0.7, 0.3];\r\n    const w1V = w[0] + w[1] + w[2] + w[3];\r\n    const w2V = w[4] + w[5] + w[6] + w[7];\r\n    const d1V = 0 + 2 * ((w[2] + w[3]) / w1V);\r\n    const d2V = 2 + 2 * ((w[6] + w[7]) / w2V);\r\n\r\n    this.wds = new Float32Array([w1V, w2V, d1V, d2V]);\r\n    this.wDiv = 1.0 / ((w1V + w2V) * 2);\r\n\r\n    this.positions = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);\r\n\r\n    this.vertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      const vec2 halfmad = vec2(0.5);\r\n      in vec2 aPos;\r\n      out vec2 uv;\r\n      void main(void) {\r\n        gl_Position = vec4(aPos, 0.0, 1.0);\r\n        uv = aPos * halfmad + halfmad;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `#version 300 es\r\n       precision ${this.floatPrecision} float;\r\n       precision highp int;\r\n       precision mediump sampler2D;\r\n\r\n       in vec2 uv;\r\n       out vec4 fragColor;\r\n       uniform sampler2D uTexture;\r\n       uniform vec4 texsize;\r\n       uniform float ed1;\r\n       uniform float ed2;\r\n       uniform float ed3;\r\n       uniform vec4 wds;\r\n       uniform float wdiv;\r\n\r\n       void main(void) {\r\n         float w1 = wds[0];\r\n         float w2 = wds[1];\r\n         float d1 = wds[2];\r\n         float d2 = wds[3];\r\n\r\n         vec2 uv2 = uv.xy;\r\n\r\n         vec3 blur =\r\n           ( texture(uTexture, uv2 + vec2(0.0, d1 * texsize.w) ).xyz\r\n           + texture(uTexture, uv2 + vec2(0.0,-d1 * texsize.w) ).xyz) * w1 +\r\n           ( texture(uTexture, uv2 + vec2(0.0, d2 * texsize.w) ).xyz\r\n           + texture(uTexture, uv2 + vec2(0.0,-d2 * texsize.w) ).xyz) * w2;\r\n\r\n         blur.xyz *= wdiv;\r\n\r\n         float t = min(min(uv.x, uv.y), 1.0 - max(uv.x, uv.y));\r\n         t = sqrt(t);\r\n         t = ed1 + ed2 * clamp(t * ed3, 0.0, 1.0);\r\n         blur.xyz *= t;\r\n\r\n         fragColor = vec4(blur, 1.0);\r\n       }`\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.positionLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aPos\"\r\n    );\r\n    this.textureLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"uTexture\"\r\n    );\r\n    this.texsizeLocation = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize\"\r\n    );\r\n    this.ed1Loc = this.gl.getUniformLocation(this.shaderProgram, \"ed1\");\r\n    this.ed2Loc = this.gl.getUniformLocation(this.shaderProgram, \"ed2\");\r\n    this.ed3Loc = this.gl.getUniformLocation(this.shaderProgram, \"ed3\");\r\n    this.wdsLocation = this.gl.getUniformLocation(this.shaderProgram, \"wds\");\r\n    this.wdivLoc = this.gl.getUniformLocation(this.shaderProgram, \"wdiv\");\r\n  }\r\n\r\n  renderQuadTexture(texture, mdVSFrame, srcTexsize) {\r\n    this.gl.useProgram(this.shaderProgram);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ARRAY_BUFFER,\r\n      this.positions,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.positionLocation,\r\n      2,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.positionLocation);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE0);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n\r\n    this.gl.uniform1i(this.textureLoc, 0);\r\n\r\n    const b1ed = this.blurLevel === 0 ? mdVSFrame.b1ed : 0.0;\r\n\r\n    this.gl.uniform4fv(this.texsizeLocation, [\r\n      srcTexsize[0],\r\n      srcTexsize[1],\r\n      1.0 / srcTexsize[0],\r\n      1.0 / srcTexsize[1],\r\n    ]);\r\n    this.gl.uniform1f(this.ed1Loc, 1.0 - b1ed);\r\n    this.gl.uniform1f(this.ed2Loc, b1ed);\r\n    this.gl.uniform1f(this.ed3Loc, 5.0);\r\n    this.gl.uniform4fv(this.wdsLocation, this.wds);\r\n    this.gl.uniform1f(this.wdivLoc, this.wDiv);\r\n\r\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\r\n  }\r\n}\r\n","import ShaderUtils from \"../shaderUtils\";\r\n\r\nexport default class BlurHorizontal {\r\n  constructor(gl, blurLevel) {\r\n    this.gl = gl;\r\n    this.blurLevel = blurLevel;\r\n\r\n    const w = [4.0, 3.8, 3.5, 2.9, 1.9, 1.2, 0.7, 0.3];\r\n    const w1H = w[0] + w[1];\r\n    const w2H = w[2] + w[3];\r\n    const w3H = w[4] + w[5];\r\n    const w4H = w[6] + w[7];\r\n    const d1H = 0 + (2 * w[1]) / w1H;\r\n    const d2H = 2 + (2 * w[3]) / w2H;\r\n    const d3H = 4 + (2 * w[5]) / w3H;\r\n    const d4H = 6 + (2 * w[7]) / w4H;\r\n\r\n    this.ws = new Float32Array([w1H, w2H, w3H, w4H]);\r\n    this.ds = new Float32Array([d1H, d2H, d3H, d4H]);\r\n    this.wDiv = 0.5 / (w1H + w2H + w3H + w4H);\r\n\r\n    this.positions = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);\r\n\r\n    this.vertexBuf = this.gl.createBuffer();\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `\r\n      #version 300 es\r\n      const vec2 halfmad = vec2(0.5);\r\n      in vec2 aPos;\r\n      out vec2 uv;\r\n      void main(void) {\r\n        gl_Position = vec4(aPos, 0.0, 1.0);\r\n        uv = aPos * halfmad + halfmad;\r\n      }\r\n      `.trim()\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `#version 300 es\r\n       precision ${this.floatPrecision} float;\r\n       precision highp int;\r\n       precision mediump sampler2D;\r\n\r\n       in vec2 uv;\r\n       out vec4 fragColor;\r\n       uniform sampler2D uTexture;\r\n       uniform vec4 texsize;\r\n       uniform float scale;\r\n       uniform float bias;\r\n       uniform vec4 ws;\r\n       uniform vec4 ds;\r\n       uniform float wdiv;\r\n\r\n       void main(void) {\r\n         float w1 = ws[0];\r\n         float w2 = ws[1];\r\n         float w3 = ws[2];\r\n         float w4 = ws[3];\r\n         float d1 = ds[0];\r\n         float d2 = ds[1];\r\n         float d3 = ds[2];\r\n         float d4 = ds[3];\r\n\r\n         vec2 uv2 = uv.xy;\r\n\r\n         vec3 blur =\r\n           ( texture(uTexture, uv2 + vec2( d1 * texsize.z,0.0) ).xyz\r\n           + texture(uTexture, uv2 + vec2(-d1 * texsize.z,0.0) ).xyz) * w1 +\r\n           ( texture(uTexture, uv2 + vec2( d2 * texsize.z,0.0) ).xyz\r\n           + texture(uTexture, uv2 + vec2(-d2 * texsize.z,0.0) ).xyz) * w2 +\r\n           ( texture(uTexture, uv2 + vec2( d3 * texsize.z,0.0) ).xyz\r\n           + texture(uTexture, uv2 + vec2(-d3 * texsize.z,0.0) ).xyz) * w3 +\r\n           ( texture(uTexture, uv2 + vec2( d4 * texsize.z,0.0) ).xyz\r\n           + texture(uTexture, uv2 + vec2(-d4 * texsize.z,0.0) ).xyz) * w4;\r\n\r\n         blur.xyz *= wdiv;\r\n         blur.xyz = blur.xyz * scale + bias;\r\n\r\n         fragColor = vec4(blur, 1.0);\r\n       }`\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.positionLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aPos\"\r\n    );\r\n    this.textureLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"uTexture\"\r\n    );\r\n    this.texsizeLocation = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"texsize\"\r\n    );\r\n    this.scaleLoc = this.gl.getUniformLocation(this.shaderProgram, \"scale\");\r\n    this.biasLoc = this.gl.getUniformLocation(this.shaderProgram, \"bias\");\r\n    this.wsLoc = this.gl.getUniformLocation(this.shaderProgram, \"ws\");\r\n    this.dsLocation = this.gl.getUniformLocation(this.shaderProgram, \"ds\");\r\n    this.wdivLoc = this.gl.getUniformLocation(this.shaderProgram, \"wdiv\");\r\n  }\r\n\r\n  getScaleAndBias(blurMins, blurMaxs) {\r\n    const scale = [1, 1, 1];\r\n    const bias = [0, 0, 0];\r\n\r\n    let tempMin;\r\n    let tempMax;\r\n    scale[0] = 1.0 / (blurMaxs[0] - blurMins[0]);\r\n    bias[0] = -blurMins[0] * scale[0];\r\n    tempMin = (blurMins[1] - blurMins[0]) / (blurMaxs[0] - blurMins[0]);\r\n    tempMax = (blurMaxs[1] - blurMins[0]) / (blurMaxs[0] - blurMins[0]);\r\n    scale[1] = 1.0 / (tempMax - tempMin);\r\n    bias[1] = -tempMin * scale[1];\r\n    tempMin = (blurMins[2] - blurMins[1]) / (blurMaxs[1] - blurMins[1]);\r\n    tempMax = (blurMaxs[2] - blurMins[1]) / (blurMaxs[1] - blurMins[1]);\r\n    scale[2] = 1.0 / (tempMax - tempMin);\r\n    bias[2] = -tempMin * scale[2];\r\n\r\n    return {\r\n      scale: scale[this.blurLevel],\r\n      bias: bias[this.blurLevel],\r\n    };\r\n  }\r\n\r\n  renderQuadTexture(texture, mdVSFrame, blurMins, blurMaxs, srcTexsize) {\r\n    this.gl.useProgram(this.shaderProgram);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ARRAY_BUFFER,\r\n      this.positions,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.positionLocation,\r\n      2,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.positionLocation);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE0);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n\r\n    this.gl.uniform1i(this.textureLoc, 0);\r\n\r\n    const { scale, bias } = this.getScaleAndBias(blurMins, blurMaxs);\r\n\r\n    this.gl.uniform4fv(this.texsizeLocation, [\r\n      srcTexsize[0],\r\n      srcTexsize[1],\r\n      1.0 / srcTexsize[0],\r\n      1.0 / srcTexsize[1],\r\n    ]);\r\n    this.gl.uniform1f(this.scaleLoc, scale);\r\n    this.gl.uniform1f(this.biasLoc, bias);\r\n    this.gl.uniform4fv(this.wsLoc, this.ws);\r\n    this.gl.uniform4fv(this.dsLocation, this.ds);\r\n    this.gl.uniform1f(this.wdivLoc, this.wDiv);\r\n\r\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);\r\n  }\r\n}\r\n","import BlurVertical from \"./blurVertical\";\r\nimport BlurHorizontal from \"./blurHorizontal\";\r\n\r\nexport default class BlurShader {\r\n  constructor(blurLevel, blurRatios, gl, opts = {}) {\r\n    this.blurLevel = blurLevel;\r\n    this.blurRatios = blurRatios;\r\n    this.gl = gl;\r\n\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n\r\n    this.anisoExt =\r\n      this.gl.getExtension(\"EXT_texture_filter_anisotropic\") ||\r\n      this.gl.getExtension(\"MOZ_EXT_texture_filter_anisotropic\") ||\r\n      this.gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\");\r\n\r\n    this.blurHorizontalFrameBuffer = this.gl.createFramebuffer();\r\n    this.blurVerticalFrameBuffer = this.gl.createFramebuffer();\r\n\r\n    this.blurHorizontalTexture = this.gl.createTexture();\r\n    this.blurVerticalTexture = this.gl.createTexture();\r\n\r\n    this.setupFrameBufferTextures();\r\n\r\n    this.blurHorizontal = new BlurHorizontal(gl, this.blurLevel, opts);\r\n    this.blurVertical = new BlurVertical(gl, this.blurLevel, opts);\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n\r\n    this.setupFrameBufferTextures();\r\n  }\r\n\r\n  getTextureSize(sizeRatio) {\r\n    let sizeX = Math.max(this.texsizeX * sizeRatio, 16);\r\n    sizeX = Math.floor((sizeX + 3) / 16) * 16;\r\n    let sizeY = Math.max(this.texsizeY * sizeRatio, 16);\r\n    sizeY = Math.floor((sizeY + 3) / 4) * 4;\r\n    return [sizeX, sizeY];\r\n  }\r\n\r\n  setupFrameBufferTextures() {\r\n    const srcBlurRatios =\r\n      this.blurLevel > 0 ? this.blurRatios[this.blurLevel - 1] : [1, 1];\r\n    const dstBlurRatios = this.blurRatios[this.blurLevel];\r\n    const srcTexsizeHorizontal = this.getTextureSize(srcBlurRatios[1]);\r\n    const dstTexsizeHorizontal = this.getTextureSize(dstBlurRatios[0]);\r\n    this.bindFrameBufferTexture(\r\n      this.blurHorizontalFrameBuffer,\r\n      this.blurHorizontalTexture,\r\n      dstTexsizeHorizontal\r\n    );\r\n\r\n    const srcTexsizeVertical = dstTexsizeHorizontal;\r\n    const dstTexsizeVertical = this.getTextureSize(dstBlurRatios[1]);\r\n    this.bindFrameBufferTexture(\r\n      this.blurVerticalFrameBuffer,\r\n      this.blurVerticalTexture,\r\n      dstTexsizeVertical\r\n    );\r\n\r\n    this.horizontalTexsizes = [srcTexsizeHorizontal, dstTexsizeHorizontal];\r\n    this.verticalTexsizes = [srcTexsizeVertical, dstTexsizeVertical];\r\n  }\r\n\r\n  bindFrambufferAndSetViewport(fb, texsize) {\r\n    this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, fb);\r\n    this.gl.viewport(0, 0, texsize[0], texsize[1]);\r\n  }\r\n\r\n  bindFrameBufferTexture(targetFrameBuffer, targetTexture, texsize) {\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, targetTexture);\r\n\r\n    this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT, 1);\r\n    this.gl.texImage2D(\r\n      this.gl.TEXTURE_2D,\r\n      0,\r\n      this.gl.RGBA,\r\n      texsize[0],\r\n      texsize[1],\r\n      0,\r\n      this.gl.RGBA,\r\n      this.gl.UNSIGNED_BYTE,\r\n      new Uint8Array(texsize[0] * texsize[1] * 4)\r\n    );\r\n\r\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_S,\r\n      this.gl.CLAMP_TO_EDGE\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_T,\r\n      this.gl.CLAMP_TO_EDGE\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MIN_FILTER,\r\n      this.gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MAG_FILTER,\r\n      this.gl.LINEAR\r\n    );\r\n    if (this.anisoExt) {\r\n      const max = this.gl.getParameter(\r\n        this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT\r\n      );\r\n      this.gl.texParameterf(\r\n        this.gl.TEXTURE_2D,\r\n        this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,\r\n        max\r\n      );\r\n    }\r\n\r\n    this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, targetFrameBuffer);\r\n    this.gl.framebufferTexture2D(\r\n      this.gl.FRAMEBUFFER,\r\n      this.gl.COLOR_ATTACHMENT0,\r\n      this.gl.TEXTURE_2D,\r\n      targetTexture,\r\n      0\r\n    );\r\n  }\r\n\r\n  renderBlurTexture(prevTexture, mdVSFrame, blurMins, blurMaxs) {\r\n    this.bindFrambufferAndSetViewport(\r\n      this.blurHorizontalFrameBuffer,\r\n      this.horizontalTexsizes[1]\r\n    );\r\n    this.blurHorizontal.renderQuadTexture(\r\n      prevTexture,\r\n      mdVSFrame,\r\n      blurMins,\r\n      blurMaxs,\r\n      this.horizontalTexsizes[0]\r\n    );\r\n\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.blurHorizontalTexture);\r\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n    this.bindFrambufferAndSetViewport(\r\n      this.blurVerticalFrameBuffer,\r\n      this.verticalTexsizes[1]\r\n    );\r\n    this.blurVertical.renderQuadTexture(\r\n      this.blurHorizontalTexture,\r\n      mdVSFrame,\r\n      this.verticalTexsizes[0]\r\n    );\r\n\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.blurVerticalTexture);\r\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n  }\r\n}\r\n","import { getRNG } from '../utils/rngContext';\r\n\r\nexport default class Noise {\r\n  constructor(gl) {\r\n    this.gl = gl;\r\n    this.randomFn = getRNG().random;\r\n\r\n    this.anisoExt =\r\n      this.gl.getExtension(\"EXT_texture_filter_anisotropic\") ||\r\n      this.gl.getExtension(\"MOZ_EXT_texture_filter_anisotropic\") ||\r\n      this.gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\");\r\n\r\n    this.noiseTexLQ = this.gl.createTexture();\r\n    this.noiseTexLQLite = this.gl.createTexture();\r\n    this.noiseTexMQ = this.gl.createTexture();\r\n    this.noiseTexHQ = this.gl.createTexture();\r\n\r\n    this.noiseTexVolLQ = this.gl.createTexture();\r\n    this.noiseTexVolHQ = this.gl.createTexture();\r\n\r\n    this.nTexArrLQ = Noise.createNoiseTex(256, 1, this.randomFn);\r\n    this.nTexArrLQLite = Noise.createNoiseTex(32, 1, this.randomFn);\r\n    this.nTexArrMQ = Noise.createNoiseTex(256, 4, this.randomFn);\r\n    this.nTexArrHQ = Noise.createNoiseTex(256, 8, this.randomFn);\r\n\r\n    this.nTexArrVolLQ = Noise.createNoiseVolTex(32, 1, this.randomFn);\r\n    this.nTexArrVolHQ = Noise.createNoiseVolTex(32, 4, this.randomFn);\r\n\r\n    this.bindTexture(this.noiseTexLQ, this.nTexArrLQ, 256, 256);\r\n    this.bindTexture(this.noiseTexLQLite, this.nTexArrLQLite, 32, 32);\r\n    this.bindTexture(this.noiseTexMQ, this.nTexArrMQ, 256, 256);\r\n    this.bindTexture(this.noiseTexHQ, this.nTexArrHQ, 256, 256);\r\n\r\n    this.bindTexture3D(this.noiseTexVolLQ, this.nTexArrVolLQ, 32, 32, 32);\r\n    this.bindTexture3D(this.noiseTexVolHQ, this.nTexArrVolHQ, 32, 32, 32);\r\n\r\n    this.noiseTexPointLQ = this.gl.createSampler();\r\n    gl.samplerParameteri(\r\n      this.noiseTexPointLQ,\r\n      gl.TEXTURE_MIN_FILTER,\r\n      gl.NEAREST_MIPMAP_NEAREST\r\n    );\r\n    gl.samplerParameteri(\r\n      this.noiseTexPointLQ,\r\n      gl.TEXTURE_MAG_FILTER,\r\n      gl.NEAREST\r\n    );\r\n    gl.samplerParameteri(this.noiseTexPointLQ, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n    gl.samplerParameteri(this.noiseTexPointLQ, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n  }\r\n\r\n  bindTexture(texture, data, width, height) {\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n\r\n    this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT, 1);\r\n    this.gl.texImage2D(\r\n      this.gl.TEXTURE_2D,\r\n      0,\r\n      this.gl.RGBA,\r\n      width,\r\n      height,\r\n      0,\r\n      this.gl.RGBA,\r\n      this.gl.UNSIGNED_BYTE,\r\n      data\r\n    );\r\n\r\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_S,\r\n      this.gl.REPEAT\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_T,\r\n      this.gl.REPEAT\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MIN_FILTER,\r\n      this.gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MAG_FILTER,\r\n      this.gl.LINEAR\r\n    );\r\n    if (this.anisoExt) {\r\n      const max = this.gl.getParameter(\r\n        this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT\r\n      );\r\n      this.gl.texParameterf(\r\n        this.gl.TEXTURE_2D,\r\n        this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,\r\n        max\r\n      );\r\n    }\r\n  }\r\n\r\n  bindTexture3D(texture, data, width, height, depth) {\r\n    this.gl.bindTexture(this.gl.TEXTURE_3D, texture);\r\n\r\n    this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT, 1);\r\n    this.gl.texImage3D(\r\n      this.gl.TEXTURE_3D,\r\n      0,\r\n      this.gl.RGBA,\r\n      width,\r\n      height,\r\n      depth,\r\n      0,\r\n      this.gl.RGBA,\r\n      this.gl.UNSIGNED_BYTE,\r\n      data\r\n    );\r\n\r\n    this.gl.generateMipmap(this.gl.TEXTURE_3D);\r\n\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_3D,\r\n      this.gl.TEXTURE_WRAP_S,\r\n      this.gl.REPEAT\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_3D,\r\n      this.gl.TEXTURE_WRAP_T,\r\n      this.gl.REPEAT\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_3D,\r\n      this.gl.TEXTURE_WRAP_R,\r\n      this.gl.REPEAT\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_3D,\r\n      this.gl.TEXTURE_MIN_FILTER,\r\n      this.gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_3D,\r\n      this.gl.TEXTURE_MAG_FILTER,\r\n      this.gl.LINEAR\r\n    );\r\n    if (this.anisoExt) {\r\n      const max = this.gl.getParameter(\r\n        this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT\r\n      );\r\n      this.gl.texParameterf(\r\n        this.gl.TEXTURE_3D,\r\n        this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,\r\n        max\r\n      );\r\n    }\r\n  }\r\n\r\n  static fCubicInterpolate(y0, y1, y2, y3, t) {\r\n    const t2 = t * t;\r\n    const t3 = t * t2;\r\n    const a0 = y3 - y2 - y0 + y1;\r\n    const a1 = y0 - y1 - a0;\r\n    const a2 = y2 - y0;\r\n    const a3 = y1;\r\n\r\n    return a0 * t3 + a1 * t2 + a2 * t + a3;\r\n  }\r\n\r\n  static dwCubicInterpolate(y0, y1, y2, y3, t) {\r\n    const ret = [];\r\n    for (let i = 0; i < 4; i++) {\r\n      let f = Noise.fCubicInterpolate(\r\n        y0[i] / 255.0,\r\n        y1[i] / 255.0,\r\n        y2[i] / 255.0,\r\n        y3[i] / 255.0,\r\n        t\r\n      );\r\n      f = Math.clamp(f, 0, 1);\r\n      ret[i] = f * 255;\r\n    }\r\n\r\n    return ret;\r\n  }\r\n\r\n  static createNoiseVolTex(noiseSize, zoom, randomFn) {\r\n    const nsize = noiseSize * noiseSize * noiseSize;\r\n    const texArr = new Uint8Array(nsize * 4);\r\n    const texRange = zoom > 1 ? 216 : 256;\r\n    const halfTexRange = texRange * 0.5;\r\n    for (let i = 0; i < nsize; i++) {\r\n      texArr[i * 4 + 0] = Math.floor(randomFn() * texRange + halfTexRange);\r\n      texArr[i * 4 + 1] = Math.floor(randomFn() * texRange + halfTexRange);\r\n      texArr[i * 4 + 2] = Math.floor(randomFn() * texRange + halfTexRange);\r\n      texArr[i * 4 + 3] = Math.floor(randomFn() * texRange + halfTexRange);\r\n    }\r\n\r\n    const wordsPerSlice = noiseSize * noiseSize;\r\n    const wordsPerLine = noiseSize;\r\n    if (zoom > 1) {\r\n      for (let z = 0; z < noiseSize; z += zoom) {\r\n        for (let y = 0; y < noiseSize; y += zoom) {\r\n          for (let x = 0; x < noiseSize; x++) {\r\n            if (x % zoom !== 0) {\r\n              const baseX = Math.floor(x / zoom) * zoom + noiseSize;\r\n              const baseY = z * wordsPerSlice + y * wordsPerLine;\r\n\r\n              const y0 = [];\r\n              const y1 = [];\r\n              const y2 = [];\r\n              const y3 = [];\r\n              for (let i = 0; i < 4; i++) {\r\n                y0[i] =\r\n                  texArr[baseY * 4 + ((baseX - zoom) % noiseSize) * 4 + i];\r\n                y1[i] = texArr[baseY * 4 + (baseX % noiseSize) * 4 + i];\r\n                y2[i] =\r\n                  texArr[baseY * 4 + ((baseX + zoom) % noiseSize) * 4 + i];\r\n                y3[i] =\r\n                  texArr[baseY * 4 + ((baseX + zoom * 2) % noiseSize) * 4 + i];\r\n              }\r\n\r\n              const t = (x % zoom) / zoom;\r\n              const result = Noise.dwCubicInterpolate(y0, y1, y2, y3, t);\r\n\r\n              for (let i = 0; i < 4; i++) {\r\n                const offset = x * 4 + i;\r\n                texArr[z * wordsPerSlice * 4 + y * wordsPerLine * 4 + offset] =\r\n                  result[i];\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      for (let z = 0; z < noiseSize; z += zoom) {\r\n        for (let x = 0; x < noiseSize; x++) {\r\n          for (let y = 0; y < noiseSize; y++) {\r\n            if (y % zoom !== 0) {\r\n              const baseY = Math.floor(y / zoom) * zoom + noiseSize;\r\n              const baseZ = z * wordsPerSlice;\r\n\r\n              const y0 = [];\r\n              const y1 = [];\r\n              const y2 = [];\r\n              const y3 = [];\r\n              for (let i = 0; i < 4; i++) {\r\n                const offset = x * 4 + baseZ * 4 + i;\r\n                y0[i] =\r\n                  texArr[\r\n                    ((baseY - zoom) % noiseSize) * wordsPerLine * 4 + offset\r\n                  ];\r\n                y1[i] = texArr[(baseY % noiseSize) * wordsPerLine * 4 + offset];\r\n                y2[i] =\r\n                  texArr[\r\n                    ((baseY + zoom) % noiseSize) * wordsPerLine * 4 + offset\r\n                  ];\r\n                y3[i] =\r\n                  texArr[\r\n                    ((baseY + zoom * 2) % noiseSize) * wordsPerLine * 4 + offset\r\n                  ];\r\n              }\r\n\r\n              const t = (y % zoom) / zoom;\r\n              const result = Noise.dwCubicInterpolate(y0, y1, y2, y3, t);\r\n\r\n              for (let i = 0; i < 4; i++) {\r\n                const offset = x * 4 + baseZ * 4 + i;\r\n                texArr[y * wordsPerLine * 4 + offset] = result[i];\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      for (let x = 0; x < noiseSize; x++) {\r\n        for (let y = 0; y < noiseSize; y++) {\r\n          for (let z = 0; z < noiseSize; z++) {\r\n            if (z % zoom !== 0) {\r\n              const baseY = y * wordsPerLine;\r\n              const baseZ = Math.floor(z / zoom) * zoom + noiseSize;\r\n\r\n              const y0 = [];\r\n              const y1 = [];\r\n              const y2 = [];\r\n              const y3 = [];\r\n              for (let i = 0; i < 4; i++) {\r\n                const offset = x * 4 + baseY * 4 + i;\r\n                y0[i] =\r\n                  texArr[\r\n                    ((baseZ - zoom) % noiseSize) * wordsPerSlice * 4 + offset\r\n                  ];\r\n                y1[i] =\r\n                  texArr[(baseZ % noiseSize) * wordsPerSlice * 4 + offset];\r\n                y2[i] =\r\n                  texArr[\r\n                    ((baseZ + zoom) % noiseSize) * wordsPerSlice * 4 + offset\r\n                  ];\r\n                y3[i] =\r\n                  texArr[\r\n                    ((baseZ + zoom * 2) % noiseSize) * wordsPerSlice * 4 +\r\n                      offset\r\n                  ];\r\n              }\r\n\r\n              const t = (y % zoom) / zoom;\r\n              const result = Noise.dwCubicInterpolate(y0, y1, y2, y3, t);\r\n\r\n              for (let i = 0; i < 4; i++) {\r\n                const offset = x * 4 + baseY * 4 + i;\r\n                texArr[z * wordsPerSlice * 4 + offset] = result[i];\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return texArr;\r\n  }\r\n\r\n  static createNoiseTex(noiseSize, zoom, randomFn) {\r\n    const nsize = noiseSize * noiseSize;\r\n    const texArr = new Uint8Array(nsize * 4);\r\n    const texRange = zoom > 1 ? 216 : 256;\r\n    const halfTexRange = texRange * 0.5;\r\n    for (let i = 0; i < nsize; i++) {\r\n      texArr[i * 4 + 0] = Math.floor(randomFn() * texRange + halfTexRange);\r\n      texArr[i * 4 + 1] = Math.floor(randomFn() * texRange + halfTexRange);\r\n      texArr[i * 4 + 2] = Math.floor(randomFn() * texRange + halfTexRange);\r\n      texArr[i * 4 + 3] = Math.floor(randomFn() * texRange + halfTexRange);\r\n    }\r\n\r\n    if (zoom > 1) {\r\n      for (let y = 0; y < noiseSize; y += zoom) {\r\n        for (let x = 0; x < noiseSize; x++) {\r\n          if (x % zoom !== 0) {\r\n            const baseX = Math.floor(x / zoom) * zoom + noiseSize;\r\n            const baseY = y * noiseSize;\r\n\r\n            const y0 = [];\r\n            const y1 = [];\r\n            const y2 = [];\r\n            const y3 = [];\r\n            for (let z = 0; z < 4; z++) {\r\n              y0[z] = texArr[baseY * 4 + ((baseX - zoom) % noiseSize) * 4 + z];\r\n              y1[z] = texArr[baseY * 4 + (baseX % noiseSize) * 4 + z];\r\n              y2[z] = texArr[baseY * 4 + ((baseX + zoom) % noiseSize) * 4 + z];\r\n              y3[z] =\r\n                texArr[baseY * 4 + ((baseX + zoom * 2) % noiseSize) * 4 + z];\r\n            }\r\n\r\n            const t = (x % zoom) / zoom;\r\n            const result = Noise.dwCubicInterpolate(y0, y1, y2, y3, t);\r\n\r\n            for (let z = 0; z < 4; z++) {\r\n              texArr[y * noiseSize * 4 + x * 4 + z] = result[z];\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      for (let x = 0; x < noiseSize; x++) {\r\n        for (let y = 0; y < noiseSize; y++) {\r\n          if (y % zoom !== 0) {\r\n            const baseY = Math.floor(y / zoom) * zoom + noiseSize;\r\n\r\n            const y0 = [];\r\n            const y1 = [];\r\n            const y2 = [];\r\n            const y3 = [];\r\n            for (let z = 0; z < 4; z++) {\r\n              y0[z] =\r\n                texArr[\r\n                  ((baseY - zoom) % noiseSize) * noiseSize * 4 + x * 4 + z\r\n                ];\r\n              y1[z] = texArr[(baseY % noiseSize) * noiseSize * 4 + x * 4 + z];\r\n              y2[z] =\r\n                texArr[\r\n                  ((baseY + zoom) % noiseSize) * noiseSize * 4 + x * 4 + z\r\n                ];\r\n              y3[z] =\r\n                texArr[\r\n                  ((baseY + zoom * 2) % noiseSize) * noiseSize * 4 + x * 4 + z\r\n                ];\r\n            }\r\n\r\n            const t = (y % zoom) / zoom;\r\n            const result = Noise.dwCubicInterpolate(y0, y1, y2, y3, t);\r\n\r\n            for (let z = 0; z < 4; z++) {\r\n              texArr[y * noiseSize * 4 + x * 4 + z] = result[z];\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return texArr;\r\n  }\r\n}\r\n","export default class ImageTextures {\r\n  constructor(gl) {\r\n    this.gl = gl;\r\n\r\n    this.anisoExt =\r\n      this.gl.getExtension(\"EXT_texture_filter_anisotropic\") ||\r\n      this.gl.getExtension(\"MOZ_EXT_texture_filter_anisotropic\") ||\r\n      this.gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\");\r\n\r\n    this.samplers = {};\r\n\r\n    /* eslint-disable max-len */\r\n    this.clouds2Image = new Image();\r\n    this.clouds2Image.onload = () => {\r\n      this.samplers.clouds2 = this.gl.createTexture();\r\n      this.bindTexture(this.samplers.clouds2, this.clouds2Image, 128, 128);\r\n    };\r\n    this.clouds2Image.src =\r\n      \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4RP+RXhpZgAASUkqAAgAAAAJAA8BAgAGAAAAegAAABABAgAVAAAAgAAAABIBAwABAAAAAQAAABoBBQABAAAAoAAAABsBBQABAAAAqAAAACgBAwABAAAAAgAAADIBAgAUAAAAsAAAABMCAwABAAAAAQAAAGmHBAABAAAAxAAAAGYFAABDYW5vbgBDYW5vbiBQb3dlclNob3QgUzExMAAAAAAAAAAAAAAAAEgAAAABAAAASAAAAAEAAAAyMDAyOjAxOjE5IDE3OjMzOjIwABsAmoIFAAEAAABWAwAAnYIFAAEAAABeAwAAAJAHAAQAAAAwMjEwA5ACABQAAAAOAgAABJACABQAAAAiAgAAAZEHAAQAAAABAgMAApEFAAEAAAA+AwAAAZIKAAEAAABGAwAAApIFAAEAAABOAwAABJIKAAEAAABmAwAABZIFAAEAAABuAwAABpIFAAEAAAB2AwAAB5IDAAEAAAAFAAAACZIDAAEAAAAAAAAACpIFAAEAAAB+AwAAfJIHAJoBAACGAwAAhpIHAAgBAAA2AgAAAKAHAAQAAAAwMTAwAaADAAEAAAABAAAAAqAEAAEAAACAAAAAA6AEAAEAAACAAAAABaAEAAEAAAAwBQAADqIFAAEAAAAgBQAAD6IFAAEAAAAoBQAAEKIDAAEAAAACAAAAF6IDAAEAAAACAAAAAKMHAAEAAAADAAAAAAAAADIwMDI6MDE6MTkgMTc6MzM6MjAAMjAwMjowMToxOSAxNzozMzoyMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAACoBAAAgAAAAuAAAACAAAAABAAAAgAIAAEgAAAAKAAAA/////wMAAACK+AIAAAABAL8BAADoAwAArQAAACAAAAAMAAEAAwAmAAAAHAQAAAIAAwAEAAAAaAQAAAMAAwAEAAAAcAQAAAQAAwAaAAAAeAQAAAAAAwAGAAAArAQAAAAAAwAEAAAAuAQAAAYAAgAgAAAAwAQAAAcAAgAYAAAA4AQAAAgABAABAAAAkc4UAAkAAgAgAAAA+AQAABAABAABAAAAAAAJAQ0AAwAEAAAAGAUAAAAAAABMAAIAAAAFAAAAAAAAAAQAAAABAAAAAQAAAAAAAAAAAAAAAwABAAEwAAD/////WgGtACAAYgC4AP//AAAAAAAAAAAAAP//SABABkAGAgCtANMAngAAAAAAAAAAADQAAACPAEYBtQAqAfT/AgABAAEAAAAAAAAAAAAEMAAAAAAAAAAAvwEAALgAJwEAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAElNRzpQb3dlclNob3QgUzExMCBKUEVHAAAAAAAAAAAARmlybXdhcmUgVmVyc2lvbiAxLjAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAMgAuQC5AABqGADOAAAAgE8SAJsAAAAEAAEAAgAEAAAAUjk4AAIABwAEAAAAMDEwMAEQAwABAAAAQAYAAAIQAwABAAAAsAQAAAAAAAAGAAMBAwABAAAABgAAABoBBQABAAAAtAUAABsBBQABAAAAvAUAACgBAwABAAAAAgAAAAECBAABAAAA9AUAAAICBAABAAAAuA0AAAAAAAC0AAAAAQAAALQAAAABAAAAaM5qp6ps7vXbS52etpVdo/tuYZ2wtrDFXnrx1HK+braKpineV1+3VFWVteo72Poc/9j/2wCEAAkGBggGBQkIBwgKCQkLDRYPDQwMDRwTFRAWIR0jIiEcIB8kKTQsJCcxJx4fLT0tMTY3Ojo6Iio/RD44QjM3OTYBCQkJDAoMFAwMFA8KCgoPGhoKChoaTxoaGhoaT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT//AABEIAHgAoAMBIQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AOdCcU4R11HMSLHTxFTAXy6PLxQIUJTglIDo9KtbWzjScNvnK/gtao1FkycjaO1ebWvOWvyR307RjZfM5zXoraacTW3DtkyD1PrWathui39q66cmoK+60OacU5O2xA8ZQlT2qBkrdfmYsiZMUwpxVCImXNRMntTERlaaRg0CN5Y8iniOszUlWOniOgQhj5o2UwDZS7KBFmAuoCnIAq69wUjIHPHWuaok5HTBtIqrbzXCMyAEDqCarPvGV6Yqlbb+Xch337kBTOd1RNHxgCrc+xKgNWAPxyD2qCWMAY7g81UJ83yJlGxCy4qJlzWqMyMpTClAjoxCUbDCniP2rK5qOVKkEdMA8ummPmgA2Vd0m1S4vMTIXjUEtjtUzdotrdLQcFeSXQfcQqJ2y/GaZL5fkhE5Y9TXPFt2Zu7K6IUinVWVW+XvjvSNCsceScsa0k1067kRT69NisY8mnC2YoWA4qL2KtcglyjcVVdd78daqnK3zImr/IheFgTkdKiZK6ou6MJKxGyUwrTJOxmjaS2WYqwjLHbnp9KBaeeB5MbZxzXLGVlfotzpcdbdXsQiKniOtSBfLppjoTE0NMdPiYxElSRmiSurAnZiSMTzmmKSDmpUdCpS1NvT0TUoHEjpGQcYC8n3qM6MJdxgYuF46VyyfI2ui6nQlzJPq+hDPo0qcKNz/wB0U54Es7co/wAzkcgdAamU01ZbtjUWnrsjDn+dzxiqpjYHK1aZDHJGQmM9ahe2zk+lbU5WZlOOhWZKjKV1nOddYTPLpptjztbcB2NTBXibaSUOOma4IWt+h2y3/Uj8rmlEdbJmLQpTjpTNlNCYnl00x1RI0x00x4oARd6tmPIPtW1o+uf2fGd+GORlcdffNZVaaqRt1NKc+R36HQxWsWoqbmGQ/MMkg4rL1bSdi5UV5fM4ys9LHfZNXXU599Lkd+FNMbSzGPmHNb85lyFaS32HgUx8pGcqK2g72M5aGY8fPSomSvRRwndafZfYtRCzL8rHFaPiPTTHKlxHGEjKhTj1ryKU/wB4uzR6dSPuPujF2YIzTxHxXamtuxyNPfuIY+KYY6okDHg4pHQIMsQKLhYhV0dtq8mr6aQ8loZRy390DNZVKqgr92aQpczKcd8+nXefLHAwVI6028nt7mTzIY/KJ5IB4qI3UuZO6fxIuSTjy21WzLmjXs9rKFidgM/dzxXTJeRECC5ZN5XPWscVTTlePxM0oS0s9kUriaIEiIKAPzrFup/3uBzmopU3fUqc0isTEQWftVWZ0dPlWuqNNr0RhKafqzOlh6mq7x12RZytHqssMcwSfy0wwyDuxRq2oCew8gxjdx1HT3rx6Uby9GenUdkc/wCSpPzdaV4WVeFJru226nLv8iFVc/eXFKYsCqi7omSIjHzS3EKSRZBJbHNOWwRMp4WjO/O0Z4NWUubuGParnafSsXFS0ZonYRo/Pwzcmk8gL0FbQgkjOUncfFK9sSU4JpkkzO+7Jz9atRV7mbk7WHpczAcOT9aUqzgu3Ud6lxSd1oylJvRkMgDZJJzVSTK9KqKJbIGJqJlzWiViG7nfW1/ZK8XJUDqT0q9q08V2sRiL5HAG35SD3Bryaalzps9KduWyKt1pjWoXzG2uRnkcCs+8ee2YKJUbIzx0Iq/bXemiRPs7IY15Ey7m+TA5BrPuNUDIyCMDnhs81rz3SsZ8tmXbFDe2DTKVzHwyk8n6Vl3944Zo04A7jvT9pp5oOTX1Mp5GVsnmtG21aEQKkikFRj604SFKJOmpWrHAYr9RUjMGXKcg9xW0WmYyTREwNN281qZkqphQRwacCMYPHvUPUpCPGhXORmqU0fNEXqEkV2j9qjKVoQa+GAALE47VPDezRYUOdo7V5CkelY0pb+eayOJt4PG1uSKxpEkQkkmp0T9StX8hnm5GCM1GUBzVXsIj+deFYge1NMTueuapyJURr2jMvTmqclq4PK4ohMJRIhGwNadgLolUjDMvcVtz217GfLc2PsuSQQdw7Uw2pU/MCK6FU6eWhg4afmWLeKFkZJcg9mFRzac8MSyMRhumKnns7PZvQOS6utLblaRMLyR9KhkhVVBDZzV21TFeysVXWoiK1MjttV8O/YWyXVgegFZRsTu4FeHdp2e63PWSvqupZtrbadpHFPnst4xgVDlqUkUX03ax7VEbNd3ByapSbFYDYKw4PPpTv7LdT0wRVq703J0XkBtlU7Sy7qje1yMMtJpoaaZWbTCZOB+FdVo+n/ZrRXaEh/pwacptxEo2ZZfRBLmQNskY8g1lXmm3VsS4IZaaxDvZ9NifZK35mUZbp7odD6jGK3jcotogmgUrWsp3tZ2sTGO+nqZr3Flco6JEEdc7eetLDoElxEH81Vz0FbQrOEby9530MZUlJ+7ppqOOgRxDMrqcdumaqz6Xa55YJnphqaxE5PRadgdGKWr17nd+cl4VFzGHAq0NEspRuRNp9K5vYxm3e6b2ZvzuK027CroNsPvLz6iql7oICFkOQO1RPCuMbp3a3Q41ruzWj2MG604xZJrInQoSVHPrXPB3NZEYlm6bM0gup0+SQttPXmt42W25DuRTW7ht6qXX1qxZSSSttZcqPWrjJPfXuiWrbGgFiADHBxW9p1z5dv8AvW3J2B7VbUeXuQnK/kM+0SyTt5GSg/ic8VUv7xpodrDn26Gs5wj0+LqXGT67dDFWLEhfkGo5nklyrE4qlC9vwJcrFRbJVl3GtO1njhTqQR61u4StYyU1civ7sSLtAJ981kSLnPJrelHlRhVlzM7yLTdTtJuu9Qe3NdBbGUorMFJxz2NcFPnUrWO2XK4lsdKCARg13bmBSurCGU4aMtn0qjJ4Xt3YnP0GK4pYbmk+X3bGyq2WvvFKTw5IpIRAR61Fc+Gttvvfn1GOlYeynHVq1uprzxfzKcCW1mdroXU8YIqQR2KA7AxPUgDGKiz3TKutjPnjic74jtB9TzT4p58Bc7yOm6tItrfoQ0mWEubtZf367l7DtUqq1w24gKg6kDpW0FFrm7Gc207dynKqqzAoOehFVmhLdFJ/CumKtuYN9gGnzuPlibmoXs5VJBXkH1qlVjtdEezlvYimtJEXLow/CqErIDWkZp7WZEotbnrsTkjrmphz1rGDutdToloxaK0EMkU9VGSKRDIQd4A9MVm+ZS0+F7selvPoNDuHw3T2oJWUlWH50r3Vn1HtqjG1LSmVS6DdzxxWQ+nTSTcghjXBKPs3Z/I6IvmV/vK7aWYptsp2jua0LG3tllLQZkK8dO9C95227g9FfcmuFnnUrtyF9BUthHhfLkjO0n14zXToo2WhiruV2JqFtFGNyxoSPUVztzrdzBJhdoVewFZJ8zs3dLY0a5dVu9yCTxLKUPyDd2NZE+tXDyF84J74rSMEiJSbKFxqFxMpDyuQe2azpN3dj+dbRlbYzkr7nvCJkYxsP95eDUqxyA584t7EVnTi+j5fLoaSa66+ZOM45orqMgooAYwqNhis5DQ0yMBio2Zm7ZrNu+5VrDNizPsdFI9CKjNrDCuEiCZ6kcVlKEd7fMtSe34DY2jV8YKknvzTLqUQcs+PwqJuyuVHU5TWtVeaX5coq/dGaxpLxpUw4zjvRFKwSepAF85SUGcdRVeaJh/DiqvZ2JsZ86sDz0qBo2xu/hq0yLHvy9KeK2pkvcdRWogpM0AIaYwqJAhNq1FcPKoHlIHHesZNqPu6vsWtXrou5HuK5YLzjjNZ1/c3YiIUZX+8vauec36LqbRivV9DNivriYlWOdo6HmrxleWIBgDx3HSpaugvZmDqFuWYgwKSPQVlsjxIym3BUgjmoXa+xT7lSOzd3PkAq3YZpby8vVASeNendBzWukt+nUz22Jo7S2v4A3lFGxzg1Rm0l4m+UMVPqKlSa03Q2k9T/9n4qqwQ2C6FUcJKhVwpbQ1vCsihOUlK0km1lS0VoSE2qiF4TrpDJE0aZJK5EgBF7pQGeoyWHrHyLxlrwklpeaZbWWmyFkkIa43/2P/bAEMAAgEBAQEBAgEBAQICAgICBAMCAgICBQQEAwQGBQYGBgUGBgYHCQgGBwkHBgYICwgJCgoKCgoGCAsMCwoMCQoKCv/bAEMBAgICAgICBQMDBQoHBgcKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCv/AABEIAIAAgAMBIgACEQEDEQH/xAAeAAACAwEAAwEBAAAAAAAAAAAGBwQFCAMBAgkACv/EADcQAAEDAwMDAgUDAgYCAwAAAAECAwQFBhEAEiEHMUETUQgiMmFxFIGRFaEjQlKxwdEW8ReCov/EABsBAAICAwEAAAAAAAAAAAAAAAUGAwQBAgcA/8QAMREAAgEDAwMCBQMDBQAAAAAAAQIDAAQRBRIhMUFRE3EiYYGRwaHR4QYU8BUjMnKx/9oADAMBAAIRAxEAPwDNEamJCR8v9tT4dJ3Zwn+2rSHStzaVBvOrSDShnBTpvDYpbIBqsi0QKRn0+QO2uwpJQQCjRFEpR8D+2uj1LIXjb/bWwfmtNvFDqaWE/LsHfXZFNB/y6uVU75uUjj7a6NwMfMEfjWd3Fa0f/DB0mtK7KpIum8KgUxqQ+0pmE2EqMlzOQFA/5MgZ/J1q2L1glUxsPtIbbitNpW80EgbwSO+PGsWWjUqhRZy/0Tqkh1OFgH78aaKLzm0i28SnlLddYwk+wGdJH9QafJd3QLtkdh4802aNeRwWxCjBHU+aA/iosex//ktysdPnN8SpAOymM/M1IUo7/wD6k8jS8uTpxPthCJL3yuJSFKGOwPY50wavS7gnU3+vro7i4QXkyA3naoc86FrhnVGqpQl1SvTI5QVZzycHR6zkmiiSMvkLwSevtQe7WJ5HcLyeRS/q0BHqLc9NIKjyB50Pz6cEkkj+2j2qUlDRWfrJSQEgdjqqRbKKkVMJe2uBO5KSngn20SW9t1OC1DjaTsMhaBKhBCWt23A841QVGnBaiQ3n86O67TGWigR1bsg7hjkHPnVFNiJSgpIyc8DRBDxVRhjigmVAAP041CcaW2rcgYI9tE82n5PCedVkqAUkgJ1uQDUXfFaZplIUMsqb2kHke2rGNSylf0g8+2j2rWvRZtbjvxXY7EV14tuymdxzknCiD9hnge+oU+110+WtoLS4hKylDiBwoe/+2gkVysgB80akhZCQao4lMCk528jXRykKJ3bfxq8jUopABT31KXSRn6NS7sVFjihNVM+Y5T24zr1FPIVt26I3aUoEkA9+2uCqaUuDKdShs1oQM0bVvpPAtizaDUKLKVIVUYaZcxTrQSpl4jBQPOE/7k6rK1QUU213PUmJVLeWG4zTSgoff8Ht/Op1239WbjjNqqMgKDLKW0hCQkAJAHYceNC8aprVNbW+nKErG7nxnnGlyG3vJcvIckHP8f4KNyz20QCxjqP4rlFq98KoZs5ptxmKuQQ4kZBK/PPtjx21U3NbopREMhKlgfOQex9taAhdK3uofT7/AMo6eUh2PBElXqOyn0bFKT9XJOQRuHccg6BKn0RvByUUyqI+pxbZWnCchSQcZyOMZxzqs97E5IwFweR3z86nS0dFByWyOD2x8qULduuOOfIwVcZOBquqaEUV9t1EMBQz3HjTz6c9OpUibLl1aKGIsMelIekfKncoHAB8nj9tK/qfDpiqu9Hp3KWyQCR3++q7XStcel4FSiAiLf5pTVmEhcl1aOQok8e+h2bTVBZJGD99HAYnQZKxCYSXHRt3LQFAZ+x17XBbjT0VpLURKNqcFwJ5Ufvpms9VUuEfvQC609gpZaWMqAcnjzxqslQwBx+2jGr0ZyI6WHmsKx/OqaXTu4KfxjxpgBDDNBDuU1t2HUKReHSW0yqB6D9NEhh+Q0jIWvcFBC/bgkhX3I8al1mQ5ULdj0gUeKw2zIW6hbKDuJICeSSf9I0c/Bn0Pi3xcL1o1iSmP6chKz6qcjaPlPB78Ej99D9etp63K1OtySfUMSU4zuAwCUqIz++Nc70q8huB6SHLJz9yaeNQt3hbe3Rhj7AUJMUc8fJru5S0+n9HI99EcOkFxO5ScY9hr2k0hIbPy+PbTCX3UEA2mg1ym7gfl51Hk0rCdwbOilVLUkkFGvC6SVEkI/IOrAkAqBlNBbkJQQQnODxqK7TFIPKNGTtFZS4d+AAMnOvU2dPqEN6bAhuuMxwPWdbbJSjPbJ8aw9xFEMk4FeSOSQ4UZqNY/V26LLpj1qR5CjT5K8uhP1oJKclJJ4+ka2DZLVgdROlbVDtKII9wohsKeDxG8Mn/AD4BI2naPPdWsxdOennSm511K27kulcCqlgKpUpxQ9FSwPpV7A++ovTq+Lw6IdUGJcSWmQuG56DjbUrc082T9IUONvn/AI0rana2msB1tjtlX4vG79x2/wDaYLO4udM2mcZjbjzinj1f6PXNEtfDtIYjts8+nETj1FEY3qz3JwNZJvGw566u4n0FbiTu419Ird6o2r18oaWnIiYr8mKlT0dXdteSCArGCMAY/wCNKq8ehtl2tMcl1LY8+SpSGkjsOcE/9aRrbULm0maKZfiHamiW1huI1dDxWGHOmU9tkPyIpSM5STqGKHBTIEea2VJB5GtFXzCob812AkIbUjgADHGgWo9OY7Sf1jrjYDhJQpRxxpktbidjlxig08MSjC81nbqPSKe3Wj/Twop9IbwrsFew0HzaeE8lPfTav+22WqissELUSd2DxjQRVKQGx8qPyddMsJA1qgz2pDvEK3LH519dunnRiPZfXiDc8OoxUU1x8IdUy6NqwrIBx3wSM6B/jNsG2aZ1fdlW5LbWJ0Rtx5pAyW1425J7HIAOmjYxrN8yqTb9UoEanKXT0h+ey8lTrxGcKScZRn2PnzpWdXKVKYvqo0559+U7EfLSJMiOW3HAnspSTnx57Ec65F/TyYuid3IGDjx710nV2zAo28Z/X2pVU+2JMJrZIVk9xrg6xDkLWww8lS0n5kA8jRo7NtiAwpF0SVNEK+YIQdwGq9u16ImOzWqO8l1qWne24MHI/wCD9jpvhugGEakEDrzS/Lb7gXYYJ+VCS6c5HUHkJ+dJyCR2OudJpEya86zGirce27m/TTnGOSSPbV7dM2FRkw0uOMqEuQWfkeSVIUMd0jkdxqM4HqK8qR6oZ9MEOlRxgeQdXBcJIp2HmqZt3jcFhxShvufX6ZWQuS84SlZJaSOMZ9tMzpz8RVmUmy5do120UuNPJBSyklG5eACSR3yB2++ll1F6rW69WZKItHTIUUFDD7rpGxefqwO478atrNtyFeVoR6o84gPeotC1NEDJB4PbQie3W/X02PGc9aKRTf2R3gVUXJRH59xuVSgRzGZcXuQ2CcIB8DXWHClMOIdlLKlA5yfHPfRk1bbkOElp9e5aBtzjwO2qmpNMxspTjPuPGjVnZpGB5FCLq7eQkY4o+HXyRYtowaBY4ALMlt5ySpeVhSQNwPH0nAI9hka6TPiakXWt2Rcqn23HUkrDaApJXwMjz7/zpRyWSpzcPOplOghLaHZLSi2VYCgNYk0PT2G5kyx79+awurXoOA3HjtVjWqgqq1FdVUVqbWCGyDhQOPOhK6KnV3VoVJdWG0AhAHkaNJUQrpbcVLSAVnd6iOVHuMaFrnp0tpKv1BJUgYIOpLeKFTtA6cVFNNKRknrzQLV5sV1agWjz/mPfQjVYSFLUWxx4zorqsBwun5cA6qJEEkH7edGIY1iHw0NkdpDzWvLB+KW9rXr0OpN1x55tbXpTQtsbkoOAQkqBwQBweccadHTfrT0wrFz1K5ruuWfOcl00x4s2SylTsde0JCl+OEgpBHP2GsvVG0ajCfUw7CIKDjKRqw6eyKjb9cbdMcPNKc2vMujhSc9jri6Tw+myrhdwwSPFdSaNyyk84OaPut/WO1oTkuzG6PFmul8LYrDBO5SMHIVu5UVcfg9u+l1Gvup0+lLRb0v/AA8ENtvEkNk8naNEd4dNl1J1+tNx0oU4srS0Owz4GfGltMo1VgTDGfWpKEqzwO+orW8WIARtgit5oC+d65BoaqIqqpSprkle71crKlHg50fdVevFq31ZdPt+NbyoU+PT249RloUNstaCT6pAAwo55P2Gh1+lSnt7CmS5nJScarUWstThbciFWOT8vYaIJqWcFjyPzVVrME4A4oErdLE1tamV5JOQfY6pqZeN22Sp1mkVd5lLowtKF8HTjh2HBfaSEIBJByPbQ/cnRhLzS5cTJOSSlQ7a2ttYEUmCaxNp5kTIFD1rfEHekScluoTjKaUseo2/yQnzg+NNinTqPdba36FN9cJA9RJGFJJ5wRpNW/02nTa81SGYpLrrwQkbfJONao6f/C3UunPTxd5Sn1LefdQlUb0+R3IP8aY7bW0jnRC3/LigdxpfqRMwHSl2/RH23Ni2SD7EauaRa1RlUaRLjxS4iMAp7YeQCcZx5AP8Z0aVyg0RgNvSZxafWfodSBzjjj+PxrzRK43aFX/Rwq9CccqLKmlNMvhRJIKcKT7j799GG1ZJIvhI3ePahY0x1k+LO3zS+juvtOBpvCcqHJAONV931CVP+R2GhWVY3oRjb/Gn51R6ET0Uin1i0LUHomIgyW2RvWF4PJH1DPck+4xxxpS3ZR61Zlddi16gNtnaU+m4nKT9xrW3vYL0BoSN3jIzxWJbSazOJQdv1xSlrFLbSokg5OqWRBSXDuIH50dVKmVCrOLMOEpz8J7aoa9Z1w0Vaf6tRZLBcA9NLjJG7PI/9aPRyDAVjzQhkJOQOK+lfxU/DzTVXM2enFkf4D6C4+7FbKxu85OcD8AaTUH4erjaeLrNGcSsKwpBbP8AbWtOiV5zKnVG00SptyUrOFpS8FA/YjPGnW3QrdrITOcpLaXQQTubwQR7++uKLok12zehIBz0I4x8iD+mK6h/qKQKokQnjrnmsCu9MJ8ajpZqNLWktpwoKTpe3TZtDZlrUI+1e3JCm+M6+md1dN7VuuCqPPpTW8NkNrQkAg447ayz1t6Ff0FMh5qlrKjnZhPnGhGqaZe6RIDL8St0I/Pir9nfW98pAGCOx/FZFbpkB2oKQ5BbbU2rAUrhK/tqxj2pa8qQp+tPMw1hISyMEpd57HGcHnPtgak3h0/uKbP/AEkeI6CFH6UEYOqef0lvNcb1XZDoWk7kJUrnOtreSHgsRXnVyOBXpd67Jst8xKdHMtfqAKLY+VQ8lKh3/OuUe2oVxRjPpAzv5LDn1t/Y++ulF6e1y9YZtp9paKgw5hlwpJ9XOePznU/p70tvqgXO8K3EfZEMFBTggLXgkDH7dtEi9hM2w4WqoFzGu5cmudk9B4NWvmImcoRGluBTkoJ4SnI5/OtnMdO2rdZgVKt1mNJgtsJERQQPTkYCRtxyO2SSeTu1nqk3TETV4dKVFTGUtwpkGQsJSnHPCjxp41S9alWbWVY1syI7UVhLf6mXJeAbYHOTvP8AqHAAz286llsrV1TEmfwKhW5uFZspj8mqjq58PfTe6KC7Vo8KNGU2hS1ORlggr5OMDkcax3UulMFfUVuO5MUhppe5DxPbHOONa2u2NVKBSlMUCVNkMuR0plPvpAaWvn6M4OPzpL1C3pcOovOymwXSFbVBOdufI/71pY288UpEDllPT81m5nieMGVQDUTqj1OrNm2221bF3PrdRGLLxaePJ5899DvTLqJROq9VpznVGC++mG2WnGwCQ8rOAT5z7/jXpUbcW+46mpI3kqyk9+NelvvtWe4h2nx0ZQ4CpJT3HnTFp2n3CpvHXnnoaDXt/AW2k8ccdRTerNsdGbepiq7SbPZSQz6qmxFUSkHt4IHP99KK7OtdlxnltsUKS4VEpfadOAMdsfcHVldvVKtVOkriQ3VRy4r/ABdijhQHYY8aUldil1TinkBSl87jotpmj78tdkk/9iaGX+rCMhbYAD2FfTe1PgzqHT+7UXJatwF6M1IC22ivDm0HI5Hn99Puh0+RTssKqLzzeMpTJBKk/bJ1CtaWzMbJizUOBBIWE5BB/BAP76vmySnn++hul6faxH14iefnkfT5e+aLXl1O/wDtv2+VedVdx04TlMtoajFS1FCvXZ3ZSe+PY41aaj1GK7LjlEd703ByheOx0VuohNAVxmqcTbJAaD698P3TisQZDDVDbZfeOQ+ngpP/AFoJY+Du3xUkzKrLalsDOWcFOD+f402Y9MqzVLdaqNS9V8kltxJIIGOBqPGl1OBGcDzO9RPClL57HQKXR9JkZXaDZx24+4HFEEvrxAVWTPv+M1k7qf03c6UXG5Kt+2W3S0slmSpsgd+/PfA/31VT+rw5XV7Tgxqi9HLzsh5IWXMA4wk8Jz/61qfqf0ypfUSkqnMtgzWo69iSTySOBrOVT+Fy8H6k2xVqTIbS4fmf2ZShOlG+0xrOUqyZU9CBnj+KN214J1BBwR1FI+5axbN0SRL9L0pTqgXGkNYQhWPA0QWv0pvrqJRAqgz5amow/wAJv1fkGMnsfHJ0Vv8ASGj9La+5Vbzt+XLisglpLUc7XecABXj8nTHoTFTdsaIbcguUlh0BSWW1J3ZcAyFecD/nWbRTI/pxnbjz+1YuJPTTe4z7UtbWoF2XPOYtepy1L/TIUpwOOhKUJQMq559j/Oqu+qXW4tYcRS6bMQzKQENMrQcqTjgcDkeR9tN+2enl4Wncypj8OO+AMu5SpaCnIzyPOrvrrU6bS7f/AFKKm1FfWgpSoqSTvxnA9iNMM+orZlSoDADH17mg8Nm90DklST+nYVmdfQq/6q4hX9CDKXRu3PvISEjPcjOf7Z1X3T0BlW/SHKtU7jhD0nQhxDIUoJ9yTjxnwNBV/dYep9r3K8+xXpYCuEoWtQBTnjH2Ol31P+IPqddDCI8utO7UIx6bR2p/cDv++rKanqbspVlA9v3qBtPsVBDBif8APFMWtWPSqdTnahIuultpwfSbmv8ApKUARhQye2Of20lbs6o2bDkriqrsJWxW0rbVuSr99ANzXLXZ29dSlur+XlS3CdLyvRW1rWsOg55I76MWupyoT6jbvpihtxp8LD4Bj61/RJHoRq8ZmNWFvJWyrcxIjultxP7juNXdEoJouRFqT7rSvqTJXuOffOvaIT6YBJOBxnU9ogpwBjVbTrSDAkxyMc9/5q7NcSOSvbxXtr9r9r920ZqrXhYBSQdQJjQIJx+dTVup7ajSNqknPtqCcAx1lTg5qllPvxcltwj8agSnqpIQSEuqB7nB51dqYjlRLo75BP2xquu+ZckWnoNqw0StqgH2lOYUUeQPzoHM/pRM7E4HYDJ+1EEw7hRxnueB96rabFcqrkmPJa9UNoBLK+x+bng9+NU9woj0+Utb1vtObAMteiR6ae+5I8du+plWqFah0t5VKbEV1xW4uuIO5IA4Bz986z71mvbqpRbmTUaqX429sNhyO4r03BnIWOfIxn8aA3N9CsigDnyen3olFayFDk0665W4Eq1v69HlyC00raWmlBSkKzwSPtwceQdYw+L3rDWLhqggJQ41FiI2RcnBWc/MtQAABJ8eO2tAWXcl2/p3WX3S4pwpVuWySl3I/wD1pQ9erfrM2c+0i3I8sFBcQtMTkI7c7e3PvoZNcPHcCQjj371aiCPGUB5rLNfviqyKYiTU2VrbQdiXHBnIz21CqNq1WpwUzaPDMhtxsLCmkZwD747aOLwgXNHt522avZjQiLWHEEp+dsDcBt9uSM/jVFRLZ6vWBSZF2dNHZSIzzKm5jbRStSRzwUkHgZznHfVxLkyLxgH9DVdo1j6nIpK31QaoylfqMEEDCgBoHl0OU7HVUm2VpS3wpvGc8d9ak6WVGL1IdnW51Ht6NMmuO+ozMGGHMEYKSBhJAPIOO5OfGqC//h1doNVcnUOnThGUopKS0HAoc9iO/wDHjUqak0bGNxz+lQtbK3xrX//Z\";\r\n\r\n    this.emptyImage = new Image();\r\n    this.emptyImage.onload = () => {\r\n      this.samplers.empty = this.gl.createTexture();\r\n      this.bindTexture(this.samplers.empty, this.emptyImage, 1, 1);\r\n    };\r\n    this.emptyImage.src =\r\n      \"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=\";\r\n    /* eslint-enable max-len */\r\n  }\r\n\r\n  bindTexture(texture, data, width, height) {\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n\r\n    this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT, 1);\r\n    this.gl.texImage2D(\r\n      this.gl.TEXTURE_2D,\r\n      0,\r\n      this.gl.RGBA,\r\n      width,\r\n      height,\r\n      0,\r\n      this.gl.RGBA,\r\n      this.gl.UNSIGNED_BYTE,\r\n      data\r\n    );\r\n\r\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_S,\r\n      this.gl.REPEAT\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_T,\r\n      this.gl.REPEAT\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MIN_FILTER,\r\n      this.gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MAG_FILTER,\r\n      this.gl.LINEAR\r\n    );\r\n    if (this.anisoExt) {\r\n      const max = this.gl.getParameter(\r\n        this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT\r\n      );\r\n      this.gl.texParameterf(\r\n        this.gl.TEXTURE_2D,\r\n        this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,\r\n        max\r\n      );\r\n    }\r\n  }\r\n\r\n  loadExtraImages(imageData) {\r\n    Object.keys(imageData).forEach((imageName) => {\r\n      const { data, width, height } = imageData[imageName];\r\n      if (!this.samplers[imageName]) {\r\n        const image = new Image();\r\n        image.onload = () => {\r\n          this.samplers[imageName] = this.gl.createTexture();\r\n          this.bindTexture(this.samplers[imageName], image, width, height);\r\n        };\r\n        image.src = data;\r\n      }\r\n    });\r\n  }\r\n\r\n  getTexture(sampler) {\r\n    const tex = this.samplers[sampler];\r\n    if (tex) {\r\n      return tex;\r\n    }\r\n\r\n    return this.samplers.clouds2;\r\n  }\r\n}\r\n","import ShaderUtils from \"../shaders/shaderUtils\";\r\n\r\nexport default class TitleText {\r\n  constructor(gl, opts = {}) {\r\n    this.gl = gl;\r\n\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.buildPositions();\r\n\r\n    this.textTexture = this.gl.createTexture();\r\n    this.indexBuf = gl.createBuffer();\r\n    this.positionVertexBuf = this.gl.createBuffer();\r\n    this.vertexBuf = this.gl.createBuffer();\r\n\r\n    this.canvas = document.createElement(\"canvas\");\r\n    this.canvas.width = this.texsizeX;\r\n    this.canvas.height = this.texsizeY;\r\n    this.context2D = this.canvas.getContext(\"2d\", { willReadFrequently: false });\r\n\r\n    this.floatPrecision = ShaderUtils.getFragmentFloatPrecision(this.gl);\r\n    this.createShader();\r\n  }\r\n\r\n  generateTitleTexture(text) {\r\n    this.context2D.clearRect(0, 0, this.texsizeX, this.texsizeY);\r\n\r\n    this.fontSize = Math.floor(16 * (this.texsizeX / 256));\r\n    this.fontSize = Math.max(this.fontSize, 6);\r\n    this.context2D.font = `italic ${this.fontSize}px Times New Roman`;\r\n\r\n    let titleText = text;\r\n    let textLength = this.context2D.measureText(titleText).width;\r\n    if (textLength > this.texsizeX) {\r\n      const percentToKeep = 0.91 * (this.texsizeX / textLength);\r\n      titleText = `${titleText.substring(\r\n        0,\r\n        Math.floor(titleText.length * percentToKeep)\r\n      )}...`;\r\n      textLength = this.context2D.measureText(titleText).width;\r\n    }\r\n\r\n    this.context2D.fillStyle = \"#FFFFFF\";\r\n    this.context2D.fillText(\r\n      titleText,\r\n      (this.texsizeX - textLength) / 2,\r\n      this.texsizeY / 2\r\n    );\r\n\r\n    const imageData = new Uint8Array(\r\n      this.context2D.getImageData(\r\n        0,\r\n        0,\r\n        this.texsizeX,\r\n        this.texsizeY\r\n      ).data.buffer\r\n    );\r\n\r\n    this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, true);\r\n\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.textTexture);\r\n    this.gl.texImage2D(\r\n      this.gl.TEXTURE_2D,\r\n      0,\r\n      this.gl.RGBA,\r\n      this.texsizeX,\r\n      this.texsizeY,\r\n      0,\r\n      this.gl.RGBA,\r\n      this.gl.UNSIGNED_BYTE,\r\n      imageData\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MAG_FILTER,\r\n      this.gl.LINEAR\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MIN_FILTER,\r\n      this.gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_S,\r\n      this.gl.CLAMP_TO_EDGE\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_T,\r\n      this.gl.CLAMP_TO_EDGE\r\n    );\r\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, null);\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    this.texsizeX = opts.texsizeX;\r\n    this.texsizeY = opts.texsizeY;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.canvas.width = this.texsizeX;\r\n    this.canvas.height = this.texsizeY;\r\n  }\r\n\r\n  // based on https://github.com/mrdoob/three.js/blob/master/src/geometries/PlaneGeometry.js\r\n  buildPositions() {\r\n    const width = 2;\r\n    const height = 2;\r\n\r\n    const widthHalf = width / 2;\r\n    const heightHalf = height / 2;\r\n\r\n    const gridX = 15;\r\n    const gridY = 7;\r\n\r\n    const gridX1 = gridX + 1;\r\n    const gridY1 = gridY + 1;\r\n\r\n    const segmentWidth = width / gridX;\r\n    const segmentHeight = height / gridY;\r\n\r\n    const vertices = [];\r\n    for (let iy = 0; iy < gridY1; iy++) {\r\n      const y = iy * segmentHeight - heightHalf;\r\n      for (let ix = 0; ix < gridX1; ix++) {\r\n        const x = ix * segmentWidth - widthHalf;\r\n        vertices.push(x, -y, 0);\r\n      }\r\n    }\r\n\r\n    const indices = [];\r\n    for (let iy = 0; iy < gridY; iy++) {\r\n      for (let ix = 0; ix < gridX; ix++) {\r\n        const a = ix + gridX1 * iy;\r\n        const b = ix + gridX1 * (iy + 1);\r\n        const c = ix + 1 + gridX1 * (iy + 1);\r\n        const d = ix + 1 + gridX1 * iy;\r\n\r\n        indices.push(a, b, d);\r\n        indices.push(b, c, d);\r\n      }\r\n    }\r\n\r\n    this.vertices = new Float32Array(vertices);\r\n    this.indices = new Uint16Array(indices);\r\n  }\r\n\r\n  createShader() {\r\n    this.shaderProgram = this.gl.createProgram();\r\n\r\n    const vertShader = this.gl.createShader(this.gl.VERTEX_SHADER);\r\n    this.gl.shaderSource(\r\n      vertShader,\r\n      `#version 300 es\r\n       const vec2 halfmad = vec2(0.5);\r\n       in vec2 aPos;\r\n       in vec2 aUv;\r\n       out vec2 uv_orig;\r\n       out vec2 uv;\r\n       void main(void) {\r\n         gl_Position = vec4(aPos, 0.0, 1.0);\r\n         uv_orig = aPos * halfmad + halfmad;\r\n         uv = aUv;\r\n       }`\r\n    );\r\n    this.gl.compileShader(vertShader);\r\n\r\n    const fragShader = this.gl.createShader(this.gl.FRAGMENT_SHADER);\r\n    this.gl.shaderSource(\r\n      fragShader,\r\n      `#version 300 es\r\n       precision ${this.floatPrecision} float;\r\n       precision highp int;\r\n       precision mediump sampler2D;\r\n\r\n       in vec2 uv_orig;\r\n       in vec2 uv;\r\n       out vec4 fragColor;\r\n       uniform sampler2D uTexture;\r\n       uniform float textColor;\r\n\r\n       void main(void) {\r\n         fragColor = texture(uTexture, uv) * vec4(textColor);\r\n       }`\r\n    );\r\n    this.gl.compileShader(fragShader);\r\n\r\n    this.gl.attachShader(this.shaderProgram, vertShader);\r\n    this.gl.attachShader(this.shaderProgram, fragShader);\r\n    this.gl.linkProgram(this.shaderProgram);\r\n\r\n    this.positionLocation = this.gl.getAttribLocation(\r\n      this.shaderProgram,\r\n      \"aPos\"\r\n    );\r\n    this.uvLocation = this.gl.getAttribLocation(this.shaderProgram, \"aUv\");\r\n    this.textureLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"uTexture\"\r\n    );\r\n    this.textColorLoc = this.gl.getUniformLocation(\r\n      this.shaderProgram,\r\n      \"textColor\"\r\n    );\r\n  }\r\n\r\n  generateUvs(progress, flip, globalVars) {\r\n    const gridX = 15;\r\n    const gridY = 7;\r\n\r\n    const gridX1 = gridX + 1;\r\n    const gridY1 = gridY + 1;\r\n\r\n    const uvs = [];\r\n    const vertClip = 0.75;\r\n    for (let j = 0; j < gridY1; j++) {\r\n      for (let i = 0; i < gridX1; i++) {\r\n        const u = i / gridX;\r\n        const v = (j / gridY - 0.5) * vertClip + 0.5;\r\n        const x = u * 2.0 - 1.0;\r\n        let y = v * 2.0 - 1.0;\r\n        if (progress >= 1) {\r\n          y += 1.0 / this.texsizeY;\r\n        }\r\n\r\n        uvs.push(x, flip ? y : -y);\r\n      }\r\n    }\r\n\r\n    const rampedProgress = Math.max(0, 1 - progress * 1.5);\r\n    const t2 = rampedProgress ** 1.8 * 1.3;\r\n    for (let j = 0; j < gridY1; j++) {\r\n      for (let i = 0; i < gridX1; i++) {\r\n        const idx = j * gridX1 + i;\r\n        uvs[idx] +=\r\n          t2 *\r\n          0.07 *\r\n          Math.sin(\r\n            globalVars.time * 0.31 + uvs[idx] * 0.39 - uvs[idx + 1] * 1.94\r\n          );\r\n        uvs[idx] +=\r\n          t2 *\r\n          0.044 *\r\n          Math.sin(\r\n            globalVars.time * 0.81 - uvs[idx] * 1.91 + uvs[idx + 1] * 0.27\r\n          );\r\n        uvs[idx] +=\r\n          t2 *\r\n          0.061 *\r\n          Math.sin(\r\n            globalVars.time * 1.31 + uvs[idx] * 0.61 + uvs[idx + 1] * 0.74\r\n          );\r\n\r\n        uvs[idx + 1] +=\r\n          t2 *\r\n          0.061 *\r\n          Math.sin(\r\n            globalVars.time * 0.37 + uvs[idx] * 1.83 + uvs[idx + 1] * 0.69\r\n          );\r\n        uvs[idx + 1] +=\r\n          t2 *\r\n          0.07 *\r\n          Math.sin(\r\n            globalVars.time * 0.67 + uvs[idx] * 0.42 - uvs[idx + 1] * 1.39\r\n          );\r\n        uvs[idx + 1] +=\r\n          t2 *\r\n          0.087 *\r\n          Math.sin(\r\n            globalVars.time * 1.07 + uvs[idx] * 3.55 + uvs[idx + 1] * 0.89\r\n          );\r\n      }\r\n    }\r\n\r\n    const scale = 1.01 / (progress ** 0.21 + 0.01);\r\n    for (let i = 0; i < uvs.length / 2; i++) {\r\n      uvs[i * 2] *= scale;\r\n      uvs[i * 2 + 1] *= scale * this.invAspecty;\r\n\r\n      // get back UVs\r\n      uvs[i * 2] = (uvs[i * 2] + 1) / 2.0;\r\n      uvs[i * 2 + 1] = (uvs[i * 2 + 1] + 1) / 2.0;\r\n    }\r\n\r\n    return new Float32Array(uvs);\r\n  }\r\n\r\n  renderTitle(progress, flip, globalVars) {\r\n    this.gl.useProgram(this.shaderProgram);\r\n\r\n    const progressUvs = this.generateUvs(progress, flip, globalVars);\r\n\r\n    this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.indexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ELEMENT_ARRAY_BUFFER,\r\n      this.indices,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.positionVertexBuf);\r\n    this.gl.bufferData(\r\n      this.gl.ARRAY_BUFFER,\r\n      this.vertices,\r\n      this.gl.STATIC_DRAW\r\n    );\r\n\r\n    this.gl.vertexAttribPointer(\r\n      this.positionLocation,\r\n      3,\r\n      this.gl.FLOAT,\r\n      false,\r\n      0,\r\n      0\r\n    );\r\n    this.gl.enableVertexAttribArray(this.positionLocation);\r\n\r\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuf);\r\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, progressUvs, this.gl.STATIC_DRAW);\r\n\r\n    this.gl.vertexAttribPointer(this.uvLocation, 2, this.gl.FLOAT, false, 0, 0);\r\n    this.gl.enableVertexAttribArray(this.uvLocation);\r\n\r\n    this.gl.activeTexture(this.gl.TEXTURE0);\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.textTexture);\r\n\r\n    this.gl.uniform1i(this.textureLoc, 0);\r\n\r\n    this.gl.uniform1f(this.textColorLoc, progress ** 0.3);\r\n\r\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    this.gl.drawElements(\r\n      this.gl.TRIANGLES,\r\n      this.indices.length,\r\n      this.gl.UNSIGNED_SHORT,\r\n      0\r\n    );\r\n  }\r\n}\r\n","import { getRNG } from '../utils/rngContext';\r\n\r\nexport default class BlendPattern {\r\n  constructor(opts) {\r\n    this.rng = getRNG();\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n\r\n    this.vertInfoA = new Float32Array(\r\n      (this.mesh_width + 1) * (this.mesh_height + 1)\r\n    );\r\n    this.vertInfoC = new Float32Array(\r\n      (this.mesh_width + 1) * (this.mesh_height + 1)\r\n    );\r\n\r\n    this.createBlendPattern();\r\n  }\r\n\r\n  static resizeMatrixValues(oldMat, oldWidth, oldHeight, newWidth, newHeight) {\r\n    const newMat = new Float32Array((newWidth + 1) * (newHeight + 1));\r\n    let nVert = 0;\r\n    for (let j = 0; j < newHeight + 1; j++) {\r\n      for (let i = 0; i < newWidth + 1; i++) {\r\n        let x = i / newHeight;\r\n        let y = j / newWidth;\r\n\r\n        x *= oldWidth + 1;\r\n        y *= oldHeight + 1;\r\n        x = Math.clamp(x, 0, oldWidth - 1);\r\n        y = Math.clamp(y, 0, oldHeight - 1);\r\n        const nx = Math.floor(x);\r\n        const ny = Math.floor(y);\r\n        const dx = x - nx;\r\n        const dy = y - ny;\r\n        const val00 = oldMat[ny * (oldWidth + 1) + nx];\r\n        const val01 = oldMat[ny * (oldWidth + 1) + (nx + 1)];\r\n        const val10 = oldMat[(ny + 1) * (oldWidth + 1) + nx];\r\n        const val11 = oldMat[(ny + 1) * (oldWidth + 1) + (nx + 1)];\r\n        newMat[nVert] =\r\n          val00 * (1 - dx) * (1 - dy) +\r\n          val01 * dx * (1 - dy) +\r\n          val10 * (1 - dx) * dy +\r\n          val11 * dx * dy;\r\n\r\n        nVert += 1;\r\n      }\r\n    }\r\n\r\n    return newMat;\r\n  }\r\n\r\n  updateGlobals(opts) {\r\n    const oldMeshWidth = this.mesh_width;\r\n    const oldMeshHeight = this.mesh_height;\r\n\r\n    this.mesh_width = opts.mesh_width;\r\n    this.mesh_height = opts.mesh_height;\r\n    this.aspectx = opts.aspectx;\r\n    this.aspecty = opts.aspecty;\r\n\r\n    if (\r\n      this.mesh_width !== oldMeshWidth ||\r\n      this.mesh_height !== oldMeshHeight\r\n    ) {\r\n      this.vertInfoA = BlendPattern.resizeMatrixValues(\r\n        this.vertInfoA,\r\n        oldMeshWidth,\r\n        oldMeshHeight,\r\n        this.mesh_width,\r\n        this.mesh_height\r\n      );\r\n      this.vertInfoC = BlendPattern.resizeMatrixValues(\r\n        this.vertInfoC,\r\n        oldMeshWidth,\r\n        oldMeshHeight,\r\n        this.mesh_width,\r\n        this.mesh_height\r\n      );\r\n    }\r\n  }\r\n\r\n  genPlasma(x0, x1, y0, y1, dt) {\r\n    const midx = Math.floor((x0 + x1) / 2);\r\n    const midy = Math.floor((y0 + y1) / 2);\r\n    let t00 = this.vertInfoC[y0 * (this.mesh_width + 1) + x0];\r\n    let t01 = this.vertInfoC[y0 * (this.mesh_width + 1) + x1];\r\n    let t10 = this.vertInfoC[y1 * (this.mesh_width + 1) + x0];\r\n    let t11 = this.vertInfoC[y1 * (this.mesh_width + 1) + x1];\r\n\r\n    if (y1 - y0 >= 2) {\r\n      if (x0 === 0) {\r\n        this.vertInfoC[midy * (this.mesh_width + 1) + x0] =\r\n          0.5 * (t00 + t10) + (this.rng.random() * 2 - 1) * dt * this.aspecty;\r\n      }\r\n      this.vertInfoC[midy * (this.mesh_width + 1) + x1] =\r\n        0.5 * (t01 + t11) + (this.rng.random() * 2 - 1) * dt * this.aspecty;\r\n    }\r\n    if (x1 - x0 >= 2) {\r\n      if (y0 === 0) {\r\n        this.vertInfoC[y0 * (this.mesh_width + 1) + midx] =\r\n          0.5 * (t00 + t01) + (this.rng.random() * 2 - 1) * dt * this.aspectx;\r\n      }\r\n      this.vertInfoC[y1 * (this.mesh_width + 1) + midx] =\r\n        0.5 * (t10 + t11) + (this.rng.random() * 2 - 1) * dt * this.aspectx;\r\n    }\r\n\r\n    if (y1 - y0 >= 2 && x1 - x0 >= 2) {\r\n      t00 = this.vertInfoC[midy * (this.mesh_width + 1) + x0];\r\n      t01 = this.vertInfoC[midy * (this.mesh_width + 1) + x1];\r\n      t10 = this.vertInfoC[y0 * (this.mesh_width + 1) + midx];\r\n      t11 = this.vertInfoC[y1 * (this.mesh_width + 1) + midx];\r\n      this.vertInfoC[midy * (this.mesh_width + 1) + midx] =\r\n        0.25 * (t10 + t11 + t00 + t01) + (this.rng.random() * 2 - 1) * dt;\r\n\r\n      this.genPlasma(x0, midx, y0, midy, dt * 0.5);\r\n      this.genPlasma(midx, x1, y0, midy, dt * 0.5);\r\n      this.genPlasma(x0, midx, midy, y1, dt * 0.5);\r\n      this.genPlasma(midx, x1, midy, y1, dt * 0.5);\r\n    }\r\n  }\r\n\r\n  createBlendPattern() {\r\n    const mixType = 1 + Math.floor(this.rng.random() * 3);\r\n    if (mixType === 0) {\r\n      // not currently used\r\n      let nVert = 0;\r\n      for (let y = 0; y <= this.mesh_height; y++) {\r\n        for (let x = 0; x <= this.mesh_width; x++) {\r\n          this.vertInfoA[nVert] = 1;\r\n          this.vertInfoC[nVert] = 0;\r\n          nVert += 1;\r\n        }\r\n      }\r\n    } else if (mixType === 1) {\r\n      const ang = this.rng.random() * 6.28;\r\n      const vx = Math.cos(ang);\r\n      const vy = Math.sin(ang);\r\n      const band = 0.1 + 0.2 * this.rng.random();\r\n      const invBand = 1.0 / band;\r\n\r\n      let nVert = 0;\r\n      for (let y = 0; y <= this.mesh_height; y++) {\r\n        const fy = (y / this.mesh_height) * this.aspecty;\r\n        for (let x = 0; x <= this.mesh_width; x++) {\r\n          const fx = (x / this.mesh_width) * this.aspectx;\r\n\r\n          let t = (fx - 0.5) * vx + (fy - 0.5) * vy + 0.5;\r\n          t = (t - 0.5) / Math.sqrt(2) + 0.5;\r\n\r\n          this.vertInfoA[nVert] = invBand * (1 + band);\r\n          this.vertInfoC[nVert] = -invBand + invBand * t;\r\n          nVert += 1;\r\n        }\r\n      }\r\n    } else if (mixType === 2) {\r\n      const band = 0.12 + 0.13 * this.rng.random();\r\n      const invBand = 1.0 / band;\r\n\r\n      this.vertInfoC[0] = this.rng.random();\r\n      this.vertInfoC[this.mesh_width] = this.rng.random();\r\n      this.vertInfoC[this.mesh_height * (this.mesh_width + 1)] = this.rng.random();\r\n      this.vertInfoC[\r\n        this.mesh_height * (this.mesh_width + 1) + this.mesh_width\r\n      ] = this.rng.random();\r\n      this.genPlasma(0, this.mesh_width, 0, this.mesh_height, 0.25);\r\n\r\n      let minc = this.vertInfoC[0];\r\n      let maxc = this.vertInfoC[0];\r\n\r\n      let nVert = 0;\r\n      for (let y = 0; y <= this.mesh_height; y++) {\r\n        for (let x = 0; x <= this.mesh_width; x++) {\r\n          if (minc > this.vertInfoC[nVert]) {\r\n            minc = this.vertInfoC[nVert];\r\n          }\r\n          if (maxc < this.vertInfoC[nVert]) {\r\n            maxc = this.vertInfoC[nVert];\r\n          }\r\n          nVert += 1;\r\n        }\r\n      }\r\n\r\n      const mult = 1.0 / (maxc - minc);\r\n      nVert = 0;\r\n      for (let y = 0; y <= this.mesh_height; y++) {\r\n        for (let x = 0; x <= this.mesh_width; x++) {\r\n          const t = (this.vertInfoC[nVert] - minc) * mult;\r\n          this.vertInfoA[nVert] = invBand * (1 + band);\r\n          this.vertInfoC[nVert] = -invBand + invBand * t;\r\n          nVert += 1;\r\n        }\r\n      }\r\n    } else if (mixType === 3) {\r\n      const band = 0.02 + 0.14 * this.rng.random() + 0.34 * this.rng.random();\r\n      const invBand = 1.0 / band;\r\n      const dir = Math.floor(this.rng.random() * 2) * 2 - 1;\r\n\r\n      let nVert = 0;\r\n      for (let y = 0; y <= this.mesh_height; y++) {\r\n        const dy = (y / this.mesh_height - 0.5) * this.aspecty;\r\n        for (let x = 0; x <= this.mesh_width; x++) {\r\n          const dx = (x / this.mesh_width - 0.5) * this.aspectx;\r\n          let t = Math.sqrt(dx * dx + dy * dy) * 1.41421;\r\n          if (dir === -1) {\r\n            t = 1 - t;\r\n          }\r\n\r\n          this.vertInfoA[nVert] = invBand * (1 + band);\r\n          this.vertInfoC[nVert] = -invBand + invBand * t;\r\n          nVert += 1;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","import AudioLevels from \"../audio/audioLevels\";\r\nimport blankPreset from \"../blankPreset\";\r\nimport PresetEquationRunner from \"../equations/presetEquationRunner\";\r\nimport PresetEquationRunnerWASM from \"../equations/presetEquationRunnerWASM\";\r\nimport BasicWaveform from \"./waves/basicWaveform\";\r\nimport CustomWaveform from \"./waves/customWaveform\";\r\nimport CustomShape from \"./shapes/customShape\";\r\nimport Border from \"./sprites/border\";\r\nimport DarkenCenter from \"./sprites/darkenCenter\";\r\nimport MotionVectors from \"./motionVectors/motionVectors\";\r\nimport WarpShader from \"./shaders/warp\";\r\nimport CompShader from \"./shaders/comp\";\r\nimport OutputShader from \"./shaders/output\";\r\nimport ResampleShader from \"./shaders/resample\";\r\nimport BlurShader from \"./shaders/blur/blur\";\r\nimport Noise from \"../noise/noise\";\r\nimport ImageTextures from \"../image/imageTextures\";\r\nimport TitleText from \"./text/titleText\";\r\nimport BlendPattern from \"./blendPattern\";\r\nimport Utils from \"../utils\";\r\n\r\nexport default class Renderer {\r\n  constructor(gl, audio, opts) {\r\n    this.gl = gl;\r\n    this.audio = audio;\r\n\r\n    this.frameNum = 0;\r\n    this.fps = 30;\r\n    this.time = 0;\r\n    this.presetTime = 0;\r\n    this.lastTime = performance.now();\r\n    this.timeHist = [0];\r\n    this.timeHistMax = 120;\r\n    this.blending = false;\r\n    this.blendStartTime = 0;\r\n    this.blendProgress = 0;\r\n    this.blendDuration = 0;\r\n\r\n    this.width = opts.width || 1200;\r\n    this.height = opts.height || 900;\r\n    this.mesh_width = opts.meshWidth || 48;\r\n    this.mesh_height = opts.meshHeight || 36;\r\n    this.pixelRatio = opts.pixelRatio || window.devicePixelRatio || 1;\r\n    this.textureRatio = opts.textureRatio || 1;\r\n    this.outputFXAA = opts.outputFXAA || false;\r\n    this.texsizeX = this.width * this.pixelRatio * this.textureRatio;\r\n    this.texsizeY = this.height * this.pixelRatio * this.textureRatio;\r\n    this.aspectx =\r\n      this.texsizeY > this.texsizeX ? this.texsizeX / this.texsizeY : 1;\r\n    this.aspecty =\r\n      this.texsizeX > this.texsizeY ? this.texsizeY / this.texsizeX : 1;\r\n    this.invAspectx = 1.0 / this.aspectx;\r\n    this.invAspecty = 1.0 / this.aspecty;\r\n\r\n    this.qs = Utils.range(1, 33).map((x) => `q${x}`);\r\n    this.ts = Utils.range(1, 9).map((x) => `t${x}`);\r\n    this.regs = Utils.range(0, 100).map((x) => {\r\n      if (x < 10) {\r\n        return `reg0${x}`;\r\n      }\r\n      return `reg${x}`;\r\n    });\r\n\r\n    this.blurRatios = [\r\n      [0.5, 0.25],\r\n      [0.125, 0.125],\r\n      [0.0625, 0.0625],\r\n    ];\r\n\r\n    this.audioLevels = new AudioLevels(this.audio);\r\n\r\n    this.prevFrameBuffer = this.gl.createFramebuffer();\r\n    this.targetFrameBuffer = this.gl.createFramebuffer();\r\n    this.prevTexture = this.gl.createTexture();\r\n    this.targetTexture = this.gl.createTexture();\r\n\r\n    this.compFrameBuffer = this.gl.createFramebuffer();\r\n    this.compTexture = this.gl.createTexture();\r\n\r\n    this.anisoExt =\r\n      this.gl.getExtension(\"EXT_texture_filter_anisotropic\") ||\r\n      this.gl.getExtension(\"MOZ_EXT_texture_filter_anisotropic\") ||\r\n      this.gl.getExtension(\"WEBKIT_EXT_texture_filter_anisotropic\");\r\n\r\n    this.bindFrameBufferTexture(this.prevFrameBuffer, this.prevTexture);\r\n    this.bindFrameBufferTexture(this.targetFrameBuffer, this.targetTexture);\r\n    this.bindFrameBufferTexture(this.compFrameBuffer, this.compTexture);\r\n\r\n    const params = {\r\n      pixelRatio: this.pixelRatio,\r\n      textureRatio: this.textureRatio,\r\n      texsizeX: this.texsizeX,\r\n      texsizeY: this.texsizeY,\r\n      mesh_width: this.mesh_width,\r\n      mesh_height: this.mesh_height,\r\n      aspectx: this.aspectx,\r\n      aspecty: this.aspecty,\r\n    };\r\n    this.noise = new Noise(gl);\r\n    this.image = new ImageTextures(gl);\r\n    this.warpShader = new WarpShader(gl, this.noise, this.image, params);\r\n    this.compShader = new CompShader(gl, this.noise, this.image, params);\r\n    this.outputShader = new OutputShader(gl, params);\r\n    this.prevWarpShader = new WarpShader(gl, this.noise, this.image, params);\r\n    this.prevCompShader = new CompShader(gl, this.noise, this.image, params);\r\n    this.numBlurPasses = 0;\r\n    this.blurShader1 = new BlurShader(0, this.blurRatios, gl, params);\r\n    this.blurShader2 = new BlurShader(1, this.blurRatios, gl, params);\r\n    this.blurShader3 = new BlurShader(2, this.blurRatios, gl, params);\r\n    this.blurTexture1 = this.blurShader1.blurVerticalTexture;\r\n    this.blurTexture2 = this.blurShader2.blurVerticalTexture;\r\n    this.blurTexture3 = this.blurShader3.blurVerticalTexture;\r\n    this.basicWaveform = new BasicWaveform(gl, params);\r\n    this.customWaveforms = Utils.range(4).map(\r\n      (i) => new CustomWaveform(i, gl, params)\r\n    );\r\n    this.customShapes = Utils.range(4).map(\r\n      (i) => new CustomShape(i, gl, params)\r\n    );\r\n    this.prevCustomWaveforms = Utils.range(4).map(\r\n      (i) => new CustomWaveform(i, gl, params)\r\n    );\r\n    this.prevCustomShapes = Utils.range(4).map(\r\n      (i) => new CustomShape(i, gl, params)\r\n    );\r\n    this.darkenCenter = new DarkenCenter(gl, params);\r\n    this.innerBorder = new Border(gl, params);\r\n    this.outerBorder = new Border(gl, params);\r\n    this.motionVectors = new MotionVectors(gl, params);\r\n    this.titleText = new TitleText(gl, params);\r\n    this.blendPattern = new BlendPattern(params);\r\n    this.resampleShader = new ResampleShader(gl);\r\n\r\n    this.supertext = {\r\n      startTime: -1,\r\n    };\r\n\r\n    this.warpUVs = new Float32Array(\r\n      (this.mesh_width + 1) * (this.mesh_height + 1) * 2\r\n    );\r\n    this.warpColor = new Float32Array(\r\n      (this.mesh_width + 1) * (this.mesh_height + 1) * 4\r\n    );\r\n\r\n    this.gl.clearColor(0, 0, 0, 1);\r\n\r\n    this.blankPreset = blankPreset;\r\n\r\n    const globalVars = {\r\n      frame: 0,\r\n      time: 0,\r\n      fps: 45,\r\n      bass: 1,\r\n      bass_att: 1,\r\n      mid: 1,\r\n      mid_att: 1,\r\n      treb: 1,\r\n      treb_att: 1,\r\n    };\r\n\r\n    this.preset = blankPreset;\r\n    this.prevPreset = this.preset;\r\n    this.presetEquationRunner = new PresetEquationRunner(\r\n      this.preset,\r\n      globalVars,\r\n      params\r\n    );\r\n    this.prevPresetEquationRunner = new PresetEquationRunner(\r\n      this.prevPreset,\r\n      globalVars,\r\n      params\r\n    );\r\n\r\n    if (!this.preset.useWASM) {\r\n      this.regVars = this.presetEquationRunner.mdVSRegs;\r\n    }\r\n  }\r\n\r\n  static getHighestBlur(t) {\r\n    if (/sampler_blur3/.test(t)) {\r\n      return 3;\r\n    } else if (/sampler_blur2/.test(t)) {\r\n      return 2;\r\n    } else if (/sampler_blur1/.test(t)) {\r\n      return 1;\r\n    }\r\n\r\n    return 0;\r\n  }\r\n\r\n  loadPreset(preset, blendTime) {\r\n    this.blendPattern.createBlendPattern();\r\n    this.blending = true;\r\n    this.blendStartTime = this.time;\r\n    this.blendDuration = blendTime;\r\n    this.blendProgress = 0;\r\n\r\n    this.prevPresetEquationRunner = this.presetEquationRunner;\r\n\r\n    this.prevPreset = this.preset;\r\n    this.preset = preset;\r\n\r\n    this.presetTime = this.time;\r\n\r\n    const globalVars = {\r\n      frame: this.frameNum,\r\n      time: this.time,\r\n      fps: this.fps,\r\n      bass: this.audioLevels.bass,\r\n      bass_att: this.audioLevels.bass_att,\r\n      mid: this.audioLevels.mid,\r\n      mid_att: this.audioLevels.mid_att,\r\n      treb: this.audioLevels.treb,\r\n      treb_att: this.audioLevels.treb_att,\r\n    };\r\n    const params = {\r\n      pixelRatio: this.pixelRatio,\r\n      textureRatio: this.textureRatio,\r\n      texsizeX: this.texsizeX,\r\n      texsizeY: this.texsizeY,\r\n      mesh_width: this.mesh_width,\r\n      mesh_height: this.mesh_height,\r\n      aspectx: this.aspectx,\r\n      aspecty: this.aspecty,\r\n    };\r\n\r\n    if (preset.useWASM) {\r\n      this.preset.globalPools.perFrame.old_wave_mode.value = this.prevPreset.baseVals.wave_mode;\r\n      this.preset.baseVals.old_wave_mode = this.prevPreset.baseVals.wave_mode;\r\n      this.presetEquationRunner = new PresetEquationRunnerWASM(\r\n        this.preset,\r\n        globalVars,\r\n        params\r\n      );\r\n      if (this.preset.pixel_eqs_initialize_array) {\r\n        this.preset.pixel_eqs_initialize_array(\r\n          this.mesh_width,\r\n          this.mesh_height\r\n        );\r\n      }\r\n    } else {\r\n      this.preset.baseVals.old_wave_mode = this.prevPreset.baseVals.wave_mode;\r\n      this.presetEquationRunner = new PresetEquationRunner(\r\n        this.preset,\r\n        globalVars,\r\n        params\r\n      );\r\n      this.regVars = this.presetEquationRunner.mdVSRegs;\r\n    }\r\n\r\n    const tmpWarpShader = this.prevWarpShader;\r\n    this.prevWarpShader = this.warpShader;\r\n    this.warpShader = tmpWarpShader;\r\n\r\n    const tmpCompShader = this.prevCompShader;\r\n    this.prevCompShader = this.compShader;\r\n    this.compShader = tmpCompShader;\r\n\r\n    const warpText = this.preset.warp.trim();\r\n    const compText = this.preset.comp.trim();\r\n\r\n    this.warpShader.updateShader(warpText);\r\n    this.compShader.updateShader(compText);\r\n\r\n    if (warpText.length === 0) {\r\n      this.numBlurPasses = 0;\r\n    } else {\r\n      this.numBlurPasses = Renderer.getHighestBlur(warpText);\r\n    }\r\n\r\n    if (compText.length !== 0) {\r\n      this.numBlurPasses = Math.max(\r\n        this.numBlurPasses,\r\n        Renderer.getHighestBlur(compText)\r\n      );\r\n    }\r\n  }\r\n\r\n  loadExtraImages(imageData) {\r\n    this.image.loadExtraImages(imageData);\r\n  }\r\n\r\n  setRendererSize(width, height, opts) {\r\n    const oldTexsizeX = this.texsizeX;\r\n    const oldTexsizeY = this.texsizeY;\r\n\r\n    this.width = width;\r\n    this.height = height;\r\n    this.mesh_width = opts.meshWidth || this.mesh_width;\r\n    this.mesh_height = opts.meshHeight || this.mesh_height;\r\n    this.pixelRatio = opts.pixelRatio || this.pixelRatio;\r\n    this.textureRatio = opts.textureRatio || this.textureRatio;\r\n    this.texsizeX = width * this.pixelRatio * this.textureRatio;\r\n    this.texsizeY = height * this.pixelRatio * this.textureRatio;\r\n    this.aspectx =\r\n      this.texsizeY > this.texsizeX ? this.texsizeX / this.texsizeY : 1;\r\n    this.aspecty =\r\n      this.texsizeX > this.texsizeY ? this.texsizeY / this.texsizeX : 1;\r\n\r\n    if (this.texsizeX !== oldTexsizeX || this.texsizeY !== oldTexsizeY) {\r\n      // copy target texture, because we flip prev/target at start of render\r\n      const targetTextureNew = this.gl.createTexture();\r\n      this.bindFrameBufferTexture(this.targetFrameBuffer, targetTextureNew);\r\n      this.bindFrambufferAndSetViewport(\r\n        this.targetFrameBuffer,\r\n        this.texsizeX,\r\n        this.texsizeY\r\n      );\r\n\r\n      this.resampleShader.renderQuadTexture(this.targetTexture);\r\n\r\n      this.targetTexture = targetTextureNew;\r\n\r\n      this.bindFrameBufferTexture(this.prevFrameBuffer, this.prevTexture);\r\n      this.bindFrameBufferTexture(this.compFrameBuffer, this.compTexture);\r\n    }\r\n\r\n    this.updateGlobals();\r\n\r\n    // rerender current frame at new size\r\n    if (this.frameNum > 0) {\r\n      this.renderToScreen();\r\n    }\r\n  }\r\n\r\n  setInternalMeshSize(width, height) {\r\n    this.mesh_width = width;\r\n    this.mesh_height = height;\r\n\r\n    this.updateGlobals();\r\n  }\r\n\r\n  setOutputAA(useAA) {\r\n    this.outputFXAA = useAA;\r\n  }\r\n\r\n  updateGlobals() {\r\n    const params = {\r\n      pixelRatio: this.pixelRatio,\r\n      textureRatio: this.textureRatio,\r\n      texsizeX: this.texsizeX,\r\n      texsizeY: this.texsizeY,\r\n      mesh_width: this.mesh_width,\r\n      mesh_height: this.mesh_height,\r\n      aspectx: this.aspectx,\r\n      aspecty: this.aspecty,\r\n    };\r\n    this.presetEquationRunner.updateGlobals(params);\r\n    this.prevPresetEquationRunner.updateGlobals(params);\r\n    this.warpShader.updateGlobals(params);\r\n    this.prevWarpShader.updateGlobals(params);\r\n    this.compShader.updateGlobals(params);\r\n    this.prevCompShader.updateGlobals(params);\r\n    this.outputShader.updateGlobals(params);\r\n    this.blurShader1.updateGlobals(params);\r\n    this.blurShader2.updateGlobals(params);\r\n    this.blurShader3.updateGlobals(params);\r\n    this.basicWaveform.updateGlobals(params);\r\n    this.customWaveforms.forEach((wave) => wave.updateGlobals(params));\r\n    this.customShapes.forEach((shape) => shape.updateGlobals(params));\r\n    this.prevCustomWaveforms.forEach((wave) => wave.updateGlobals(params));\r\n    this.prevCustomShapes.forEach((shape) => shape.updateGlobals(params));\r\n    this.darkenCenter.updateGlobals(params);\r\n    this.innerBorder.updateGlobals(params);\r\n    this.outerBorder.updateGlobals(params);\r\n    this.motionVectors.updateGlobals(params);\r\n    this.titleText.updateGlobals(params);\r\n    this.blendPattern.updateGlobals(params);\r\n\r\n    this.warpUVs = new Float32Array(\r\n      (this.mesh_width + 1) * (this.mesh_height + 1) * 2\r\n    );\r\n    this.warpColor = new Float32Array(\r\n      (this.mesh_width + 1) * (this.mesh_height + 1) * 4\r\n    );\r\n\r\n    if (this.preset.pixel_eqs_initialize_array) {\r\n      this.preset.pixel_eqs_initialize_array(this.mesh_width, this.mesh_height);\r\n    }\r\n  }\r\n\r\n  calcTimeAndFPS(elapsedTime) {\r\n    let elapsed;\r\n    if (elapsedTime) {\r\n      elapsed = elapsedTime;\r\n    } else {\r\n      const newTime = performance.now();\r\n      elapsed = (newTime - this.lastTime) / 1000.0;\r\n      if (elapsed > 1.0 || elapsed < 0.0 || this.frame < 2) {\r\n        elapsed = 1.0 / 30.0;\r\n      }\r\n      this.lastTime = newTime;\r\n    }\r\n\r\n    this.time += 1.0 / this.fps;\r\n\r\n    if (this.blending) {\r\n      this.blendProgress =\r\n        (this.time - this.blendStartTime) / this.blendDuration;\r\n      if (this.blendProgress > 1.0) {\r\n        this.blending = false;\r\n      }\r\n    }\r\n\r\n    const newHistTime = this.timeHist[this.timeHist.length - 1] + elapsed;\r\n    this.timeHist.push(newHistTime);\r\n    if (this.timeHist.length > this.timeHistMax) {\r\n      this.timeHist.shift();\r\n    }\r\n\r\n    const newFPS = this.timeHist.length / (newHistTime - this.timeHist[0]);\r\n    if (Math.abs(newFPS - this.fps) > 3.0 && this.frame > this.timeHistMax) {\r\n      this.fps = newFPS;\r\n    } else {\r\n      const damping = 0.93;\r\n      this.fps = damping * this.fps + (1.0 - damping) * newFPS;\r\n    }\r\n  }\r\n\r\n  runPixelEquations(presetEquationRunner, mdVSFrame, globalVars, blending) {\r\n    const gridX = this.mesh_width;\r\n    const gridZ = this.mesh_height;\r\n\r\n    const gridX1 = gridX + 1;\r\n    const gridZ1 = gridZ + 1;\r\n\r\n    const warpTimeV = this.time * mdVSFrame.warpanimspeed;\r\n    const warpScaleInv = 1.0 / mdVSFrame.warpscale;\r\n\r\n    const warpf0 = 11.68 + 4.0 * Math.cos(warpTimeV * 1.413 + 10);\r\n    const warpf1 = 8.77 + 3.0 * Math.cos(warpTimeV * 1.113 + 7);\r\n    const warpf2 = 10.54 + 3.0 * Math.cos(warpTimeV * 1.233 + 3);\r\n    const warpf3 = 11.49 + 4.0 * Math.cos(warpTimeV * 0.933 + 5);\r\n\r\n    const texelOffsetX = 0.0 / this.texsizeX;\r\n    const texelOffsetY = 0.0 / this.texsizeY;\r\n\r\n    const aspectx = this.aspectx;\r\n    const aspecty = this.aspecty;\r\n\r\n    let offset = 0;\r\n    let offsetColor = 0;\r\n    if (!presetEquationRunner.preset.useWASM) {\r\n      let mdVSVertex = Utils.cloneVars(mdVSFrame);\r\n\r\n      let warp = mdVSVertex.warp;\r\n      let zoom = mdVSVertex.zoom;\r\n      let zoomExp = mdVSVertex.zoomexp;\r\n      let cx = mdVSVertex.cx;\r\n      let cy = mdVSVertex.cy;\r\n      let sx = mdVSVertex.sx;\r\n      let sy = mdVSVertex.sy;\r\n      let dx = mdVSVertex.dx;\r\n      let dy = mdVSVertex.dy;\r\n      let rot = mdVSVertex.rot;\r\n\r\n      for (let iz = 0; iz < gridZ1; iz++) {\r\n        for (let ix = 0; ix < gridX1; ix++) {\r\n          const x = (ix / gridX) * 2.0 - 1.0;\r\n          const y = (iz / gridZ) * 2.0 - 1.0;\r\n          const rad = Math.sqrt(\r\n            x * x * aspectx * aspectx + y * y * aspecty * aspecty\r\n          );\r\n\r\n          if (presetEquationRunner.runVertEQs) {\r\n            let ang;\r\n            if (iz === gridZ / 2 && ix === gridX / 2) {\r\n              ang = 0;\r\n            } else {\r\n              ang = Utils.atan2(y * aspecty, x * aspectx);\r\n            }\r\n\r\n            mdVSVertex.x = x * 0.5 * aspectx + 0.5;\r\n            mdVSVertex.y = y * -0.5 * aspecty + 0.5;\r\n            mdVSVertex.rad = rad;\r\n            mdVSVertex.ang = ang;\r\n\r\n            mdVSVertex.zoom = mdVSFrame.zoom;\r\n            mdVSVertex.zoomexp = mdVSFrame.zoomexp;\r\n            mdVSVertex.rot = mdVSFrame.rot;\r\n            mdVSVertex.warp = mdVSFrame.warp;\r\n            mdVSVertex.cx = mdVSFrame.cx;\r\n            mdVSVertex.cy = mdVSFrame.cy;\r\n            mdVSVertex.dx = mdVSFrame.dx;\r\n            mdVSVertex.dy = mdVSFrame.dy;\r\n            mdVSVertex.sx = mdVSFrame.sx;\r\n            mdVSVertex.sy = mdVSFrame.sy;\r\n\r\n            mdVSVertex = presetEquationRunner.runPixelEquations(mdVSVertex);\r\n\r\n            warp = mdVSVertex.warp;\r\n            zoom = mdVSVertex.zoom;\r\n            zoomExp = mdVSVertex.zoomexp;\r\n            cx = mdVSVertex.cx;\r\n            cy = mdVSVertex.cy;\r\n            sx = mdVSVertex.sx;\r\n            sy = mdVSVertex.sy;\r\n            dx = mdVSVertex.dx;\r\n            dy = mdVSVertex.dy;\r\n            rot = mdVSVertex.rot;\r\n          }\r\n\r\n          const zoom2V = zoom ** (zoomExp ** (rad * 2.0 - 1.0));\r\n          const zoom2Inv = 1.0 / zoom2V;\r\n\r\n          let u = x * 0.5 * aspectx * zoom2Inv + 0.5;\r\n          let v = -y * 0.5 * aspecty * zoom2Inv + 0.5;\r\n\r\n          u = (u - cx) / sx + cx;\r\n          v = (v - cy) / sy + cy;\r\n\r\n          if (warp !== 0) {\r\n            u +=\r\n              warp *\r\n              0.0035 *\r\n              Math.sin(\r\n                warpTimeV * 0.333 + warpScaleInv * (x * warpf0 - y * warpf3)\r\n              );\r\n            v +=\r\n              warp *\r\n              0.0035 *\r\n              Math.cos(\r\n                warpTimeV * 0.375 - warpScaleInv * (x * warpf2 + y * warpf1)\r\n              );\r\n            u +=\r\n              warp *\r\n              0.0035 *\r\n              Math.cos(\r\n                warpTimeV * 0.753 - warpScaleInv * (x * warpf1 - y * warpf2)\r\n              );\r\n            v +=\r\n              warp *\r\n              0.0035 *\r\n              Math.sin(\r\n                warpTimeV * 0.825 + warpScaleInv * (x * warpf0 + y * warpf3)\r\n              );\r\n          }\r\n\r\n          const u2 = u - cx;\r\n          const v2 = v - cy;\r\n\r\n          const cosRot = Math.cos(rot);\r\n          const sinRot = Math.sin(rot);\r\n          u = u2 * cosRot - v2 * sinRot + cx;\r\n          v = u2 * sinRot + v2 * cosRot + cy;\r\n\r\n          u -= dx;\r\n          v -= dy;\r\n\r\n          u = (u - 0.5) / aspectx + 0.5;\r\n          v = (v - 0.5) / aspecty + 0.5;\r\n\r\n          u += texelOffsetX;\r\n          v += texelOffsetY;\r\n\r\n          if (!blending) {\r\n            this.warpUVs[offset] = u;\r\n            this.warpUVs[offset + 1] = v;\r\n\r\n            this.warpColor[offsetColor + 0] = 1;\r\n            this.warpColor[offsetColor + 1] = 1;\r\n            this.warpColor[offsetColor + 2] = 1;\r\n            this.warpColor[offsetColor + 3] = 1;\r\n          } else {\r\n            let mix2 =\r\n              this.blendPattern.vertInfoA[offset / 2] * this.blendProgress +\r\n              this.blendPattern.vertInfoC[offset / 2];\r\n            mix2 = Math.clamp(mix2, 0, 1);\r\n\r\n            this.warpUVs[offset] = this.warpUVs[offset] * mix2 + u * (1 - mix2);\r\n            this.warpUVs[offset + 1] =\r\n              this.warpUVs[offset + 1] * mix2 + v * (1 - mix2);\r\n\r\n            this.warpColor[offsetColor + 0] = 1;\r\n            this.warpColor[offsetColor + 1] = 1;\r\n            this.warpColor[offsetColor + 2] = 1;\r\n            this.warpColor[offsetColor + 3] = mix2;\r\n          }\r\n\r\n          offset += 2;\r\n          offsetColor += 4;\r\n        }\r\n      }\r\n\r\n      this.mdVSVertex = mdVSVertex;\r\n    } else {\r\n      const varPool = presetEquationRunner.preset.globalPools.perVertex;\r\n\r\n      Utils.setWasm(varPool, globalVars, presetEquationRunner.globalKeys);\r\n      Utils.setWasm(\r\n        varPool,\r\n        presetEquationRunner.mdVSQAfterFrame,\r\n        presetEquationRunner.qs\r\n      );\r\n\r\n      varPool.zoom.value = mdVSFrame.zoom;\r\n      varPool.zoomexp.value = mdVSFrame.zoomexp;\r\n      varPool.rot.value = mdVSFrame.rot;\r\n      varPool.warp.value = mdVSFrame.warp;\r\n      varPool.cx.value = mdVSFrame.cx;\r\n      varPool.cy.value = mdVSFrame.cy;\r\n      varPool.dx.value = mdVSFrame.dx;\r\n      varPool.dy.value = mdVSFrame.dy;\r\n      varPool.sx.value = mdVSFrame.sx;\r\n      varPool.sy.value = mdVSFrame.sy;\r\n\r\n      presetEquationRunner.preset.pixel_eqs_wasm(\r\n        presetEquationRunner.runVertEQs,\r\n        this.mesh_width,\r\n        this.mesh_height,\r\n        this.time,\r\n        mdVSFrame.warpanimspeed,\r\n        mdVSFrame.warpscale,\r\n        this.aspectx,\r\n        this.aspecty\r\n      );\r\n\r\n      if (!blending) {\r\n        this.warpUVs = presetEquationRunner.preset.pixel_eqs_get_array();\r\n        this.warpColor.fill(1);\r\n      } else {\r\n        const newWarpUVs = presetEquationRunner.preset.pixel_eqs_get_array();\r\n\r\n        let offset = 0;\r\n        let offsetColor = 0;\r\n        for (let iz = 0; iz < gridZ1; iz++) {\r\n          for (let ix = 0; ix < gridX1; ix++) {\r\n            const u = newWarpUVs[offset];\r\n            const v = newWarpUVs[offset + 1];\r\n\r\n            let mix2 =\r\n              this.blendPattern.vertInfoA[offset / 2] * this.blendProgress +\r\n              this.blendPattern.vertInfoC[offset / 2];\r\n            mix2 = Math.clamp(mix2, 0, 1);\r\n\r\n            this.warpUVs[offset] = this.warpUVs[offset] * mix2 + u * (1 - mix2);\r\n            this.warpUVs[offset + 1] =\r\n              this.warpUVs[offset + 1] * mix2 + v * (1 - mix2);\r\n\r\n            this.warpColor[offsetColor + 0] = 1;\r\n            this.warpColor[offsetColor + 1] = 1;\r\n            this.warpColor[offsetColor + 2] = 1;\r\n            this.warpColor[offsetColor + 3] = mix2;\r\n\r\n            offset += 2;\r\n            offsetColor += 4;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  static mixFrameEquations(blendProgress, mdVSFrame, mdVSFramePrev) {\r\n    const mix = 0.5 - 0.5 * Math.cos(blendProgress * Math.PI);\r\n    const mix2 = 1 - mix;\r\n    const snapPoint = 0.5;\r\n\r\n    const mixedFrame = Utils.cloneVars(mdVSFrame);\r\n\r\n    mixedFrame.decay = mix * mdVSFrame.decay + mix2 * mdVSFramePrev.decay;\r\n    mixedFrame.wave_a = mix * mdVSFrame.wave_a + mix2 * mdVSFramePrev.wave_a;\r\n    mixedFrame.wave_r = mix * mdVSFrame.wave_r + mix2 * mdVSFramePrev.wave_r;\r\n    mixedFrame.wave_g = mix * mdVSFrame.wave_g + mix2 * mdVSFramePrev.wave_g;\r\n    mixedFrame.wave_b = mix * mdVSFrame.wave_b + mix2 * mdVSFramePrev.wave_b;\r\n    mixedFrame.wave_x = mix * mdVSFrame.wave_x + mix2 * mdVSFramePrev.wave_x;\r\n    mixedFrame.wave_y = mix * mdVSFrame.wave_y + mix2 * mdVSFramePrev.wave_y;\r\n    mixedFrame.wave_mystery =\r\n      mix * mdVSFrame.wave_mystery + mix2 * mdVSFramePrev.wave_mystery;\r\n    mixedFrame.ob_size = mix * mdVSFrame.ob_size + mix2 * mdVSFramePrev.ob_size;\r\n    mixedFrame.ob_r = mix * mdVSFrame.ob_r + mix2 * mdVSFramePrev.ob_r;\r\n    mixedFrame.ob_g = mix * mdVSFrame.ob_g + mix2 * mdVSFramePrev.ob_g;\r\n    mixedFrame.ob_b = mix * mdVSFrame.ob_b + mix2 * mdVSFramePrev.ob_b;\r\n    mixedFrame.ob_a = mix * mdVSFrame.ob_a + mix2 * mdVSFramePrev.ob_a;\r\n    mixedFrame.ib_size = mix * mdVSFrame.ib_size + mix2 * mdVSFramePrev.ib_size;\r\n    mixedFrame.ib_r = mix * mdVSFrame.ib_r + mix2 * mdVSFramePrev.ib_r;\r\n    mixedFrame.ib_g = mix * mdVSFrame.ib_g + mix2 * mdVSFramePrev.ib_g;\r\n    mixedFrame.ib_b = mix * mdVSFrame.ib_b + mix2 * mdVSFramePrev.ib_b;\r\n    mixedFrame.ib_a = mix * mdVSFrame.ib_a + mix2 * mdVSFramePrev.ib_a;\r\n    mixedFrame.mv_x = mix * mdVSFrame.mv_x + mix2 * mdVSFramePrev.mv_x;\r\n    mixedFrame.mv_y = mix * mdVSFrame.mv_y + mix2 * mdVSFramePrev.mv_y;\r\n    mixedFrame.mv_dx = mix * mdVSFrame.mv_dx + mix2 * mdVSFramePrev.mv_dx;\r\n    mixedFrame.mv_dy = mix * mdVSFrame.mv_dy + mix2 * mdVSFramePrev.mv_dy;\r\n    mixedFrame.mv_l = mix * mdVSFrame.mv_l + mix2 * mdVSFramePrev.mv_l;\r\n    mixedFrame.mv_r = mix * mdVSFrame.mv_r + mix2 * mdVSFramePrev.mv_r;\r\n    mixedFrame.mv_g = mix * mdVSFrame.mv_g + mix2 * mdVSFramePrev.mv_g;\r\n    mixedFrame.mv_b = mix * mdVSFrame.mv_b + mix2 * mdVSFramePrev.mv_b;\r\n    mixedFrame.mv_a = mix * mdVSFrame.mv_a + mix2 * mdVSFramePrev.mv_a;\r\n    mixedFrame.echo_zoom =\r\n      mix * mdVSFrame.echo_zoom + mix2 * mdVSFramePrev.echo_zoom;\r\n    mixedFrame.echo_alpha =\r\n      mix * mdVSFrame.echo_alpha + mix2 * mdVSFramePrev.echo_alpha;\r\n    mixedFrame.echo_orient =\r\n      mix * mdVSFrame.echo_orient + mix2 * mdVSFramePrev.echo_orient;\r\n    mixedFrame.wave_dots =\r\n      mix < snapPoint ? mdVSFramePrev.wave_dots : mdVSFrame.wave_dots;\r\n    mixedFrame.wave_thick =\r\n      mix < snapPoint ? mdVSFramePrev.wave_thick : mdVSFrame.wave_thick;\r\n    mixedFrame.additivewave =\r\n      mix < snapPoint ? mdVSFramePrev.additivewave : mdVSFrame.additivewave;\r\n    mixedFrame.wave_brighten =\r\n      mix < snapPoint ? mdVSFramePrev.wave_brighten : mdVSFrame.wave_brighten;\r\n    mixedFrame.darken_center =\r\n      mix < snapPoint ? mdVSFramePrev.darken_center : mdVSFrame.darken_center;\r\n    mixedFrame.gammaadj =\r\n      mix < snapPoint ? mdVSFramePrev.gammaadj : mdVSFrame.gammaadj;\r\n    mixedFrame.wrap = mix < snapPoint ? mdVSFramePrev.wrap : mdVSFrame.wrap;\r\n    mixedFrame.invert =\r\n      mix < snapPoint ? mdVSFramePrev.invert : mdVSFrame.invert;\r\n    mixedFrame.brighten =\r\n      mix < snapPoint ? mdVSFramePrev.brighten : mdVSFrame.brighten;\r\n    mixedFrame.darken =\r\n      mix < snapPoint ? mdVSFramePrev.darken : mdVSFrame.darken;\r\n    mixedFrame.solarize =\r\n      mix < snapPoint ? mdVSFramePrev.brighten : mdVSFrame.solarize;\r\n    mixedFrame.b1n = mix * mdVSFrame.b1n + mix2 * mdVSFramePrev.b1n;\r\n    mixedFrame.b2n = mix * mdVSFrame.b2n + mix2 * mdVSFramePrev.b2n;\r\n    mixedFrame.b3n = mix * mdVSFrame.b3n + mix2 * mdVSFramePrev.b3n;\r\n    mixedFrame.b1x = mix * mdVSFrame.b1x + mix2 * mdVSFramePrev.b1x;\r\n    mixedFrame.b2x = mix * mdVSFrame.b2x + mix2 * mdVSFramePrev.b2x;\r\n    mixedFrame.b3x = mix * mdVSFrame.b3x + mix2 * mdVSFramePrev.b3x;\r\n    mixedFrame.b1ed = mix * mdVSFrame.b1ed + mix2 * mdVSFramePrev.b1ed;\r\n\r\n    return mixedFrame;\r\n  }\r\n\r\n  static getBlurValues(mdVSFrame) {\r\n    let blurMin1 = mdVSFrame.b1n;\r\n    let blurMin2 = mdVSFrame.b2n;\r\n    let blurMin3 = mdVSFrame.b3n;\r\n    let blurMax1 = mdVSFrame.b1x;\r\n    let blurMax2 = mdVSFrame.b2x;\r\n    let blurMax3 = mdVSFrame.b3x;\r\n\r\n    const fMinDist = 0.1;\r\n    if (blurMax1 - blurMin1 < fMinDist) {\r\n      const avg = (blurMin1 + blurMax1) * 0.5;\r\n      blurMin1 = avg - fMinDist * 0.5;\r\n      blurMax1 = avg - fMinDist * 0.5;\r\n    }\r\n    blurMax2 = Math.min(blurMax1, blurMax2);\r\n    blurMin2 = Math.max(blurMin1, blurMin2);\r\n    if (blurMax2 - blurMin2 < fMinDist) {\r\n      const avg = (blurMin2 + blurMax2) * 0.5;\r\n      blurMin2 = avg - fMinDist * 0.5;\r\n      blurMax2 = avg - fMinDist * 0.5;\r\n    }\r\n    blurMax3 = Math.min(blurMax2, blurMax3);\r\n    blurMin3 = Math.max(blurMin2, blurMin3);\r\n    if (blurMax3 - blurMin3 < fMinDist) {\r\n      const avg = (blurMin3 + blurMax3) * 0.5;\r\n      blurMin3 = avg - fMinDist * 0.5;\r\n      blurMax3 = avg - fMinDist * 0.5;\r\n    }\r\n\r\n    return {\r\n      blurMins: [blurMin1, blurMin2, blurMin3],\r\n      blurMaxs: [blurMax1, blurMax2, blurMax3],\r\n    };\r\n  }\r\n\r\n  bindFrambufferAndSetViewport(fb, width, height) {\r\n    this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, fb);\r\n    this.gl.viewport(0, 0, width, height);\r\n  }\r\n\r\n  bindFrameBufferTexture(targetFrameBuffer, targetTexture) {\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, targetTexture);\r\n\r\n    this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT, 1);\r\n    this.gl.texImage2D(\r\n      this.gl.TEXTURE_2D,\r\n      0,\r\n      this.gl.RGBA,\r\n      this.texsizeX,\r\n      this.texsizeY,\r\n      0,\r\n      this.gl.RGBA,\r\n      this.gl.UNSIGNED_BYTE,\r\n      new Uint8Array(this.texsizeX * this.texsizeY * 4)\r\n    );\r\n\r\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_S,\r\n      this.gl.CLAMP_TO_EDGE\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_WRAP_T,\r\n      this.gl.CLAMP_TO_EDGE\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MIN_FILTER,\r\n      this.gl.LINEAR_MIPMAP_LINEAR\r\n    );\r\n    this.gl.texParameteri(\r\n      this.gl.TEXTURE_2D,\r\n      this.gl.TEXTURE_MAG_FILTER,\r\n      this.gl.LINEAR\r\n    );\r\n    if (this.anisoExt) {\r\n      const max = this.gl.getParameter(\r\n        this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT\r\n      );\r\n      this.gl.texParameterf(\r\n        this.gl.TEXTURE_2D,\r\n        this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,\r\n        max\r\n      );\r\n    }\r\n\r\n    this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, targetFrameBuffer);\r\n    this.gl.framebufferTexture2D(\r\n      this.gl.FRAMEBUFFER,\r\n      this.gl.COLOR_ATTACHMENT0,\r\n      this.gl.TEXTURE_2D,\r\n      targetTexture,\r\n      0\r\n    );\r\n  }\r\n\r\n  render({ audioLevels, elapsedTime } = {}) {\r\n    this.calcTimeAndFPS(elapsedTime);\r\n    this.frameNum += 1;\r\n\r\n    if (audioLevels) {\r\n      this.audio.updateAudio(\r\n        audioLevels.timeByteArray,\r\n        audioLevels.timeByteArrayL,\r\n        audioLevels.timeByteArrayR\r\n      );\r\n    } else {\r\n      this.audio.sampleAudio();\r\n    }\r\n    this.audioLevels.updateAudioLevels(this.fps, this.frameNum);\r\n\r\n    const globalVars = {\r\n      frame: this.frameNum,\r\n      time: this.time,\r\n      fps: this.fps,\r\n      bass: this.audioLevels.bass,\r\n      bass_att: this.audioLevels.bass_att,\r\n      mid: this.audioLevels.mid,\r\n      mid_att: this.audioLevels.mid_att,\r\n      treb: this.audioLevels.treb,\r\n      treb_att: this.audioLevels.treb_att,\r\n      meshx: this.mesh_width,\r\n      meshy: this.mesh_height,\r\n      aspectx: this.invAspectx,\r\n      aspecty: this.invAspecty,\r\n      pixelsx: this.texsizeX,\r\n      pixelsy: this.texsizeY,\r\n    };\r\n\r\n    const prevGlobalVars = Object.assign({}, globalVars);\r\n    if (!this.prevPreset.useWASM) {\r\n      prevGlobalVars.gmegabuf = this.prevPresetEquationRunner.gmegabuf;\r\n    }\r\n\r\n    if (!this.preset.useWASM) {\r\n      globalVars.gmegabuf = this.presetEquationRunner.gmegabuf;\r\n      Object.assign(globalVars, this.regVars);\r\n    }\r\n\r\n    const mdVSFrame = this.presetEquationRunner.runFrameEquations(globalVars);\r\n\r\n    this.runPixelEquations(\r\n      this.presetEquationRunner,\r\n      mdVSFrame,\r\n      globalVars,\r\n      false\r\n    );\r\n\r\n    if (!this.preset.useWASM) {\r\n      Object.assign(this.regVars, Utils.pick(this.mdVSVertex, this.regs));\r\n      Object.assign(globalVars, this.regVars);\r\n    }\r\n\r\n    let mdVSFrameMixed;\r\n    if (this.blending) {\r\n      this.prevMDVSFrame = this.prevPresetEquationRunner.runFrameEquations(\r\n        prevGlobalVars\r\n      );\r\n      this.runPixelEquations(\r\n        this.prevPresetEquationRunner,\r\n        this.prevMDVSFrame,\r\n        prevGlobalVars,\r\n        true\r\n      );\r\n\r\n      mdVSFrameMixed = Renderer.mixFrameEquations(\r\n        this.blendProgress,\r\n        mdVSFrame,\r\n        this.prevMDVSFrame\r\n      );\r\n    } else {\r\n      mdVSFrameMixed = mdVSFrame;\r\n    }\r\n\r\n    const swapTexture = this.targetTexture;\r\n    this.targetTexture = this.prevTexture;\r\n    this.prevTexture = swapTexture;\r\n\r\n    const swapFrameBuffer = this.targetFrameBuffer;\r\n    this.targetFrameBuffer = this.prevFrameBuffer;\r\n    this.prevFrameBuffer = swapFrameBuffer;\r\n\r\n    this.gl.bindTexture(this.gl.TEXTURE_2D, this.prevTexture);\r\n    this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n    this.bindFrambufferAndSetViewport(\r\n      this.targetFrameBuffer,\r\n      this.texsizeX,\r\n      this.texsizeY\r\n    );\r\n\r\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n    this.gl.enable(this.gl.BLEND);\r\n    this.gl.blendEquation(this.gl.FUNC_ADD);\r\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    const { blurMins, blurMaxs } = Renderer.getBlurValues(mdVSFrameMixed);\r\n\r\n    if (!this.blending) {\r\n      this.warpShader.renderQuadTexture(\r\n        false,\r\n        this.prevTexture,\r\n        this.blurTexture1,\r\n        this.blurTexture2,\r\n        this.blurTexture3,\r\n        blurMins,\r\n        blurMaxs,\r\n        mdVSFrame,\r\n        this.presetEquationRunner.mdVSQAfterFrame,\r\n        this.warpUVs,\r\n        this.warpColor\r\n      );\r\n    } else {\r\n      this.prevWarpShader.renderQuadTexture(\r\n        false,\r\n        this.prevTexture,\r\n        this.blurTexture1,\r\n        this.blurTexture2,\r\n        this.blurTexture3,\r\n        blurMins,\r\n        blurMaxs,\r\n        this.prevMDVSFrame,\r\n        this.prevPresetEquationRunner.mdVSQAfterFrame,\r\n        this.warpUVs,\r\n        this.warpColor\r\n      );\r\n\r\n      this.warpShader.renderQuadTexture(\r\n        true,\r\n        this.prevTexture,\r\n        this.blurTexture1,\r\n        this.blurTexture2,\r\n        this.blurTexture3,\r\n        blurMins,\r\n        blurMaxs,\r\n        mdVSFrameMixed,\r\n        this.presetEquationRunner.mdVSQAfterFrame,\r\n        this.warpUVs,\r\n        this.warpColor\r\n      );\r\n    }\r\n\r\n    if (this.numBlurPasses > 0) {\r\n      this.blurShader1.renderBlurTexture(\r\n        this.targetTexture,\r\n        mdVSFrame,\r\n        blurMins,\r\n        blurMaxs\r\n      );\r\n\r\n      if (this.numBlurPasses > 1) {\r\n        this.blurShader2.renderBlurTexture(\r\n          this.blurTexture1,\r\n          mdVSFrame,\r\n          blurMins,\r\n          blurMaxs\r\n        );\r\n\r\n        if (this.numBlurPasses > 2) {\r\n          this.blurShader3.renderBlurTexture(\r\n            this.blurTexture2,\r\n            mdVSFrame,\r\n            blurMins,\r\n            blurMaxs\r\n          );\r\n        }\r\n      }\r\n\r\n      // rebind target texture framebuffer\r\n      this.bindFrambufferAndSetViewport(\r\n        this.targetFrameBuffer,\r\n        this.texsizeX,\r\n        this.texsizeY\r\n      );\r\n    }\r\n\r\n    this.motionVectors.drawMotionVectors(mdVSFrameMixed, this.warpUVs);\r\n\r\n    if (this.preset.shapes && this.preset.shapes.length > 0) {\r\n      this.customShapes.forEach((shape, i) => {\r\n        shape.drawCustomShape(\r\n          this.blending ? this.blendProgress : 1,\r\n          globalVars,\r\n          this.presetEquationRunner,\r\n          this.preset.shapes[i],\r\n          this.prevTexture\r\n        );\r\n      });\r\n    }\r\n\r\n    if (this.preset.waves && this.preset.waves.length > 0) {\r\n      this.customWaveforms.forEach((waveform, i) => {\r\n        waveform.drawCustomWaveform(\r\n          this.blending ? this.blendProgress : 1,\r\n          this.audio.timeArrayL,\r\n          this.audio.timeArrayR,\r\n          this.audio.freqArrayL,\r\n          this.audio.freqArrayR,\r\n          globalVars,\r\n          this.presetEquationRunner,\r\n          this.preset.waves[i]\r\n        );\r\n      });\r\n    }\r\n\r\n    if (this.blending) {\r\n      if (this.prevPreset.shapes && this.prevPreset.shapes.length > 0) {\r\n        this.prevCustomShapes.forEach((shape, i) => {\r\n          shape.drawCustomShape(\r\n            1.0 - this.blendProgress,\r\n            prevGlobalVars,\r\n            this.prevPresetEquationRunner,\r\n            this.prevPreset.shapes[i],\r\n            this.prevTexture\r\n          );\r\n        });\r\n      }\r\n\r\n      if (this.prevPreset.waves && this.prevPreset.waves.length > 0) {\r\n        this.prevCustomWaveforms.forEach((waveform, i) => {\r\n          waveform.drawCustomWaveform(\r\n            1.0 - this.blendProgress,\r\n            this.audio.timeArrayL,\r\n            this.audio.timeArrayR,\r\n            this.audio.freqArrayL,\r\n            this.audio.freqArrayR,\r\n            prevGlobalVars,\r\n            this.prevPresetEquationRunner,\r\n            this.prevPreset.waves[i]\r\n          );\r\n        });\r\n      }\r\n    }\r\n\r\n    this.basicWaveform.drawBasicWaveform(\r\n      this.blending,\r\n      this.blendProgress,\r\n      this.audio.timeArrayL,\r\n      this.audio.timeArrayR,\r\n      mdVSFrameMixed\r\n    );\r\n\r\n    this.darkenCenter.drawDarkenCenter(mdVSFrameMixed);\r\n\r\n    const outerColor = [\r\n      mdVSFrameMixed.ob_r,\r\n      mdVSFrameMixed.ob_g,\r\n      mdVSFrameMixed.ob_b,\r\n      mdVSFrameMixed.ob_a,\r\n    ];\r\n    this.outerBorder.drawBorder(outerColor, mdVSFrameMixed.ob_size, 0);\r\n\r\n    const innerColor = [\r\n      mdVSFrameMixed.ib_r,\r\n      mdVSFrameMixed.ib_g,\r\n      mdVSFrameMixed.ib_b,\r\n      mdVSFrameMixed.ib_a,\r\n    ];\r\n    this.innerBorder.drawBorder(\r\n      innerColor,\r\n      mdVSFrameMixed.ib_size,\r\n      mdVSFrameMixed.ob_size\r\n    );\r\n\r\n    if (this.supertext.startTime >= 0) {\r\n      const progress =\r\n        (this.time - this.supertext.startTime) / this.supertext.duration;\r\n      if (progress >= 1) {\r\n        this.titleText.renderTitle(progress, true, globalVars);\r\n      }\r\n    }\r\n\r\n    // Store variables in case we need to rerender\r\n    this.globalVars = globalVars;\r\n    this.mdVSFrame = mdVSFrame;\r\n    this.mdVSFrameMixed = mdVSFrameMixed;\r\n\r\n    this.renderToScreen();\r\n  }\r\n\r\n  renderToScreen() {\r\n    if (this.outputFXAA) {\r\n      this.bindFrambufferAndSetViewport(\r\n        this.compFrameBuffer,\r\n        this.texsizeX,\r\n        this.texsizeY\r\n      );\r\n    } else {\r\n      this.bindFrambufferAndSetViewport(null, this.width, this.height);\r\n    }\r\n\r\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n    this.gl.enable(this.gl.BLEND);\r\n    this.gl.blendEquation(this.gl.FUNC_ADD);\r\n    this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    const { blurMins, blurMaxs } = Renderer.getBlurValues(this.mdVSFrameMixed);\r\n\r\n    if (!this.blending) {\r\n      this.compShader.renderQuadTexture(\r\n        false,\r\n        this.targetTexture,\r\n        this.blurTexture1,\r\n        this.blurTexture2,\r\n        this.blurTexture3,\r\n        blurMins,\r\n        blurMaxs,\r\n        this.mdVSFrame,\r\n        this.presetEquationRunner.mdVSQAfterFrame,\r\n        this.warpColor\r\n      );\r\n    } else {\r\n      this.prevCompShader.renderQuadTexture(\r\n        false,\r\n        this.targetTexture,\r\n        this.blurTexture1,\r\n        this.blurTexture2,\r\n        this.blurTexture3,\r\n        blurMins,\r\n        blurMaxs,\r\n        this.prevMDVSFrame,\r\n        this.prevPresetEquationRunner.mdVSQAfterFrame,\r\n        this.warpColor\r\n      );\r\n\r\n      this.compShader.renderQuadTexture(\r\n        true,\r\n        this.targetTexture,\r\n        this.blurTexture1,\r\n        this.blurTexture2,\r\n        this.blurTexture3,\r\n        blurMins,\r\n        blurMaxs,\r\n        this.mdVSFrameMixed,\r\n        this.presetEquationRunner.mdVSQAfterFrame,\r\n        this.warpColor\r\n      );\r\n    }\r\n\r\n    if (this.supertext.startTime >= 0) {\r\n      const progress =\r\n        (this.time - this.supertext.startTime) / this.supertext.duration;\r\n      this.titleText.renderTitle(progress, false, this.globalVars);\r\n\r\n      if (progress >= 1) {\r\n        this.supertext.startTime = -1;\r\n      }\r\n    }\r\n\r\n    if (this.outputFXAA) {\r\n      this.gl.bindTexture(this.gl.TEXTURE_2D, this.compTexture);\r\n      this.gl.generateMipmap(this.gl.TEXTURE_2D);\r\n\r\n      this.bindFrambufferAndSetViewport(null, this.width, this.height);\r\n      this.outputShader.renderQuadTexture(this.compTexture);\r\n    }\r\n  }\r\n\r\n  launchSongTitleAnim(text) {\r\n    this.supertext = {\r\n      startTime: this.time,\r\n      duration: 1.7,\r\n    };\r\n    this.titleText.generateTitleTexture(text);\r\n  }\r\n\r\n  toDataURL() {\r\n    const data = new Uint8Array(this.texsizeX * this.texsizeY * 4);\r\n\r\n    const compFrameBuffer = this.gl.createFramebuffer();\r\n    const compTexture = this.gl.createTexture();\r\n\r\n    this.bindFrameBufferTexture(compFrameBuffer, compTexture);\r\n\r\n    const { blurMins, blurMaxs } = Renderer.getBlurValues(this.mdVSFrameMixed);\r\n    this.compShader.renderQuadTexture(\r\n      false,\r\n      this.targetTexture,\r\n      this.blurTexture1,\r\n      this.blurTexture2,\r\n      this.blurTexture3,\r\n      blurMins,\r\n      blurMaxs,\r\n      this.mdVSFrame,\r\n      this.presetEquationRunner.mdVSQAfterFrame,\r\n      this.warpColor\r\n    );\r\n\r\n    this.gl.readPixels(\r\n      0,\r\n      0,\r\n      this.texsizeX,\r\n      this.texsizeY,\r\n      this.gl.RGBA,\r\n      this.gl.UNSIGNED_BYTE,\r\n      data\r\n    );\r\n\r\n    // flip data\r\n    Array.from({ length: this.texsizeY }, (val, i) =>\r\n      data.slice(i * this.texsizeX * 4, (i + 1) * this.texsizeX * 4)\r\n    ).forEach((val, i) =>\r\n      data.set(val, (this.texsizeY - i - 1) * this.texsizeX * 4)\r\n    );\r\n\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = this.texsizeX;\r\n    canvas.height = this.texsizeY;\r\n\r\n    const context = canvas.getContext(\"2d\", { willReadFrequently: false });\r\n    const imageData = context.createImageData(this.texsizeX, this.texsizeY);\r\n    imageData.data.set(data);\r\n    context.putImageData(imageData, 0, 0);\r\n\r\n    this.gl.deleteTexture(compTexture);\r\n    this.gl.deleteFramebuffer(compFrameBuffer);\r\n\r\n    return canvas.toDataURL();\r\n  }\r\n\r\n  warpBufferToDataURL() {\r\n    const data = new Uint8Array(this.texsizeX * this.texsizeY * 4);\r\n\r\n    this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, this.targetFrameBuffer);\r\n    this.gl.readPixels(\r\n      0,\r\n      0,\r\n      this.texsizeX,\r\n      this.texsizeY,\r\n      this.gl.RGBA,\r\n      this.gl.UNSIGNED_BYTE,\r\n      data\r\n    );\r\n\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = this.texsizeX;\r\n    canvas.height = this.texsizeY;\r\n\r\n    const context = canvas.getContext(\"2d\", { willReadFrequently: false });\r\n    const imageData = context.createImageData(this.texsizeX, this.texsizeY);\r\n    imageData.data.set(data);\r\n    context.putImageData(imageData, 0, 0);\r\n\r\n    return canvas.toDataURL();\r\n  }\r\n}\r\n","import { loadModule } from \"eel-wasm\";\r\nimport ascLoader from \"@assemblyscript/loader\";\r\nimport AudioProcessor from \"./audio/audioProcessor\";\r\nimport Renderer from \"./rendering/renderer\";\r\nimport Utils from \"./utils\";\r\nimport loadPresetFunctionsBuffer from \"./assemblyscript/presetFunctions.ts\";\r\nimport { initializeRNG } from \"./utils/rngContext\";\r\n\r\nexport default class Visualizer {\r\n  constructor(audioContext, canvas, opts) {\r\n    this.opts = opts;\r\n\r\n    // Initialize RNG context\r\n    this.rng = initializeRNG(opts);\r\n    this.deterministicMode = opts.deterministic || opts.testMode;\r\n    this.audio = new AudioProcessor(audioContext);\r\n\r\n    const vizWidth = opts.width || 1200;\r\n    const vizHeight = opts.height || 900;\r\n    if (window.OffscreenCanvas) {\r\n      this.internalCanvas = new OffscreenCanvas(vizWidth, vizHeight);\r\n    } else {\r\n      this.internalCanvas = document.createElement(\"canvas\");\r\n      this.internalCanvas.width = vizWidth;\r\n      this.internalCanvas.height = vizHeight;\r\n    }\r\n\r\n    this.gl = this.internalCanvas.getContext(\"webgl2\", {\r\n      alpha: false,\r\n      antialias: false,\r\n      depth: false,\r\n      stencil: false,\r\n      premultipliedAlpha: false,\r\n    });\r\n\r\n    this.outputGl = canvas.getContext('2d', { willReadFrequently: false });\r\n\r\n    this.baseValsDefaults = {\r\n      decay: 0.98,\r\n      gammaadj: 2,\r\n      echo_zoom: 2,\r\n      echo_alpha: 0,\r\n      echo_orient: 0,\r\n      red_blue: 0,\r\n      brighten: 0,\r\n      darken: 0,\r\n      wrap: 1,\r\n      darken_center: 0,\r\n      solarize: 0,\r\n      invert: 0,\r\n      bmotionvectorson: 1,\r\n      fshader: 0,\r\n      b1n: 0,\r\n      b2n: 0,\r\n      b3n: 0,\r\n      b1x: 1,\r\n      b2x: 1,\r\n      b3x: 1,\r\n      b1ed: 0.25,\r\n      wave_mode: 0,\r\n      additivewave: 0,\r\n      wave_dots: 0,\r\n      wave_thick: 0,\r\n      wave_a: 0.8,\r\n      wave_scale: 1,\r\n      wave_smoothing: 0.75,\r\n      wave_mystery: 0,\r\n      modwavealphabyvolume: 0,\r\n      modwavealphastart: 0.75,\r\n      modwavealphaend: 0.95,\r\n      wave_r: 1,\r\n      wave_g: 1,\r\n      wave_b: 1,\r\n      wave_x: 0.5,\r\n      wave_y: 0.5,\r\n      wave_brighten: 1,\r\n      mv_x: 12,\r\n      mv_y: 9,\r\n      mv_dx: 0,\r\n      mv_dy: 0,\r\n      mv_l: 0.9,\r\n      mv_r: 1,\r\n      mv_g: 1,\r\n      mv_b: 1,\r\n      mv_a: 1,\r\n      warpanimspeed: 1,\r\n      warpscale: 1,\r\n      zoomexp: 1,\r\n      zoom: 1,\r\n      rot: 0,\r\n      cx: 0.5,\r\n      cy: 0.5,\r\n      dx: 0,\r\n      dy: 0,\r\n      warp: 1,\r\n      sx: 1,\r\n      sy: 1,\r\n      ob_size: 0.01,\r\n      ob_r: 0,\r\n      ob_g: 0,\r\n      ob_b: 0,\r\n      ob_a: 0,\r\n      ib_size: 0.01,\r\n      ib_r: 0.25,\r\n      ib_g: 0.25,\r\n      ib_b: 0.25,\r\n      ib_a: 0,\r\n    };\r\n\r\n    this.shapeBaseValsDefaults = {\r\n      enabled: 0,\r\n      sides: 4,\r\n      additive: 0,\r\n      thickoutline: 0,\r\n      textured: 0,\r\n      num_inst: 1,\r\n      tex_zoom: 1,\r\n      tex_ang: 0,\r\n      x: 0.5,\r\n      y: 0.5,\r\n      rad: 0.1,\r\n      ang: 0,\r\n      r: 1,\r\n      g: 0,\r\n      b: 0,\r\n      a: 1,\r\n      r2: 0,\r\n      g2: 1,\r\n      b2: 0,\r\n      a2: 0,\r\n      border_r: 1,\r\n      border_g: 1,\r\n      border_b: 1,\r\n      border_a: 0.1,\r\n    };\r\n\r\n    this.waveBaseValsDefaults = {\r\n      enabled: 0,\r\n      samples: 512,\r\n      sep: 0,\r\n      scaling: 1,\r\n      smoothing: 0.5,\r\n      r: 1,\r\n      g: 1,\r\n      b: 1,\r\n      a: 1,\r\n      spectrum: 0,\r\n      usedots: 0,\r\n      thick: 0,\r\n      additive: 0,\r\n    };\r\n\r\n    this.qs = Utils.range(1, 33).map((x) => `q${x}`);\r\n    this.ts = Utils.range(1, 9).map((x) => `t${x}`);\r\n\r\n    this.globalPerFrameVars = [\r\n      \"old_wave_mode\",\r\n      // globals\r\n      \"frame\",\r\n      \"time\",\r\n      \"fps\",\r\n      \"bass\",\r\n      \"bass_att\",\r\n      \"mid\",\r\n      \"mid_att\",\r\n      \"treb\",\r\n      \"treb_att\",\r\n      \"meshx\",\r\n      \"meshy\",\r\n      \"aspectx\",\r\n      \"aspecty\",\r\n      \"pixelsx\",\r\n      \"pixelsy\",\r\n      \"rand_start\",\r\n      \"rand_preset\",\r\n    ];\r\n\r\n    this.globalPerPixelVars = [\r\n      // globals\r\n      \"frame\",\r\n      \"time\",\r\n      \"fps\",\r\n      \"bass\",\r\n      \"bass_att\",\r\n      \"mid\",\r\n      \"mid_att\",\r\n      \"treb\",\r\n      \"treb_att\",\r\n      \"meshx\",\r\n      \"meshy\",\r\n      \"aspectx\",\r\n      \"aspecty\",\r\n      \"pixelsx\",\r\n      \"pixelsy\",\r\n      \"rand_start\",\r\n      \"rand_preset\",\r\n      // for pixel eqs\r\n      \"x\",\r\n      \"y\",\r\n      \"rad\",\r\n      \"ang\",\r\n    ];\r\n\r\n    this.globalShapeVars = [\r\n      // globals\r\n      \"frame\",\r\n      \"time\",\r\n      \"fps\",\r\n      \"bass\",\r\n      \"bass_att\",\r\n      \"mid\",\r\n      \"mid_att\",\r\n      \"treb\",\r\n      \"treb_att\",\r\n      \"meshx\",\r\n      \"meshy\",\r\n      \"aspectx\",\r\n      \"aspecty\",\r\n      \"pixelsx\",\r\n      \"pixelsy\",\r\n      \"rand_start\",\r\n      \"rand_preset\",\r\n      // for shape eqs\r\n      \"instance\",\r\n    ];\r\n\r\n    this.shapeBaseVars = [\r\n      \"x\",\r\n      \"y\",\r\n      \"rad\",\r\n      \"ang\",\r\n      \"r\",\r\n      \"g\",\r\n      \"b\",\r\n      \"a\",\r\n      \"r2\",\r\n      \"g2\",\r\n      \"b2\",\r\n      \"a2\",\r\n      \"border_r\",\r\n      \"border_g\",\r\n      \"border_b\",\r\n      \"border_a\",\r\n      \"thickoutline\",\r\n      \"textured\",\r\n      \"tex_zoom\",\r\n      \"tex_ang\",\r\n      \"additive\",\r\n    ];\r\n\r\n    this.globalWaveVars = [\r\n      // globals\r\n      \"frame\",\r\n      \"time\",\r\n      \"fps\",\r\n      \"bass\",\r\n      \"bass_att\",\r\n      \"mid\",\r\n      \"mid_att\",\r\n      \"treb\",\r\n      \"treb_att\",\r\n      \"meshx\",\r\n      \"meshy\",\r\n      \"aspectx\",\r\n      \"aspecty\",\r\n      \"pixelsx\",\r\n      \"pixelsy\",\r\n      \"rand_start\",\r\n      \"rand_preset\",\r\n      // for wave eqs\r\n      \"x\",\r\n      \"y\",\r\n      \"sample\",\r\n      \"value1\",\r\n      \"value2\",\r\n    ];\r\n\r\n    this.renderer = new Renderer(this.gl, this.audio, opts);\r\n  }\r\n\r\n  loseGLContext() {\r\n    this.gl.getExtension(\"WEBGL_lose_context\").loseContext();\r\n    this.outputGl = null;\r\n  }\r\n\r\n  connectAudio(audioNode) {\r\n    this.audioNode = audioNode;\r\n    this.audio.connectAudio(audioNode);\r\n  }\r\n\r\n  disconnectAudio(audioNode) {\r\n    this.audio.disconnectAudio(audioNode);\r\n  }\r\n\r\n  // Override defaults, but only include variables in default map\r\n  static overrideDefaultVars(baseValsDefaults, baseVals) {\r\n    const combinedVals = {};\r\n\r\n    Object.keys(baseValsDefaults).forEach((key) => {\r\n      if (Object.prototype.hasOwnProperty.call(baseVals, key)) {\r\n        combinedVals[key] = baseVals[key];\r\n      } else {\r\n        combinedVals[key] = baseValsDefaults[key];\r\n      }\r\n    });\r\n\r\n    return combinedVals;\r\n  }\r\n\r\n  createQVars() {\r\n    const wasmVars = {};\r\n\r\n    this.qs.forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        0\r\n      );\r\n    });\r\n\r\n    return wasmVars;\r\n  }\r\n\r\n  createTVars() {\r\n    const wasmVars = {};\r\n\r\n    this.ts.forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        0\r\n      );\r\n    });\r\n\r\n    return wasmVars;\r\n  }\r\n\r\n  createPerFramePool(baseVals) {\r\n    const wasmVars = {};\r\n\r\n    Object.keys(this.baseValsDefaults).forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        baseVals[key]\r\n      );\r\n    });\r\n\r\n    this.globalPerFrameVars.forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        0\r\n      );\r\n    });\r\n\r\n    return wasmVars;\r\n  }\r\n\r\n  createPerPixelPool(baseVals) {\r\n    const wasmVars = {};\r\n\r\n    Object.keys(this.baseValsDefaults).forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        baseVals[key]\r\n      );\r\n    });\r\n\r\n    this.globalPerPixelVars.forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        0\r\n      );\r\n    });\r\n\r\n    return wasmVars;\r\n  }\r\n\r\n  createCustomShapePerFramePool(baseVals) {\r\n    const wasmVars = {};\r\n\r\n    Object.keys(this.shapeBaseValsDefaults).forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        baseVals[key]\r\n      );\r\n    });\r\n\r\n    this.globalShapeVars.forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        0\r\n      );\r\n    });\r\n\r\n    return wasmVars;\r\n  }\r\n\r\n  createCustomWavePerFramePool(baseVals) {\r\n    const wasmVars = {};\r\n\r\n    Object.keys(this.waveBaseValsDefaults).forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        baseVals[key]\r\n      );\r\n    });\r\n\r\n    this.globalWaveVars.forEach((key) => {\r\n      wasmVars[key] = new WebAssembly.Global(\r\n        { value: \"f64\", mutable: true },\r\n        0\r\n      );\r\n    });\r\n\r\n    return wasmVars;\r\n  }\r\n\r\n  static makeShapeResetPool(pool, variables, idx) {\r\n    return variables.reduce((acc, variable) => {\r\n      return { ...acc, [`${variable}_${idx}`]: pool[variable] };\r\n    }, {});\r\n  }\r\n\r\n  static base64ToArrayBuffer(base64) {\r\n    var binaryString = window.atob(base64);\r\n    var len = binaryString.length;\r\n    var bytes = new Uint8Array(len);\r\n    for (var i = 0; i < len; i++) {\r\n      bytes[i] = binaryString.charCodeAt(i);\r\n    }\r\n    return bytes.buffer;\r\n  }\r\n\r\n  async loadPreset(presetMap, blendTime = 0) {\r\n    const preset = JSON.parse(JSON.stringify(presetMap));\r\n    preset.baseVals = Visualizer.overrideDefaultVars(\r\n      this.baseValsDefaults,\r\n      preset.baseVals\r\n    );\r\n    for (let i = 0; i < preset.shapes.length; i++) {\r\n      preset.shapes[i].baseVals = Visualizer.overrideDefaultVars(\r\n        this.shapeBaseValsDefaults,\r\n        preset.shapes[i].baseVals\r\n      );\r\n    }\r\n\r\n    for (let i = 0; i < preset.waves.length; i++) {\r\n      preset.waves[i].baseVals = Visualizer.overrideDefaultVars(\r\n        this.waveBaseValsDefaults,\r\n        preset.waves[i].baseVals\r\n      );\r\n    }\r\n\r\n    const forceJS = preset.useJS && !this.opts.onlyUseWASM;\r\n\r\n    if (\r\n      Object.prototype.hasOwnProperty.call(preset, \"init_eqs_eel\") &&\r\n      !forceJS\r\n    ) {\r\n      preset.useWASM = true;\r\n      await this.loadWASMPreset(preset, blendTime);\r\n    } else if (!this.opts.onlyUseWASM) {\r\n      if (Object.prototype.hasOwnProperty.call(preset, \"init_eqs_str\")) {\r\n        this.loadJSPreset(preset, blendTime);\r\n      } else {\r\n        console.warn(\r\n          \"Tried to load a JS preset that doesn't have converted strings\"\r\n        );\r\n      }\r\n    } else {\r\n      console.warn(\r\n        \"Tried to load a preset that doesn't support WASM with onlyUseWASM on\"\r\n      );\r\n    }\r\n  }\r\n\r\n  async loadWASMPreset(preset, blendTime) {\r\n    const qWasmVars = this.createQVars();\r\n    const tWasmVars = this.createTVars();\r\n\r\n    const wasmVarPools = {\r\n      perFrame: { ...qWasmVars, ...this.createPerFramePool(preset.baseVals) },\r\n      perVertex: {\r\n        ...qWasmVars,\r\n        ...this.createPerPixelPool(preset.baseVals),\r\n      },\r\n    };\r\n\r\n    const wasmFunctions = {\r\n      presetInit: { pool: \"perFrame\", code: preset.init_eqs_eel },\r\n      perFrame: { pool: \"perFrame\", code: preset.frame_eqs_eel },\r\n    };\r\n\r\n    if (preset.pixel_eqs_eel !== \"\") {\r\n      wasmFunctions.perPixel = {\r\n        pool: \"perVertex\",\r\n        code: preset.pixel_eqs_eel,\r\n      };\r\n    }\r\n\r\n    for (let i = 0; i < preset.shapes.length; i++) {\r\n      wasmVarPools[`shapePerFrame${i}`] = {\r\n        ...qWasmVars,\r\n        ...tWasmVars,\r\n        ...this.createCustomShapePerFramePool(preset.shapes[i].baseVals),\r\n      };\r\n\r\n      if (preset.shapes[i].baseVals.enabled !== 0) {\r\n        wasmFunctions[`shapes_${i}_init_eqs`] = {\r\n          pool: `shapePerFrame${i}`,\r\n          code: preset.shapes[i].init_eqs_eel,\r\n        };\r\n        wasmFunctions[`shapes_${i}_frame_eqs`] = {\r\n          pool: `shapePerFrame${i}`,\r\n          code: preset.shapes[i].frame_eqs_eel,\r\n        };\r\n      }\r\n    }\r\n\r\n    for (let i = 0; i < preset.waves.length; i++) {\r\n      if (preset.waves[i].baseVals.enabled !== 0) {\r\n        wasmVarPools[`wavePerFrame${i}`] = {\r\n          ...qWasmVars,\r\n          ...tWasmVars,\r\n          ...this.createCustomWavePerFramePool(preset.waves[i].baseVals),\r\n        };\r\n        wasmFunctions[`waves_${i}_init_eqs`] = {\r\n          pool: `wavePerFrame${i}`,\r\n          code: preset.waves[i].init_eqs_eel,\r\n        };\r\n        wasmFunctions[`waves_${i}_frame_eqs`] = {\r\n          pool: `wavePerFrame${i}`,\r\n          code: preset.waves[i].frame_eqs_eel,\r\n        };\r\n\r\n        if (\r\n          preset.waves[i].point_eqs_eel &&\r\n          preset.waves[i].point_eqs_eel !== \"\"\r\n        ) {\r\n          wasmFunctions[`waves_${i}_point_eqs`] = {\r\n            pool: `wavePerFrame${i}`,\r\n            code: preset.waves[i].point_eqs_eel,\r\n          };\r\n        }\r\n      }\r\n    }\r\n\r\n    const mod = await loadModule({\r\n      pools: wasmVarPools,\r\n      functions: wasmFunctions,\r\n      eelVersion: preset.version || 2,\r\n    });\r\n\r\n    // eel-wasm returns null if the function was empty\r\n    const handleEmptyFunction = (f) => {\r\n      return f ? f : () => {};\r\n    };\r\n\r\n    const presetFunctionsMod = await ascLoader.instantiate(\r\n      Visualizer.base64ToArrayBuffer(loadPresetFunctionsBuffer()),\r\n      {\r\n        pixelEqs: {\r\n          perPixelEqs: handleEmptyFunction(mod.exports.perPixel),\r\n        },\r\n        // For resetting pixel eq vars\r\n        pixelVarPool: {\r\n          warp: wasmVarPools.perVertex.warp,\r\n          zoom: wasmVarPools.perVertex.zoom,\r\n          zoomexp: wasmVarPools.perVertex.zoomexp,\r\n          cx: wasmVarPools.perVertex.cx,\r\n          cy: wasmVarPools.perVertex.cy,\r\n          sx: wasmVarPools.perVertex.sx,\r\n          sy: wasmVarPools.perVertex.sy,\r\n          dx: wasmVarPools.perVertex.dx,\r\n          dy: wasmVarPools.perVertex.dy,\r\n          rot: wasmVarPools.perVertex.rot,\r\n          x: wasmVarPools.perVertex.x,\r\n          y: wasmVarPools.perVertex.y,\r\n          ang: wasmVarPools.perVertex.ang,\r\n          rad: wasmVarPools.perVertex.rad,\r\n        },\r\n        // For resetting qs/ts\r\n        qVarPool: qWasmVars,\r\n        tVarPool: tWasmVars,\r\n        // For resetting shape vars\r\n        shapePool0: Visualizer.makeShapeResetPool(\r\n          wasmVarPools[\"shapePerFrame0\"],\r\n          this.shapeBaseVars,\r\n          0\r\n        ),\r\n        shapePool1: Visualizer.makeShapeResetPool(\r\n          wasmVarPools[\"shapePerFrame1\"],\r\n          this.shapeBaseVars,\r\n          1\r\n        ),\r\n        shapePool2: Visualizer.makeShapeResetPool(\r\n          wasmVarPools[\"shapePerFrame2\"],\r\n          this.shapeBaseVars,\r\n          2\r\n        ),\r\n        shapePool3: Visualizer.makeShapeResetPool(\r\n          wasmVarPools[\"shapePerFrame3\"],\r\n          this.shapeBaseVars,\r\n          3\r\n        ),\r\n        console: {\r\n          logi: (value) => {\r\n            // eslint-disable-next-line no-console\r\n            console.log(\"logi: \" + value);\r\n          },\r\n          logf: (value) => {\r\n            // eslint-disable-next-line no-console\r\n            console.log(\"logf: \" + value);\r\n          },\r\n        },\r\n        env: {\r\n          abort: () => {\r\n            // No idea why we need this.\r\n          },\r\n        },\r\n      }\r\n    );\r\n\r\n    preset.globalPools = wasmVarPools;\r\n    preset.init_eqs = handleEmptyFunction(mod.exports.presetInit);\r\n    preset.frame_eqs = handleEmptyFunction(mod.exports.perFrame);\r\n    preset.save_qs = presetFunctionsMod.exports.saveQs;\r\n    preset.restore_qs = presetFunctionsMod.exports.restoreQs;\r\n    preset.save_ts = presetFunctionsMod.exports.saveTs;\r\n    preset.restore_ts = presetFunctionsMod.exports.restoreTs;\r\n    if (mod.exports.perPixel) {\r\n      preset.pixel_eqs = mod.exports.perPixel;\r\n    }\r\n    preset.pixel_eqs_initialize_array = (meshWidth, meshHeight) => {\r\n      const arrPtr = presetFunctionsMod.exports.createFloat32Array(\r\n        (meshWidth + 1) * (meshHeight + 1) * 2\r\n      );\r\n      preset.pixel_eqs_array = arrPtr;\r\n    };\r\n    preset.pixel_eqs_get_array = () => {\r\n      return presetFunctionsMod.exports.__getFloat32ArrayView(\r\n        preset.pixel_eqs_array\r\n      );\r\n    };\r\n    preset.pixel_eqs_wasm = (...args) =>\r\n      presetFunctionsMod.exports.runPixelEquations(\r\n        preset.pixel_eqs_array,\r\n        ...args\r\n      );\r\n\r\n    for (let i = 0; i < preset.shapes.length; i++) {\r\n      if (preset.shapes[i].baseVals.enabled !== 0) {\r\n        preset.shapes[i].init_eqs = handleEmptyFunction(\r\n          mod.exports[`shapes_${i}_init_eqs`]\r\n        );\r\n        // Not wrapped because we check if null in customShapes\r\n        preset.shapes[i].frame_eqs = mod.exports[`shapes_${i}_frame_eqs`];\r\n\r\n        preset.shapes[i].frame_eqs_save = () =>\r\n          presetFunctionsMod.exports[`shape${i}_save`]();\r\n        preset.shapes[i].frame_eqs_restore = () =>\r\n          presetFunctionsMod.exports[`shape${i}_restore`]();\r\n      }\r\n    }\r\n\r\n    for (let i = 0; i < preset.waves.length; i++) {\r\n      if (preset.waves[i].baseVals.enabled !== 0) {\r\n        const wave = {\r\n          init_eqs: handleEmptyFunction(mod.exports[`waves_${i}_init_eqs`]),\r\n          frame_eqs: handleEmptyFunction(mod.exports[`waves_${i}_frame_eqs`]),\r\n        };\r\n\r\n        if (\r\n          preset.waves[i].point_eqs_eel &&\r\n          preset.waves[i].point_eqs_eel !== \"\"\r\n        ) {\r\n          // Not wrapped because we check if null in customWaves\r\n          wave.point_eqs = mod.exports[`waves_${i}_point_eqs`];\r\n        } else {\r\n          wave.point_eqs = \"\";\r\n        }\r\n\r\n        preset.waves[i] = Object.assign({}, preset.waves[i], wave);\r\n      }\r\n    }\r\n\r\n    this.renderer.loadPreset(preset, blendTime);\r\n  }\r\n\r\n  loadJSPreset(preset, blendTime) {\r\n    // If init_eqs is already a function, it means we've already prepared the preset to run\r\n    if (typeof preset.init_eqs !== \"function\") {\r\n      /* eslint-disable no-param-reassign, no-new-func */\r\n      preset.init_eqs = new Function(\"a\", `${preset.init_eqs_str} return a;`);\r\n      preset.frame_eqs = new Function(\"a\", `${preset.frame_eqs_str} return a;`);\r\n      if (preset.pixel_eqs_str && preset.pixel_eqs_str !== \"\") {\r\n        preset.pixel_eqs = new Function(\r\n          \"a\",\r\n          `${preset.pixel_eqs_str} return a;`\r\n        );\r\n      } else {\r\n        preset.pixel_eqs = \"\";\r\n      }\r\n\r\n      for (let i = 0; i < preset.shapes.length; i++) {\r\n        if (preset.shapes[i].baseVals.enabled !== 0) {\r\n          preset.shapes[i] = Object.assign({}, preset.shapes[i], {\r\n            init_eqs: new Function(\r\n              \"a\",\r\n              `${preset.shapes[i].init_eqs_str} return a;`\r\n            ),\r\n            frame_eqs: new Function(\r\n              \"a\",\r\n              `${preset.shapes[i].frame_eqs_str} return a;`\r\n            ),\r\n          });\r\n        }\r\n      }\r\n\r\n      for (let i = 0; i < preset.waves.length; i++) {\r\n        if (preset.waves[i].baseVals.enabled !== 0) {\r\n          const wave = {\r\n            init_eqs: new Function(\r\n              \"a\",\r\n              `${preset.waves[i].init_eqs_str} return a;`\r\n            ),\r\n            frame_eqs: new Function(\r\n              \"a\",\r\n              `${preset.waves[i].frame_eqs_str} return a;`\r\n            ),\r\n          };\r\n\r\n          if (\r\n            preset.waves[i].point_eqs_str &&\r\n            preset.waves[i].point_eqs_str !== \"\"\r\n          ) {\r\n            wave.point_eqs = new Function(\r\n              \"a\",\r\n              `${preset.waves[i].point_eqs_str} return a;`\r\n            );\r\n          } else {\r\n            wave.point_eqs = \"\";\r\n          }\r\n\r\n          preset.waves[i] = Object.assign({}, preset.waves[i], wave);\r\n        }\r\n      }\r\n      /* eslint-enable no-param-reassign, no-new-func */\r\n    }\r\n    this.renderer.loadPreset(preset, blendTime);\r\n  }\r\n\r\n  loadExtraImages(imageData) {\r\n    this.renderer.loadExtraImages(imageData);\r\n  }\r\n\r\n  setRendererSize(width, height, opts = {}) {\r\n    this.internalCanvas.width = width;\r\n    this.internalCanvas.height = height;\r\n    this.renderer.setRendererSize(width, height, opts);\r\n  }\r\n\r\n  setInternalMeshSize(width, height) {\r\n    this.renderer.setInternalMeshSize(width, height);\r\n  }\r\n\r\n  setOutputAA(useAA) {\r\n    this.renderer.setOutputAA(useAA);\r\n  }\r\n\r\n  setCanvas(canvas) {\r\n    this.outputGl = canvas.getContext('2d', { willReadFrequently: false });\r\n  }\r\n\r\n  render(opts) {\r\n    const renderOutput = this.renderer.render(opts);\r\n\r\n    if (this.outputGl) {\r\n      this.outputGl.drawImage(this.internalCanvas, 0, 0);\r\n    }\r\n\r\n    return renderOutput;\r\n  }\r\n\r\n  launchSongTitleAnim(text) {\r\n    this.renderer.launchSongTitleAnim(text);\r\n  }\r\n\r\n  toDataURL() {\r\n    return this.renderer.toDataURL();\r\n  }\r\n\r\n  warpBufferToDataURL() {\r\n    return this.renderer.warpBufferToDataURL();\r\n  }\r\n}\r\n","@external(\"console\", \"logf\")\r\ndeclare function logf(val: f64): void;\r\n@external(\"console\", \"logi\")\r\ndeclare function logi(val: i32): void;\r\n\r\nexport function createFloat32Array(length: i32): Float32Array {\r\n  return new Float32Array(length);\r\n}\r\n\r\n// Reset pixel eq vars\r\n\r\n@external(\"pixelVarPool\", \"warp\")\r\ndeclare let warp: f64;\r\n@external(\"pixelVarPool\", \"zoom\")\r\ndeclare let zoom: f64;\r\n@external(\"pixelVarPool\", \"zoomexp\")\r\ndeclare let zoomexp: f64;\r\n@external(\"pixelVarPool\", \"cx\")\r\ndeclare let cx: f64;\r\n@external(\"pixelVarPool\", \"cy\")\r\ndeclare let cy: f64;\r\n@external(\"pixelVarPool\", \"sx\")\r\ndeclare let sx: f64;\r\n@external(\"pixelVarPool\", \"sy\")\r\ndeclare let sy: f64;\r\n@external(\"pixelVarPool\", \"dx\")\r\ndeclare let dx: f64;\r\n@external(\"pixelVarPool\", \"dy\")\r\ndeclare let dy: f64;\r\n@external(\"pixelVarPool\", \"rot\")\r\ndeclare let rot: f64;\r\n\r\nlet warp_save: f64;\r\nlet zoom_save: f64;\r\nlet zoomexp_save: f64;\r\nlet cx_save: f64;\r\nlet cy_save: f64;\r\nlet sx_save: f64;\r\nlet sy_save: f64;\r\nlet dx_save: f64;\r\nlet dy_save: f64;\r\nlet rot_save: f64;\r\n\r\nfunction save(): void {\r\n  warp_save = warp;\r\n  zoom_save = zoom;\r\n  zoomexp_save = zoomexp;\r\n  cx_save = cx;\r\n  cy_save = cy;\r\n  sx_save = sx;\r\n  sy_save = sy;\r\n  dx_save = dx;\r\n  dy_save = dy;\r\n  rot_save = rot;\r\n}\r\n\r\nfunction restore(): void {\r\n  warp = warp_save;\r\n  zoom = zoom_save;\r\n  zoomexp = zoomexp_save;\r\n  cx = cx_save;\r\n  cy = cy_save;\r\n  sx = sx_save;\r\n  sy = sy_save;\r\n  dx = dx_save;\r\n  dy = dy_save;\r\n  rot = rot_save;\r\n}\r\n\r\n@external(\"pixelVarPool\", \"x\")\r\ndeclare let x: f64;\r\n@external(\"pixelVarPool\", \"y\")\r\ndeclare let y: f64;\r\n@external(\"pixelVarPool\", \"ang\")\r\ndeclare let ang: f64;\r\n@external(\"pixelVarPool\", \"rad\")\r\ndeclare let rad: f64;\r\n\r\n@external(\"pixelEqs\", \"perPixelEqs\")\r\ndeclare function perPixelEqs(): void;\r\n\r\nfunction atan2(x: f64, y: f64): f64 {\r\n  let a: f64 = Math.atan2(x, y);\r\n  if (a < 0) {\r\n    a += 2.0 * Math.PI;\r\n  }\r\n  return a;\r\n}\r\n\r\nexport function runPixelEquations(\r\n  arr: Float32Array,\r\n  runVertEQs: bool,\r\n  meshWidth: i32,\r\n  meshHeight: i32,\r\n  time: f64,\r\n  warpanimspeed: f64,\r\n  warpscale: f64,\r\n  aspectx: f64,\r\n  aspecty: f64\r\n): void {\r\n  const gridX: i32 = meshWidth;\r\n  const gridZ: i32 = meshHeight;\r\n\r\n  const gridX1: i32 = meshWidth + 1;\r\n  const gridZ1: i32 = meshHeight + 1;\r\n\r\n  const warpTimeV: f64 = time * warpanimspeed;\r\n  const warpScaleInv: f64 = 1.0 / warpscale;\r\n\r\n  const warpf0: f64 = 11.68 + 4.0 * Math.cos(warpTimeV * 1.413 + 10.0);\r\n  const warpf1: f64 = 8.77 + 3.0 * Math.cos(warpTimeV * 1.113 + 7.0);\r\n  const warpf2: f64 = 10.54 + 3.0 * Math.cos(warpTimeV * 1.233 + 3.0);\r\n  const warpf3: f64 = 11.49 + 4.0 * Math.cos(warpTimeV * 0.933 + 5.0);\r\n\r\n  let offset: i32 = 0;\r\n\r\n  save();\r\n\r\n  for (let iz: i32 = 0; iz < gridZ1; iz++) {\r\n    for (let ix: i32 = 0; ix < gridX1; ix++) {\r\n      const x2: f64 = (f64(ix) / f64(gridX)) * 2.0 - 1.0;\r\n      const y2: f64 = (f64(iz) / f64(gridZ)) * 2.0 - 1.0;\r\n      rad = Math.sqrt(\r\n        x2 * x2 * aspectx * aspectx + y2 * y2 * aspecty * aspecty\r\n      );\r\n\r\n      if (runVertEQs) {\r\n        if (iz === f64(gridZ) / 2.0 && ix === f64(gridX) / 2.0) {\r\n          ang = 0;\r\n        } else {\r\n          ang = atan2(y2 * aspecty, x2 * aspectx);\r\n        }\r\n\r\n        x = x2 * 0.5 * aspectx + 0.5;\r\n        y = y2 * -0.5 * aspecty + 0.5;\r\n\r\n        restore();\r\n        perPixelEqs();\r\n      }\r\n\r\n      const zoom2V: f64 = zoom ** (zoomexp ** (rad * 2.0 - 1.0));\r\n      const zoom2Inv: f64 = 1.0 / zoom2V;\r\n\r\n      let u: f64 = x2 * 0.5 * aspectx * zoom2Inv + 0.5;\r\n      let v: f64 = -y2 * 0.5 * aspecty * zoom2Inv + 0.5;\r\n\r\n      u = (u - cx) / sx + cx;\r\n      v = (v - cy) / sy + cy;\r\n\r\n      if (warp !== 0) {\r\n        u +=\r\n          warp *\r\n          0.0035 *\r\n          Math.sin(\r\n            warpTimeV * 0.333 + warpScaleInv * (x2 * warpf0 - y2 * warpf3)\r\n          );\r\n        v +=\r\n          warp *\r\n          0.0035 *\r\n          Math.cos(\r\n            warpTimeV * 0.375 - warpScaleInv * (x2 * warpf2 + y2 * warpf1)\r\n          );\r\n        u +=\r\n          warp *\r\n          0.0035 *\r\n          Math.cos(\r\n            warpTimeV * 0.753 - warpScaleInv * (x2 * warpf1 - y2 * warpf2)\r\n          );\r\n        v +=\r\n          warp *\r\n          0.0035 *\r\n          Math.sin(\r\n            warpTimeV * 0.825 + warpScaleInv * (x2 * warpf0 + y2 * warpf3)\r\n          );\r\n      }\r\n\r\n      const u2: f64 = u - cx;\r\n      const v2: f64 = v - cy;\r\n\r\n      const cosRot: f64 = Math.cos(rot);\r\n      const sinRot: f64 = Math.sin(rot);\r\n      u = u2 * cosRot - v2 * sinRot + cx;\r\n      v = u2 * sinRot + v2 * cosRot + cy;\r\n\r\n      u -= dx;\r\n      v -= dy;\r\n\r\n      u = (u - 0.5) / aspectx + 0.5;\r\n      v = (v - 0.5) / aspecty + 0.5;\r\n\r\n      unchecked((arr[offset] = f32(u)));\r\n      unchecked((arr[offset + 1] = f32(v)));\r\n\r\n      offset += 2;\r\n    }\r\n  }\r\n}\r\n\r\n// Copy qs to after frame values\r\n\r\n@external(\"qVarPool\", \"q1\")\r\ndeclare let q1: f64;\r\n@external(\"qVarPool\", \"q2\")\r\ndeclare let q2: f64;\r\n@external(\"qVarPool\", \"q3\")\r\ndeclare let q3: f64;\r\n@external(\"qVarPool\", \"q4\")\r\ndeclare let q4: f64;\r\n@external(\"qVarPool\", \"q5\")\r\ndeclare let q5: f64;\r\n@external(\"qVarPool\", \"q6\")\r\ndeclare let q6: f64;\r\n@external(\"qVarPool\", \"q7\")\r\ndeclare let q7: f64;\r\n@external(\"qVarPool\", \"q8\")\r\ndeclare let q8: f64;\r\n@external(\"qVarPool\", \"q9\")\r\ndeclare let q9: f64;\r\n@external(\"qVarPool\", \"q10\")\r\ndeclare let q10: f64;\r\n@external(\"qVarPool\", \"q11\")\r\ndeclare let q11: f64;\r\n@external(\"qVarPool\", \"q12\")\r\ndeclare let q12: f64;\r\n@external(\"qVarPool\", \"q13\")\r\ndeclare let q13: f64;\r\n@external(\"qVarPool\", \"q14\")\r\ndeclare let q14: f64;\r\n@external(\"qVarPool\", \"q15\")\r\ndeclare let q15: f64;\r\n@external(\"qVarPool\", \"q16\")\r\ndeclare let q16: f64;\r\n@external(\"qVarPool\", \"q17\")\r\ndeclare let q17: f64;\r\n@external(\"qVarPool\", \"q18\")\r\ndeclare let q18: f64;\r\n@external(\"qVarPool\", \"q19\")\r\ndeclare let q19: f64;\r\n@external(\"qVarPool\", \"q20\")\r\ndeclare let q20: f64;\r\n@external(\"qVarPool\", \"q21\")\r\ndeclare let q21: f64;\r\n@external(\"qVarPool\", \"q22\")\r\ndeclare let q22: f64;\r\n@external(\"qVarPool\", \"q23\")\r\ndeclare let q23: f64;\r\n@external(\"qVarPool\", \"q24\")\r\ndeclare let q24: f64;\r\n@external(\"qVarPool\", \"q25\")\r\ndeclare let q25: f64;\r\n@external(\"qVarPool\", \"q26\")\r\ndeclare let q26: f64;\r\n@external(\"qVarPool\", \"q27\")\r\ndeclare let q27: f64;\r\n@external(\"qVarPool\", \"q28\")\r\ndeclare let q28: f64;\r\n@external(\"qVarPool\", \"q29\")\r\ndeclare let q29: f64;\r\n@external(\"qVarPool\", \"q30\")\r\ndeclare let q30: f64;\r\n@external(\"qVarPool\", \"q31\")\r\ndeclare let q31: f64;\r\n@external(\"qVarPool\", \"q32\")\r\ndeclare let q32: f64;\r\n\r\nlet q1_save: f64;\r\nlet q2_save: f64;\r\nlet q3_save: f64;\r\nlet q4_save: f64;\r\nlet q5_save: f64;\r\nlet q6_save: f64;\r\nlet q7_save: f64;\r\nlet q8_save: f64;\r\nlet q9_save: f64;\r\nlet q10_save: f64;\r\nlet q11_save: f64;\r\nlet q12_save: f64;\r\nlet q13_save: f64;\r\nlet q14_save: f64;\r\nlet q15_save: f64;\r\nlet q16_save: f64;\r\nlet q17_save: f64;\r\nlet q18_save: f64;\r\nlet q19_save: f64;\r\nlet q20_save: f64;\r\nlet q21_save: f64;\r\nlet q22_save: f64;\r\nlet q23_save: f64;\r\nlet q24_save: f64;\r\nlet q25_save: f64;\r\nlet q26_save: f64;\r\nlet q27_save: f64;\r\nlet q28_save: f64;\r\nlet q29_save: f64;\r\nlet q30_save: f64;\r\nlet q31_save: f64;\r\nlet q32_save: f64;\r\n\r\nexport function saveQs(): void {\r\n  q1_save = q1;\r\n  q2_save = q2;\r\n  q3_save = q3;\r\n  q4_save = q4;\r\n  q5_save = q5;\r\n  q6_save = q6;\r\n  q7_save = q7;\r\n  q8_save = q8;\r\n  q9_save = q9;\r\n  q10_save = q10;\r\n  q11_save = q11;\r\n  q12_save = q12;\r\n  q13_save = q13;\r\n  q14_save = q14;\r\n  q15_save = q15;\r\n  q16_save = q16;\r\n  q17_save = q17;\r\n  q18_save = q18;\r\n  q19_save = q19;\r\n  q20_save = q20;\r\n  q21_save = q21;\r\n  q22_save = q22;\r\n  q23_save = q23;\r\n  q24_save = q24;\r\n  q25_save = q25;\r\n  q26_save = q26;\r\n  q27_save = q27;\r\n  q28_save = q28;\r\n  q29_save = q29;\r\n  q30_save = q30;\r\n  q31_save = q31;\r\n  q32_save = q32;\r\n}\r\n\r\nexport function restoreQs(): void {\r\n  q1 = q1_save;\r\n  q2 = q2_save;\r\n  q3 = q3_save;\r\n  q4 = q4_save;\r\n  q5 = q5_save;\r\n  q6 = q6_save;\r\n  q7 = q7_save;\r\n  q8 = q8_save;\r\n  q9 = q9_save;\r\n  q10 = q10_save;\r\n  q11 = q11_save;\r\n  q12 = q12_save;\r\n  q13 = q13_save;\r\n  q14 = q14_save;\r\n  q15 = q15_save;\r\n  q16 = q16_save;\r\n  q17 = q17_save;\r\n  q18 = q18_save;\r\n  q19 = q19_save;\r\n  q20 = q20_save;\r\n  q21 = q21_save;\r\n  q22 = q22_save;\r\n  q23 = q23_save;\r\n  q24 = q24_save;\r\n  q25 = q25_save;\r\n  q26 = q26_save;\r\n  q27 = q27_save;\r\n  q28 = q28_save;\r\n  q29 = q29_save;\r\n  q30 = q30_save;\r\n  q31 = q31_save;\r\n  q32 = q32_save;\r\n}\r\n\r\n// t vars\r\n@external(\"tVarPool\", \"t1\")\r\ndeclare let t1: f64;\r\n@external(\"tVarPool\", \"t2\")\r\ndeclare let t2: f64;\r\n@external(\"tVarPool\", \"t3\")\r\ndeclare let t3: f64;\r\n@external(\"tVarPool\", \"t4\")\r\ndeclare let t4: f64;\r\n@external(\"tVarPool\", \"t5\")\r\ndeclare let t5: f64;\r\n@external(\"tVarPool\", \"t6\")\r\ndeclare let t6: f64;\r\n@external(\"tVarPool\", \"t7\")\r\ndeclare let t7: f64;\r\n@external(\"tVarPool\", \"t8\")\r\ndeclare let t8: f64;\r\n\r\nlet t1_save: f64;\r\nlet t2_save: f64;\r\nlet t3_save: f64;\r\nlet t4_save: f64;\r\nlet t5_save: f64;\r\nlet t6_save: f64;\r\nlet t7_save: f64;\r\nlet t8_save: f64;\r\n\r\nexport function saveTs(): void {\r\n  t1_save = t1;\r\n  t2_save = t2;\r\n  t3_save = t3;\r\n  t4_save = t4;\r\n  t5_save = t5;\r\n  t6_save = t6;\r\n  t7_save = t7;\r\n  t8_save = t8;\r\n}\r\n\r\nexport function restoreTs(): void {\r\n  t1 = t1_save;\r\n  t2 = t2_save;\r\n  t3 = t3_save;\r\n  t4 = t4_save;\r\n  t5 = t5_save;\r\n  t6 = t6_save;\r\n  t7 = t7_save;\r\n  t8 = t8_save;\r\n}\r\n\r\n// Reset shape vars\r\n\r\n@external(\"shapePool0\", \"x_0\")\r\ndeclare let x_0: f64;\r\n@external(\"shapePool0\", \"y_0\")\r\ndeclare let y_0: f64;\r\n@external(\"shapePool0\", \"rad_0\")\r\ndeclare let rad_0: f64;\r\n@external(\"shapePool0\", \"ang_0\")\r\ndeclare let ang_0: f64;\r\n@external(\"shapePool0\", \"r_0\")\r\ndeclare let r_0: f64;\r\n@external(\"shapePool0\", \"g_0\")\r\ndeclare let g_0: f64;\r\n@external(\"shapePool0\", \"b_0\")\r\ndeclare let b_0: f64;\r\n@external(\"shapePool0\", \"a_0\")\r\ndeclare let a_0: f64;\r\n@external(\"shapePool0\", \"r2_0\")\r\ndeclare let r2_0: f64;\r\n@external(\"shapePool0\", \"g2_0\")\r\ndeclare let g2_0: f64;\r\n@external(\"shapePool0\", \"b2_0\")\r\ndeclare let b2_0: f64;\r\n@external(\"shapePool0\", \"a2_0\")\r\ndeclare let a2_0: f64;\r\n@external(\"shapePool0\", \"border_r_0\")\r\ndeclare let border_r_0: f64;\r\n@external(\"shapePool0\", \"border_g_0\")\r\ndeclare let border_g_0: f64;\r\n@external(\"shapePool0\", \"border_b_0\")\r\ndeclare let border_b_0: f64;\r\n@external(\"shapePool0\", \"border_a_0\")\r\ndeclare let border_a_0: f64;\r\n@external(\"shapePool0\", \"thickoutline_0\")\r\ndeclare let thickoutline_0: f64;\r\n@external(\"shapePool0\", \"textured_0\")\r\ndeclare let textured_0: f64;\r\n@external(\"shapePool0\", \"tex_zoom_0\")\r\ndeclare let tex_zoom_0: f64;\r\n@external(\"shapePool0\", \"tex_ang_0\")\r\ndeclare let tex_ang_0: f64;\r\n@external(\"shapePool0\", \"additive_0\")\r\ndeclare let additive_0: f64;\r\n\r\nlet x_0_save: f64;\r\nlet y_0_save: f64;\r\nlet rad_0_save: f64;\r\nlet ang_0_save: f64;\r\nlet r_0_save: f64;\r\nlet g_0_save: f64;\r\nlet b_0_save: f64;\r\nlet a_0_save: f64;\r\nlet r2_0_save: f64;\r\nlet g2_0_save: f64;\r\nlet b2_0_save: f64;\r\nlet a2_0_save: f64;\r\nlet border_r_0_save: f64;\r\nlet border_g_0_save: f64;\r\nlet border_b_0_save: f64;\r\nlet border_a_0_save: f64;\r\nlet thickoutline_0_save: f64;\r\nlet textured_0_save: f64;\r\nlet tex_zoom_0_save: f64;\r\nlet tex_ang_0_save: f64;\r\nlet additive_0_save: f64;\r\n\r\nexport function shape0_save(): void {\r\n  x_0_save = x_0;\r\n  y_0_save = y_0;\r\n  rad_0_save = rad_0;\r\n  ang_0_save = ang_0;\r\n  r_0_save = r_0;\r\n  g_0_save = g_0;\r\n  b_0_save = b_0;\r\n  a_0_save = a_0;\r\n  r2_0_save = r2_0;\r\n  g2_0_save = g2_0;\r\n  b2_0_save = b2_0;\r\n  a2_0_save = a2_0;\r\n  border_r_0_save = border_r_0;\r\n  border_g_0_save = border_g_0;\r\n  border_b_0_save = border_b_0;\r\n  border_a_0_save = border_a_0;\r\n  thickoutline_0_save = thickoutline_0;\r\n  textured_0_save = textured_0;\r\n  tex_zoom_0_save = tex_zoom_0;\r\n  tex_ang_0_save = tex_ang_0;\r\n  additive_0_save = additive_0;\r\n}\r\n\r\nexport function shape0_restore(): void {\r\n  x_0 = x_0_save;\r\n  y_0 = y_0_save;\r\n  rad_0 = rad_0_save;\r\n  ang_0 = ang_0_save;\r\n  r_0 = r_0_save;\r\n  g_0 = g_0_save;\r\n  b_0 = b_0_save;\r\n  a_0 = a_0_save;\r\n  r2_0 = r2_0_save;\r\n  g2_0 = g2_0_save;\r\n  b2_0 = b2_0_save;\r\n  a2_0 = a2_0_save;\r\n  border_r_0 = border_r_0_save;\r\n  border_g_0 = border_g_0_save;\r\n  border_b_0 = border_b_0_save;\r\n  border_a_0 = border_a_0_save;\r\n  thickoutline_0 = thickoutline_0_save;\r\n  textured_0 = textured_0_save;\r\n  tex_zoom_0 = tex_zoom_0_save;\r\n  tex_ang_0 = tex_ang_0_save;\r\n  additive_0 = additive_0_save;\r\n}\r\n\r\n@external(\"shapePool1\", \"x_1\")\r\ndeclare let x_1: f64;\r\n@external(\"shapePool1\", \"y_1\")\r\ndeclare let y_1: f64;\r\n@external(\"shapePool1\", \"rad_1\")\r\ndeclare let rad_1: f64;\r\n@external(\"shapePool1\", \"ang_1\")\r\ndeclare let ang_1: f64;\r\n@external(\"shapePool1\", \"r_1\")\r\ndeclare let r_1: f64;\r\n@external(\"shapePool1\", \"g_1\")\r\ndeclare let g_1: f64;\r\n@external(\"shapePool1\", \"b_1\")\r\ndeclare let b_1: f64;\r\n@external(\"shapePool1\", \"a_1\")\r\ndeclare let a_1: f64;\r\n@external(\"shapePool1\", \"r2_1\")\r\ndeclare let r2_1: f64;\r\n@external(\"shapePool1\", \"g2_1\")\r\ndeclare let g2_1: f64;\r\n@external(\"shapePool1\", \"b2_1\")\r\ndeclare let b2_1: f64;\r\n@external(\"shapePool1\", \"a2_1\")\r\ndeclare let a2_1: f64;\r\n@external(\"shapePool1\", \"border_r_1\")\r\ndeclare let border_r_1: f64;\r\n@external(\"shapePool1\", \"border_g_1\")\r\ndeclare let border_g_1: f64;\r\n@external(\"shapePool1\", \"border_b_1\")\r\ndeclare let border_b_1: f64;\r\n@external(\"shapePool1\", \"border_a_1\")\r\ndeclare let border_a_1: f64;\r\n@external(\"shapePool1\", \"thickoutline_1\")\r\ndeclare let thickoutline_1: f64;\r\n@external(\"shapePool1\", \"textured_1\")\r\ndeclare let textured_1: f64;\r\n@external(\"shapePool1\", \"tex_zoom_1\")\r\ndeclare let tex_zoom_1: f64;\r\n@external(\"shapePool1\", \"tex_ang_1\")\r\ndeclare let tex_ang_1: f64;\r\n@external(\"shapePool1\", \"additive_1\")\r\ndeclare let additive_1: f64;\r\n\r\nlet x_1_save: f64;\r\nlet y_1_save: f64;\r\nlet rad_1_save: f64;\r\nlet ang_1_save: f64;\r\nlet r_1_save: f64;\r\nlet g_1_save: f64;\r\nlet b_1_save: f64;\r\nlet a_1_save: f64;\r\nlet r2_1_save: f64;\r\nlet g2_1_save: f64;\r\nlet b2_1_save: f64;\r\nlet a2_1_save: f64;\r\nlet border_r_1_save: f64;\r\nlet border_g_1_save: f64;\r\nlet border_b_1_save: f64;\r\nlet border_a_1_save: f64;\r\nlet thickoutline_1_save: f64;\r\nlet textured_1_save: f64;\r\nlet tex_zoom_1_save: f64;\r\nlet tex_ang_1_save: f64;\r\nlet additive_1_save: f64;\r\n\r\nexport function shape1_save(): void {\r\n  x_1_save = x_1;\r\n  y_1_save = y_1;\r\n  rad_1_save = rad_1;\r\n  ang_1_save = ang_1;\r\n  r_1_save = r_1;\r\n  g_1_save = g_1;\r\n  b_1_save = b_1;\r\n  a_1_save = a_1;\r\n  r2_1_save = r2_1;\r\n  g2_1_save = g2_1;\r\n  b2_1_save = b2_1;\r\n  a2_1_save = a2_1;\r\n  border_r_1_save = border_r_1;\r\n  border_g_1_save = border_g_1;\r\n  border_b_1_save = border_b_1;\r\n  border_a_1_save = border_a_1;\r\n  thickoutline_1_save = thickoutline_1;\r\n  textured_1_save = textured_1;\r\n  tex_zoom_1_save = tex_zoom_1;\r\n  tex_ang_1_save = tex_ang_1;\r\n  additive_1_save = additive_1;\r\n}\r\n\r\nexport function shape1_restore(): void {\r\n  x_1 = x_1_save;\r\n  y_1 = y_1_save;\r\n  rad_1 = rad_1_save;\r\n  ang_1 = ang_1_save;\r\n  r_1 = r_1_save;\r\n  g_1 = g_1_save;\r\n  b_1 = b_1_save;\r\n  a_1 = a_1_save;\r\n  r2_1 = r2_1_save;\r\n  g2_1 = g2_1_save;\r\n  b2_1 = b2_1_save;\r\n  a2_1 = a2_1_save;\r\n  border_r_1 = border_r_1_save;\r\n  border_g_1 = border_g_1_save;\r\n  border_b_1 = border_b_1_save;\r\n  border_a_1 = border_a_1_save;\r\n  thickoutline_1 = thickoutline_1_save;\r\n  textured_1 = textured_1_save;\r\n  tex_zoom_1 = tex_zoom_1_save;\r\n  tex_ang_1 = tex_ang_1_save;\r\n  additive_1 = additive_1_save;\r\n}\r\n\r\n@external(\"shapePool2\", \"x_2\")\r\ndeclare let x_2: f64;\r\n@external(\"shapePool2\", \"y_2\")\r\ndeclare let y_2: f64;\r\n@external(\"shapePool2\", \"rad_2\")\r\ndeclare let rad_2: f64;\r\n@external(\"shapePool2\", \"ang_2\")\r\ndeclare let ang_2: f64;\r\n@external(\"shapePool2\", \"r_2\")\r\ndeclare let r_2: f64;\r\n@external(\"shapePool2\", \"g_2\")\r\ndeclare let g_2: f64;\r\n@external(\"shapePool2\", \"b_2\")\r\ndeclare let b_2: f64;\r\n@external(\"shapePool2\", \"a_2\")\r\ndeclare let a_2: f64;\r\n@external(\"shapePool2\", \"r2_2\")\r\ndeclare let r2_2: f64;\r\n@external(\"shapePool2\", \"g2_2\")\r\ndeclare let g2_2: f64;\r\n@external(\"shapePool2\", \"b2_2\")\r\ndeclare let b2_2: f64;\r\n@external(\"shapePool2\", \"a2_2\")\r\ndeclare let a2_2: f64;\r\n@external(\"shapePool2\", \"border_r_2\")\r\ndeclare let border_r_2: f64;\r\n@external(\"shapePool2\", \"border_g_2\")\r\ndeclare let border_g_2: f64;\r\n@external(\"shapePool2\", \"border_b_2\")\r\ndeclare let border_b_2: f64;\r\n@external(\"shapePool2\", \"border_a_2\")\r\ndeclare let border_a_2: f64;\r\n@external(\"shapePool2\", \"thickoutline_2\")\r\ndeclare let thickoutline_2: f64;\r\n@external(\"shapePool2\", \"textured_2\")\r\ndeclare let textured_2: f64;\r\n@external(\"shapePool2\", \"tex_zoom_2\")\r\ndeclare let tex_zoom_2: f64;\r\n@external(\"shapePool2\", \"tex_ang_2\")\r\ndeclare let tex_ang_2: f64;\r\n@external(\"shapePool2\", \"additive_2\")\r\ndeclare let additive_2: f64;\r\n\r\nlet x_2_save: f64;\r\nlet y_2_save: f64;\r\nlet rad_2_save: f64;\r\nlet ang_2_save: f64;\r\nlet r_2_save: f64;\r\nlet g_2_save: f64;\r\nlet b_2_save: f64;\r\nlet a_2_save: f64;\r\nlet r2_2_save: f64;\r\nlet g2_2_save: f64;\r\nlet b2_2_save: f64;\r\nlet a2_2_save: f64;\r\nlet border_r_2_save: f64;\r\nlet border_g_2_save: f64;\r\nlet border_b_2_save: f64;\r\nlet border_a_2_save: f64;\r\nlet thickoutline_2_save: f64;\r\nlet textured_2_save: f64;\r\nlet tex_zoom_2_save: f64;\r\nlet tex_ang_2_save: f64;\r\nlet additive_2_save: f64;\r\n\r\nexport function shape2_save(): void {\r\n  x_2_save = x_2;\r\n  y_2_save = y_2;\r\n  rad_2_save = rad_2;\r\n  ang_2_save = ang_2;\r\n  r_2_save = r_2;\r\n  g_2_save = g_2;\r\n  b_2_save = b_2;\r\n  a_2_save = a_2;\r\n  r2_2_save = r2_2;\r\n  g2_2_save = g2_2;\r\n  b2_2_save = b2_2;\r\n  a2_2_save = a2_2;\r\n  border_r_2_save = border_r_2;\r\n  border_g_2_save = border_g_2;\r\n  border_b_2_save = border_b_2;\r\n  border_a_2_save = border_a_2;\r\n  thickoutline_2_save = thickoutline_2;\r\n  textured_2_save = textured_2;\r\n  tex_zoom_2_save = tex_zoom_2;\r\n  tex_ang_2_save = tex_ang_2;\r\n  additive_2_save = additive_2;\r\n}\r\n\r\nexport function shape2_restore(): void {\r\n  x_2 = x_2_save;\r\n  y_2 = y_2_save;\r\n  rad_2 = rad_2_save;\r\n  ang_2 = ang_2_save;\r\n  r_2 = r_2_save;\r\n  g_2 = g_2_save;\r\n  b_2 = b_2_save;\r\n  a_2 = a_2_save;\r\n  r2_2 = r2_2_save;\r\n  g2_2 = g2_2_save;\r\n  b2_2 = b2_2_save;\r\n  a2_2 = a2_2_save;\r\n  border_r_2 = border_r_2_save;\r\n  border_g_2 = border_g_2_save;\r\n  border_b_2 = border_b_2_save;\r\n  border_a_2 = border_a_2_save;\r\n  thickoutline_2 = thickoutline_2_save;\r\n  textured_2 = textured_2_save;\r\n  tex_zoom_2 = tex_zoom_2_save;\r\n  tex_ang_2 = tex_ang_2_save;\r\n  additive_2 = additive_2_save;\r\n}\r\n\r\n@external(\"shapePool3\", \"x_3\")\r\ndeclare let x_3: f64;\r\n@external(\"shapePool3\", \"y_3\")\r\ndeclare let y_3: f64;\r\n@external(\"shapePool3\", \"rad_3\")\r\ndeclare let rad_3: f64;\r\n@external(\"shapePool3\", \"ang_3\")\r\ndeclare let ang_3: f64;\r\n@external(\"shapePool3\", \"r_3\")\r\ndeclare let r_3: f64;\r\n@external(\"shapePool3\", \"g_3\")\r\ndeclare let g_3: f64;\r\n@external(\"shapePool3\", \"b_3\")\r\ndeclare let b_3: f64;\r\n@external(\"shapePool3\", \"a_3\")\r\ndeclare let a_3: f64;\r\n@external(\"shapePool3\", \"r2_3\")\r\ndeclare let r2_3: f64;\r\n@external(\"shapePool3\", \"g2_3\")\r\ndeclare let g2_3: f64;\r\n@external(\"shapePool3\", \"b2_3\")\r\ndeclare let b2_3: f64;\r\n@external(\"shapePool3\", \"a2_3\")\r\ndeclare let a2_3: f64;\r\n@external(\"shapePool3\", \"border_r_3\")\r\ndeclare let border_r_3: f64;\r\n@external(\"shapePool3\", \"border_g_3\")\r\ndeclare let border_g_3: f64;\r\n@external(\"shapePool3\", \"border_b_3\")\r\ndeclare let border_b_3: f64;\r\n@external(\"shapePool3\", \"border_a_3\")\r\ndeclare let border_a_3: f64;\r\n@external(\"shapePool3\", \"thickoutline_3\")\r\ndeclare let thickoutline_3: f64;\r\n@external(\"shapePool3\", \"textured_3\")\r\ndeclare let textured_3: f64;\r\n@external(\"shapePool3\", \"tex_zoom_3\")\r\ndeclare let tex_zoom_3: f64;\r\n@external(\"shapePool3\", \"tex_ang_3\")\r\ndeclare let tex_ang_3: f64;\r\n@external(\"shapePool3\", \"additive_3\")\r\ndeclare let additive_3: f64;\r\n\r\nlet x_3_save: f64;\r\nlet y_3_save: f64;\r\nlet rad_3_save: f64;\r\nlet ang_3_save: f64;\r\nlet r_3_save: f64;\r\nlet g_3_save: f64;\r\nlet b_3_save: f64;\r\nlet a_3_save: f64;\r\nlet r2_3_save: f64;\r\nlet g2_3_save: f64;\r\nlet b2_3_save: f64;\r\nlet a2_3_save: f64;\r\nlet border_r_3_save: f64;\r\nlet border_g_3_save: f64;\r\nlet border_b_3_save: f64;\r\nlet border_a_3_save: f64;\r\nlet thickoutline_3_save: f64;\r\nlet textured_3_save: f64;\r\nlet tex_zoom_3_save: f64;\r\nlet tex_ang_3_save: f64;\r\nlet additive_3_save: f64;\r\n\r\nexport function shape3_save(): void {\r\n  x_3_save = x_3;\r\n  y_3_save = y_3;\r\n  rad_3_save = rad_3;\r\n  ang_3_save = ang_3;\r\n  r_3_save = r_3;\r\n  g_3_save = g_3;\r\n  b_3_save = b_3;\r\n  a_3_save = a_3;\r\n  r2_3_save = r2_3;\r\n  g2_3_save = g2_3;\r\n  b2_3_save = b2_3;\r\n  a2_3_save = a2_3;\r\n  border_r_3_save = border_r_3;\r\n  border_g_3_save = border_g_3;\r\n  border_b_3_save = border_b_3;\r\n  border_a_3_save = border_a_3;\r\n  thickoutline_3_save = thickoutline_3;\r\n  textured_3_save = textured_3;\r\n  tex_zoom_3_save = tex_zoom_3;\r\n  tex_ang_3_save = tex_ang_3;\r\n  additive_3_save = additive_3;\r\n}\r\n\r\nexport function shape3_restore(): void {\r\n  x_3 = x_3_save;\r\n  y_3 = y_3_save;\r\n  rad_3 = rad_3_save;\r\n  ang_3 = ang_3_save;\r\n  r_3 = r_3_save;\r\n  g_3 = g_3_save;\r\n  b_3 = b_3_save;\r\n  a_3 = a_3_save;\r\n  r2_3 = r2_3_save;\r\n  g2_3 = g2_3_save;\r\n  b2_3 = b2_3_save;\r\n  a2_3 = a2_3_save;\r\n  border_r_3 = border_r_3_save;\r\n  border_g_3 = border_g_3_save;\r\n  border_b_3 = border_b_3_save;\r\n  border_a_3 = border_a_3_save;\r\n  thickoutline_3 = thickoutline_3_save;\r\n  textured_3 = textured_3_save;\r\n  tex_zoom_3 = tex_zoom_3_save;\r\n  tex_ang_3 = tex_ang_3_save;\r\n  additive_3 = additive_3_save;\r\n}\r\n","import \"ecma-proposal-math-extensions\";\r\nimport \"./presetBase\";\r\nimport Visualizer from \"./visualizer\";\r\n\r\nexport default class Butterchurn {\r\n  static createVisualizer(context, canvas, opts) {\r\n    return new Visualizer(context, canvas, opts);\r\n  }\r\n}\r\n"],"names":["defineMath","name","assignment","configurable","writable","enumerable","Object","defineProperty","Math","value","PI","f32A","Float32Array","x","inLow","inHigh","outLow","outHigh","arguments","length","Number","isNaN","NaN","Infinity","scale","lower","upper","min","max","degrees","DEG_PER_RAD","radians","RAD_PER_DEG","EPSILON","t","e","n","destCol","srcCol","srcLine","forEach","r","column","line","window","sqr","sqrt","abs","log10","val","log","LOG10E","sign","rand","xf","floor","random","randint","bnot","pow","y","num","z","isFinite","div","mod","bitor","bitand","sigmoid","exp","bor","band","equal","above","below","ifcond","memcpy","megabuf","dst","src","len","destOffset","srcOffset","copyLen","copyWithin","s","i","o","a","c","l","h","u","p","f","g","m","_","E","d","b","w","S","I","k","O","N","v","R","$","A","trace","yy","symbols_","error","SCRIPT","expression","EOF","expressionsOptionalTrailingSemi","separator","expressions","EXPRESSION_BLOCK","IDENTIFIER","IDENTIFIER_TOKEN","argument","FUNCTION_CALL","LOGICAL_EXPRESSION","LOGICAL_OPERATOR_TOKEN","ASSIGNMENT","ASSIGNMENT_OPERATOR_TOKEN","number","DIGITS_TOKEN","NUMBER_LITERAL","UNARY_EXPRESSION","BINARY_EXPRESSION","COMPARISON_TOKEN","$accept","$end","terminals_","productions_","performAction","type","body","loc","this","_$","concat","toLowerCase","callee","left","right","operator","table","defaultActions","parseError","recoverable","Error","hash","parse","slice","call","create","lexer","prototype","hasOwnProperty","setInput","parser","yylloc","push","options","ranges","getPrototypeOf","lex","showPosition","join","text","match","token","yylineno","expected","Array","yytext","yyleng","first_line","last_line","first_column","last_column","range","apply","L","_input","_more","_backtrack","done","matched","conditionStack","offset","input","unput","split","substr","more","reject","backtrack_lexer","less","pastInput","replace","upcomingInput","test_match","matches","next","_currentRules","rules","flex","begin","popState","pop","conditions","INITIAL","topState","pushState","stateStackSize","inclusive","T","Parser","ASSIGNMENT_EXPRESSION","key","CALL_EXPRESSION","map","some","fill","constructor","_map","Map","get","has","set","size","super","sourceContext","splice","assign","message","At","P","C","M","F","X","j","U","xt","D","Rt","B","ot","yt","_t","Et","bt","wt","St","Ot","Nt","vt","Uint8Array","ArrayBuffer","DataView","setFloat64","reverse","$t","charCodeAt","ceil","log2","Lt","Tt","Pt","unshift","Ct","sin","cos","tan","asin","acos","atan","atan2","Ft","Xt","args","returns","binary","localVariables","bitwiseOr","bitwiseAnd","_getBufferIndex","jt","Ut","resolveFunc","rawSource","resolveLocal","Dt","resolveVar","startsWith","comparison","shortCircuitValue","Bt","pools","functions","eelVersion","preParsed","keys","includes","entries","pool","code","test","findIndex","indexOf","exportName","BIGINT","BigUint64Array","THIS","Symbol","decoder","TextDecoder","getStringImpl","buffer","ptr","Uint32Array","arr","Uint16Array","String","fromCharCode","decode","preInstantiate","imports","extendedExports","getString","memory","env","abort","msg","file","colm","console","seed","Date","now","postInstantiate","instance","exports","__new","__retain","__rtti_base","getArrayInfo","id","info","U32","getInfo","getBase","getValueAlign","clz32","getView","alignLog2","signed","float","Float64Array","Int8Array","Int16Array","Int32Array","BigInt64Array","__getArrayView","align","buf","subarray","getTypedArray","Type","getTypedArrayView","bufPtr","attachTypedArrayFunctions","ctor","bind","__newString","str","U16","__getString","__newArray","values","result","view","__getArray","out","__getArrayBuffer","Uint8ClampedArray","BYTES_PER_ELEMENT","__instanceof","baseId","demangle","isResponse","Response","isModule","WebAssembly","Module","async","instantiate","source","instantiateStreaming","module","compile","extended","arrayBuffer","setArgumentsLength","internalName","elem","parts","curr","part","shift","className","substring","classElem","wrap","valueOf","thisValue","getOwnPropertyNames","getOwnPropertyDescriptor","getter","setter","original","ascLoader","instantiateSync","Instance","FFT","samplesIn","samplesOut","equalize","NFREQ","initEqualizeTable","initBitRevTable","initCosSinTable","equalizeArr","invHalfNFREQ","bitrevtable","temp","dftsize","tabsize","cossintable","theta","timeToFrequencyDomain","waveDataIn","real","imag","idx","wpr","wpi","wr","wi","hdftsize","tempr","tempi","wtemp","spectralDataOut","AudioProcessor","context","numSamps","fftSize","fft","audioContext","audible","createDelay","analyser","createAnalyser","smoothingTimeConstant","connect","analyserL","analyserR","splitter","createChannelSplitter","timeByteArray","timeByteArrayL","timeByteArrayR","timeArray","timeByteArraySignedL","timeByteArraySignedR","tempTimeArrayL","tempTimeArrayR","timeArrayL","timeArrayR","sampleAudio","getByteTimeDomainData","processAudio","updateAudio","lastIdx","freqArray","freqArrayL","freqArrayR","connectAudio","audionode","disconnectAudio","disconnect","AudioLevels","audio","sampleRate","bucketHz","bassLow","clamp","round","bassHigh","midHigh","trebHigh","starts","stops","imm","att","avg","longAvg","bass","bass_att","mid","mid_att","treb","treb_att","isFiniteNumber","adjustRateToFPS","rate","baseFPS","FPS","updateAudioLevels","fps","frame","effectiveFPS","pmap","baseVals","gammaadj","wave_g","mv_x","warpscale","brighten","mv_y","wave_scale","echo_alpha","additivewave","sx","sy","warp","red_blue","wave_mode","wave_brighten","zoomexp","fshader","wave_r","echo_zoom","wave_smoothing","warpanimspeed","wave_dots","wave_x","wave_y","zoom","solarize","modwavealphabyvolume","dx","cx","dy","darken_center","cy","invert","bmotionvectorson","rot","modwavealphaend","wave_mystery","decay","wave_a","wave_b","rating","modwavealphastart","darken","echo_orient","ib_r","ib_g","ib_b","ib_a","ib_size","ob_r","ob_g","ob_b","ob_a","ob_size","mv_dx","mv_dy","mv_a","mv_r","mv_g","mv_b","mv_l","init_eqs","frame_eqs","rkeys","pixel_eqs","rad","waves","enabled","scaling","samples","additive","usedots","spectrum","smoothing","thick","sep","point_eqs","shapes","r2","tex_ang","thickoutline","textured","g2","tex_zoom","border_a","border_b","b2","a2","border_g","ang","sides","border_r","comp","Utils","cloneVars","vars","start","end","undefined","from","pick","obj","newObj","omit","setWasm","wasmGlobals","pickWasm","SeededRandom","state","initializeState","warmUp","nextInt","reset","createDefaultRNGContext","getRNG","globalRNG","initializeRNG","opts","deterministic","testMode","rng","newSeed","createRNGContext","PresetEquationRunner","preset","globalVars","texsizeX","texsizeY","mesh_width","mesh_height","aspectx","aspecty","invAspectx","invAspecty","qs","ts","regs","initializeEquations","runVertEQs","mdVSQInit","mdVSRegs","mdVSFrame","mdVSUserKeys","mdVSFrameMap","mdVSShapes","mdVSUserKeysShapes","mdVSFrameMapShapes","mdVSWaves","mdVSUserKeysWaves","mdVSFrameMapWaves","mdVSQAfterFrame","gmegabuf","mdVSBase","time","meshx","meshy","pixelsx","pixelsy","mdVS","rand_start","rand_preset","nonUserKeys","mdVSAfterInit","initUserVars","mdVSTWaveInits","wave","mdVSWave","nonUserWaveKeys","mdVSTShapeInits","shape","mdVSShape","nonUserShapeKeys","updatePreset","updateGlobals","runFrameEquations","runPixelEquations","mdVSVertex","runShapeFrameEquations","shapeIdx","runWaveFrameEquations","waveIdx","runWavePointEquations","mdVSWaveFrame","PresetEquationRunnerWASM","globalKeys","frameKeys","waveFrameKeys","waveFrameInputKeys","getQVars","globalPools","getTVars","perFrame","save_qs","lineMatcher","samplerMatcher","ShaderUtils","getShaderParts","sbIndex","beforeShaderBody","afterShaderBody","firstCurly","lastCurly","lastIndexOf","getFragmentFloatPrecision","gl","getShaderPrecisionFormat","FRAGMENT_SHADER","HIGH_FLOAT","precision","MEDIUM_FLOAT","getUserSamplers","samplers","lineMatches","samplerMatches","sampler","WaveUtils","smoothWave","positions","positionsSmoothed","nVertsIn","zCoord","c1","c2","c3","c4","iAbove","iBelow","iAbove2","smoothWaveAndColor","colors","colorsSmoothed","BasicWaveform","numAudioSamples","positions2","oldPositions","oldPositions2","smoothedPositions","smoothedPositions2","color","floatPrecision","createShader","vertexBuf","createBuffer","shaderProgram","createProgram","vertShader","VERTEX_SHADER","shaderSource","trim","compileShader","fragShader","attachShader","linkProgram","aPosLoc","getAttribLocation","colorLoc","getUniformLocation","thickOffsetLoc","processWaveform","waveform","smooth","smooth2","generateWaveform","blending","blendProgress","alpha","vol","waveL","waveR","newWaveMode","oldWaveMode","old_wave_mode","wavePosX","wavePosY","numVert","oldNumVert","its","it","waveMode","fWaveParam2","alphaDiff","numVertInv","sampleOffset","mix","w1","w2","cosRot","sinRot","ioff","x0","y0","edgex","edgey","bClip","dxi","dyi","ang2","perpDx","perpDy","sample","oldAlpha","mix2","maxc","fIdx","nIdx","halfNumVert","smoothedNumVert","drawBasicWaveform","useProgram","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertexAttribPointer","FLOAT","enableVertexAttribArray","uniform4fv","instances","wave_thick","blendFunc","SRC_ALPHA","ONE","ONE_MINUS_SRC_ALPHA","drawMode","POINTS","LINE_STRIP","uniform2fv","drawArrays","CustomWaveform","index","maxSamples","pointsData","smoothedColors","positionVertexBuf","colorVertexBuf","aPosLocation","aColorLocation","sizeLoc","presetEquationRunner","waveEqs","alphaMult","useWASM","frameR","frameG","frameB","frameA","waveScale","useSpectrum","pointsLeft","pointsRight","j0","j1","mix1","varPool","value1","value2","mdvsUserKeysWave","mdVSNewFrameMapWave","drawCustomWaveform","waveUseDots","waveThick","waveAdditive","numVerts","uniform1f","CustomShape$1","uvs","borderPositions","uvVertexBuf","borderPositionVertexBuf","createBorderShader","mainSampler","createSampler","samplerParameteri","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_WRAP_S","REPEAT","TEXTURE_WRAP_T","aUvLocation","texturedLoc","textureLoc","borderShaderProgram","aBorderPosLoc","uBorderColorLoc","drawCustomShape","shapeEqs","prevTexture","setupShapeBuffers","restore_qs","save_ts","frame_eqs_save","numInst","num_inst","frame_eqs_restore","restore_ts","borderR","borderG","borderB","borderA","borderColor","texZoom","texAng","hasBorder","isTextured","isBorderThick","isAdditive","quarterPi","pTwoPi","angSum","texAngSum","drawCustomShapeInstance","frame_eqs_str","mdVSShapeFrame","mdVSUserKeysShape","mdVSNewFrameMapShape","DYNAMIC_DRAW","wrapping","CLAMP_TO_EDGE","bufferSubData","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","bindSampler","uniform1i","TRIANGLE_FAN","Border","addTriangle","point1","point2","point3","generateBorder","borderSize","prevBorderSize","width","height","widthHalf","heightHalf","prevBorderWidth","borderWidth","prevBorderWidthWidth","prevBorderWidthHeight","borderWidthWidth","borderWidthHeight","point4","drawBorder","TRIANGLES","CustomShape","generatePositions","halfSize","drawDarkenCenter","MotionVectors","maxX","maxY","getMotionDir","warpUVs","fx","fy","x1","y1","gridX1","fx2","fy2","generateMotionVectors","mvA","nX","nY","dx2","dy2","lenMult","minLen","numVecVerts","fx2arr","fdist","vx1","vy1","vx2","vy2","drawMotionVectors","lineWidth","LINES","WarpShader","noise","image","buildPositions","indexBuf","warpUvVertexBuf","warpColorVertexBuf","mainSamplerFW","mainSamplerFC","mainSamplerPW","mainSamplerPC","NEAREST_MIPMAP_NEAREST","NEAREST","gridX","gridY","gridY1","segmentWidth","segmentHeight","vertices","iy","ix","indices","shaderText","fragShaderText","fragShaderHeaderText","shaderParts","userTextures","positionLocation","warpUvLocation","warpColorLocation","textureFWLoc","textureFCLoc","texturePWLoc","texturePCLoc","blurTexture1Loc","blurTexture2Loc","blurTexture3Loc","noiseLQLoc","noiseMQLoc","noiseHQLoc","noiseLQLiteLoc","noisePointLQLoc","noiseVolLQLoc","noiseVolHQLoc","decayLoc","texsizeLoc","texsizeNoiseLQLoc","texsizeNoiseMQLoc","texsizeNoiseHQLoc","texsizeNoiseLQLiteLoc","texsizeNoiseVolLQLoc","texsizeNoiseVolHQLoc","resolutionLoc","aspectLoc","bassLoc","midLoc","trebLoc","volLoc","bassAttLoc","midAttLoc","trebAttLoc","volAttLoc","timeLoc","frameLoc","fpsLoc","blur1MinLoc","blur1MaxLoc","blur2MinLoc","blur2MaxLoc","blur3MinLoc","blur3MaxLoc","scale1Loc","scale2Loc","scale3Loc","bias1Loc","bias2Loc","bias3Loc","randPresetLoc","randFrameLoc","qaLoc","qbLoc","qcLoc","qdLoc","qeLoc","qfLoc","qgLoc","qhLoc","slowRoamCosLoc","roamCosLoc","slowRoamSinLoc","roamSinLoc","userTexture","updateShader","bindBlurVals","blurMins","blurMaxs","blurMin1","blurMin2","blurMin3","blurMax1","blurMax2","blurMax3","scale1","bias1","scale2","bias2","scale3","bias3","renderQuadTexture","texture","blurTexture1","blurTexture2","blurTexture3","mdVSQs","warpColor","ELEMENT_ARRAY_BUFFER","TEXTURE1","TEXTURE2","TEXTURE3","TEXTURE4","TEXTURE5","TEXTURE6","TEXTURE7","TEXTURE8","noiseTexLQ","TEXTURE9","noiseTexMQ","TEXTURE10","noiseTexHQ","TEXTURE11","noiseTexLQLite","TEXTURE12","noiseTexPointLQ","TEXTURE13","TEXTURE_3D","noiseTexVolLQ","TEXTURE14","noiseTexVolHQ","TEXTURE15","getTexture","q1","q2","q3","q4","q5","q6","q7","q8","q9","q10","q11","q12","q13","q14","q15","q16","q17","q18","q19","q20","q21","q22","q23","q24","q25","q26","q27","q28","q29","q30","q31","q32","disable","BLEND","drawElements","UNSIGNED_SHORT","enable","CompShader","compWidth","compHeight","compColorVertexBuf","compColorLocation","gammaAdjLoc","echoZoomLoc","echoAlphaLoc","echoOrientationLoc","invertLoc","brightenLoc","darkenLoc","solarizeLoc","fShaderLoc","generateHueBase","hueBase","maxshade","generateCompColors","compColor","offsetColor","col","nx","ny","compColors","OutputShader","textureRatio","useFXAA","createFXAAShader","deleteProgram","TRIANGLE_STRIP","ResampleShader","generateMipmap","BlurVertical","blurLevel","w1V","w2V","d1V","d2V","wds","wDiv","texsizeLocation","ed1Loc","ed2Loc","ed3Loc","wdsLocation","wdivLoc","srcTexsize","b1ed","BlurHorizontal","w1H","w2H","w3H","w4H","d1H","d2H","d3H","d4H","ws","ds","scaleLoc","biasLoc","wsLoc","dsLocation","getScaleAndBias","bias","tempMin","tempMax","BlurShader","blurRatios","anisoExt","getExtension","blurHorizontalFrameBuffer","createFramebuffer","blurVerticalFrameBuffer","blurHorizontalTexture","createTexture","blurVerticalTexture","setupFrameBufferTextures","blurHorizontal","blurVertical","getTextureSize","sizeRatio","sizeX","sizeY","srcBlurRatios","dstBlurRatios","srcTexsizeHorizontal","dstTexsizeHorizontal","bindFrameBufferTexture","srcTexsizeVertical","dstTexsizeVertical","horizontalTexsizes","verticalTexsizes","bindFrambufferAndSetViewport","fb","texsize","bindFramebuffer","FRAMEBUFFER","viewport","targetFrameBuffer","targetTexture","pixelStorei","UNPACK_ALIGNMENT","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","getParameter","MAX_TEXTURE_MAX_ANISOTROPY_EXT","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","framebufferTexture2D","COLOR_ATTACHMENT0","renderBlurTexture","Noise","randomFn","nTexArrLQ","createNoiseTex","nTexArrLQLite","nTexArrMQ","nTexArrHQ","nTexArrVolLQ","createNoiseVolTex","nTexArrVolHQ","bindTexture3D","data","depth","texImage3D","TEXTURE_WRAP_R","fCubicInterpolate","y2","y3","t2","a0","dwCubicInterpolate","ret","noiseSize","nsize","texArr","texRange","halfTexRange","wordsPerSlice","wordsPerLine","baseX","baseY","baseZ","ImageTextures","clouds2Image","Image","onload","clouds2","emptyImage","empty","loadExtraImages","imageData","imageName","tex","TitleText","textTexture","canvas","document","createElement","context2D","getContext","willReadFrequently","generateTitleTexture","clearRect","fontSize","font","titleText","textLength","measureText","percentToKeep","fillStyle","fillText","getImageData","UNPACK_FLIP_Y_WEBGL","uvLocation","textColorLoc","generateUvs","progress","flip","renderTitle","progressUvs","BlendPattern","vertInfoA","vertInfoC","createBlendPattern","resizeMatrixValues","oldMat","oldWidth","oldHeight","newWidth","newHeight","newMat","nVert","val00","val01","val10","val11","oldMeshWidth","oldMeshHeight","genPlasma","dt","midx","midy","t00","t01","t10","t11","mixType","vx","vy","invBand","minc","mult","dir","Renderer","frameNum","presetTime","lastTime","performance","timeHist","timeHistMax","blendStartTime","blendDuration","meshWidth","meshHeight","pixelRatio","devicePixelRatio","outputFXAA","audioLevels","prevFrameBuffer","compFrameBuffer","compTexture","params","warpShader","compShader","outputShader","prevWarpShader","prevCompShader","numBlurPasses","blurShader1","blurShader2","blurShader3","basicWaveform","customWaveforms","customShapes","prevCustomWaveforms","prevCustomShapes","darkenCenter","DarkenCenter","innerBorder","outerBorder","motionVectors","blendPattern","resampleShader","supertext","startTime","clearColor","blankPreset","prevPreset","prevPresetEquationRunner","regVars","getHighestBlur","loadPreset","blendTime","pixel_eqs_initialize_array","tmpWarpShader","tmpCompShader","warpText","compText","setRendererSize","oldTexsizeX","oldTexsizeY","targetTextureNew","renderToScreen","setInternalMeshSize","setOutputAA","useAA","calcTimeAndFPS","elapsedTime","elapsed","newTime","newHistTime","newFPS","damping","gridZ","gridZ1","warpTimeV","warpScaleInv","warpf0","warpf1","warpf2","warpf3","texelOffsetX","texelOffsetY","perVertex","pixel_eqs_wasm","newWarpUVs","pixel_eqs_get_array","iz","zoomExp","zoom2Inv","u2","v2","mixFrameEquations","mdVSFramePrev","snapPoint","mixedFrame","b1n","b2n","b3n","b1x","b2x","b3x","getBlurValues","fMinDist","render","prevGlobalVars","mdVSFrameMixed","prevMDVSFrame","swapTexture","swapFrameBuffer","clear","COLOR_BUFFER_BIT","blendEquation","FUNC_ADD","outerColor","innerColor","duration","launchSongTitleAnim","toDataURL","readPixels","createImageData","putImageData","deleteTexture","deleteFramebuffer","warpBufferToDataURL","Visualizer","deterministicMode","vizWidth","vizHeight","OffscreenCanvas","internalCanvas","antialias","stencil","premultipliedAlpha","outputGl","baseValsDefaults","shapeBaseValsDefaults","waveBaseValsDefaults","globalPerFrameVars","globalPerPixelVars","globalShapeVars","shapeBaseVars","globalWaveVars","renderer","loseGLContext","loseContext","audioNode","overrideDefaultVars","combinedVals","createQVars","wasmVars","Global","mutable","createTVars","createPerFramePool","createPerPixelPool","createCustomShapePerFramePool","createCustomWavePerFramePool","makeShapeResetPool","variables","reduce","acc","variable","base64ToArrayBuffer","base64","binaryString","atob","bytes","presetMap","JSON","stringify","forceJS","useJS","onlyUseWASM","loadWASMPreset","warn","loadJSPreset","qWasmVars","tWasmVars","wasmVarPools","wasmFunctions","presetInit","init_eqs_eel","frame_eqs_eel","pixel_eqs_eel","perPixel","point_eqs_eel","Set","shims","loadModule","version","handleEmptyFunction","presetFunctionsMod","pixelEqs","perPixelEqs","pixelVarPool","qVarPool","tVarPool","shapePool0","shapePool1","shapePool2","shapePool3","logi","logf","saveQs","restoreQs","saveTs","restoreTs","arrPtr","createFloat32Array","pixel_eqs_array","__getFloat32ArrayView","Function","init_eqs_str","pixel_eqs_str","point_eqs_str","setCanvas","renderOutput","drawImage","createVisualizer"],"mappings":"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C,KAAM,IACNC,KAAM,GAGRpb,KAAKu3C,sBAAwB,CAC3B/6B,QAAS,EACTuB,MAAO,EACPpB,SAAU,EACVU,aAAc,EACdC,SAAU,EACVyT,SAAU,EACVvT,SAAU,EACVJ,QAAS,EACTvlB,EAAG,GACH+C,EAAG,GACH0hB,IAAK,GACLwB,IAAK,EACLrkB,EAAG,EACHsD,EAAG,EACHK,EAAG,EACHZ,EAAG,EACH2gB,GAAI,EACJI,GAAI,EACJI,GAAI,EACJC,GAAI,EACJI,SAAU,EACVH,SAAU,EACVH,SAAU,EACVD,SAAU,IAGZzd,KAAKw3C,qBAAuB,CAC1Bh7B,QAAS,EACTE,QAAS,IACTM,IAAK,EACLP,QAAS,EACTK,UAAW,GACXrjB,EAAG,EACHsD,EAAG,EACHK,EAAG,EACHZ,EAAG,EACHqgB,SAAU,EACVD,QAAS,EACTG,MAAO,EACPJ,SAAU,GAGZ3c,KAAK2gB,GAAKzC,GAAMvb,MAAM,EAAG,IAAIyC,IAAKvN,GAAM,IAAIA,KAC5CmI,KAAK4gB,GAAK1C,GAAMvb,MAAM,EAAG,GAAGyC,IAAKvN,GAAM,IAAIA,KAE3CmI,KAAKy3C,mBAAqB,CACxB,gBAEA,QACA,OACA,MACA,OACA,WACA,MACA,UACA,OACA,WACA,QACA,QACA,UACA,UACA,UACA,UACA,aACA,eAGFz3C,KAAK03C,mBAAqB,CAExB,QACA,OACA,MACA,OACA,WACA,MACA,UACA,OACA,WACA,QACA,QACA,UACA,UACA,UACA,UACA,aACA,cAEA,IACA,IACA,MACA,OAGF13C,KAAK23C,gBAAkB,CAErB,QACA,OACA,MACA,OACA,WACA,MACA,UACA,OACA,WACA,QACA,QACA,UACA,UACA,UACA,UACA,aACA,cAEA,YAGF33C,KAAK43C,cAAgB,CACnB,IACA,IACA,MACA,MACA,IACA,IACA,IACA,IACA,KACA,KACA,KACA,KACA,WACA,WACA,WACA,WACA,eACA,WACA,WACA,UACA,YAGF53C,KAAK63C,eAAiB,CAEpB,QACA,OACA,MACA,OACA,WACA,MACA,UACA,OACA,WACA,QACA,QACA,UACA,UA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","x_google_ignoreList":[0,2,3]}